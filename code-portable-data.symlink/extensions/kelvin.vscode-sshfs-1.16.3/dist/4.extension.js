exports.ids=[4],exports.modules=Array(21).concat([function(e,t,r){var i=r(28).Ber,n=r(22).readUInt32BE,o=r(22).writeUInt32BE,s=1/0;function a(e,t,r,i,o,a){r&&!Buffer.isBuffer(r)&&"string"!=typeof r&&("number"==typeof o&&(a=o),o=i,i=r,r=void 0),t||(t=0);var f,h,c=e.length,u=c-t;return t<0||t>=c||u<4?(i&&i._cleanup(o),!1):(f=n(e,t))>(a||s)||u<4+f?(i&&i._cleanup(o),!1):(h=(t+=4)+f,e._pos=h,r?Buffer.isBuffer(r)?(e.copy(r,0,t,h),r):e.toString(r,t,h):e.slice(t,h))}e.exports={iv_inc:function(e){var t=12,r=0;do{if(255!==(r=e[--t]))return void(e[t]=++r);e[t]=0}while(t>4)},readInt:function(e,t,r,i){var o=e.length;if(t<0||t>=o||o-t<4)return r&&r._cleanup(i),!1;return n(e,t)},readString:a,parseKey:r(30).parseKey,sigSSHToASN1:function(e,t,r,n){var o;switch(t){case"ssh-dss":if(e.length>40)return e;(o=new i.Writer).startSequence();var s=e.slice(0,20),f=e.slice(20);if(128&s[0]){var h=Buffer.allocUnsafe(21);h[0]=0,s.copy(h,1),s=h}else 0!==s[0]||128&s[1]||(s=s.slice(1));if(128&f[0]){var c=Buffer.allocUnsafe(21);c[0]=0,f.copy(c,1),f=c}else 0!==f[0]||128&f[1]||(f=f.slice(1));return o.writeBuffer(s,i.Integer),o.writeBuffer(f,i.Integer),o.endSequence(),o.buffer;case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":var s=a(e,0,r,n);if(!1===s)return!1;var f=a(e,e._pos,r,n);return!1!==f&&((o=new i.Writer).startSequence(),o.writeBuffer(s,i.Integer),o.writeBuffer(f,i.Integer),o.endSequence(),o.buffer);default:return e}},DSASigBERToBare:function(e){if(e.length<=40)return e;var t=new i.Reader(e);t.readSequence();var r=t.readString(i.Integer,!0),n=t.readString(i.Integer,!0),o=0,s=0;if(r.length<20){var a=Buffer.allocUnsafe(20);r.copy(a,1),(r=a)[0]=0}if(n.length<20){var f=Buffer.allocUnsafe(20);n.copy(f,1),(n=f)[0]=0}r.length>20&&0===r[0]&&(o=1);n.length>20&&0===n[0]&&(s=1);var h=Buffer.allocUnsafe(r.length-o+(n.length-s));return r.copy(h,0,o),n.copy(h,r.length-o,s),h},ECDSASigASN1ToSSH:function(e){if(0===e[0])return e;var t=new i.Reader(e);t.readSequence();var r=t.readString(i.Integer,!0),n=t.readString(i.Integer,!0);if(null===r||null===n)return!1;var s=Buffer.allocUnsafe(4+r.length+4+n.length);return o(s,r.length,0),r.copy(s,4),o(s,n.length,4+r.length),n.copy(s,8+r.length),s}}},function(e,t){e.exports={readUInt32BE:function(e,t){return 16777216*e[t++]+65536*e[t++]+256*e[t++]+e[t]},writeUInt32BE:function(e,t,r){return e[r++]=t>>>24,e[r++]=t>>>16,e[r++]=t>>>8,e[r++]=t,r},writeUInt32LE:function(e,t,r){return e[r++]=t,e[r++]=t>>>8,e[r++]=t>>>16,e[r++]=t>>>24,r}}},function(e,t){e.exports={readUInt32BE:function(e,t){return 16777216*e[t++]+65536*e[t++]+256*e[t++]+e[t]},writeUInt32BE:function(e,t,r){return e[r++]=t>>>24,e[r++]=t>>>16,e[r++]=t>>>8,e[r++]=t,r},writeUInt32LE:function(e,t,r){return e[r++]=t,e[r++]=t>>>8,e[r++]=t>>>16,e[r++]=t>>>24,r}}},function(e,t,r){e.exports={SFTPStream:r(37),SSH2Stream:r(44),utils:r(21),constants:r(27)}},function(e,t){e.exports={newInvalidAsn1Error:function(e){var t=new Error;return t.name="InvalidAsn1Error",t.message=e||"",t}}},function(e,t){e.exports={EOC:0,Boolean:1,Integer:2,BitString:3,OctetString:4,Null:5,OID:6,ObjectDescriptor:7,External:8,Real:9,Enumeration:10,PDV:11,Utf8String:12,RelativeOID:13,Sequence:16,Set:17,NumericString:18,PrintableString:19,T61String:20,VideotexString:21,IA5String:22,UTCTime:23,GeneralizedTime:24,GraphicString:25,VisibleString:26,GeneralString:28,UniversalString:29,CharacterString:30,BMPString:31,Constructor:32,Context:128}},function(e,t){var r,i,n,o=t.MESSAGE={DISCONNECT:1,IGNORE:2,UNIMPLEMENTED:3,DEBUG:4,SERVICE_REQUEST:5,SERVICE_ACCEPT:6,KEXINIT:20,NEWKEYS:21,USERAUTH_REQUEST:50,USERAUTH_FAILURE:51,USERAUTH_SUCCESS:52,USERAUTH_BANNER:53,GLOBAL_REQUEST:80,REQUEST_SUCCESS:81,REQUEST_FAILURE:82,CHANNEL_OPEN:90,CHANNEL_OPEN_CONFIRMATION:91,CHANNEL_OPEN_FAILURE:92,CHANNEL_WINDOW_ADJUST:93,CHANNEL_DATA:94,CHANNEL_EXTENDED_DATA:95,CHANNEL_EOF:96,CHANNEL_CLOSE:97,CHANNEL_REQUEST:98,CHANNEL_SUCCESS:99,CHANNEL_FAILURE:100};for(r=0,n=(i=Object.keys(o)).length;r<n;++r)o[o[i[r]]]=i[r];o.KEXDH_INIT=30,o.KEXDH_REPLY=31,o.KEXDH_GEX_REQUEST=34,o.KEXDH_GEX_GROUP=31,o.KEXDH_GEX_INIT=32,o.KEXDH_GEX_REPLY=33,o.KEXECDH_INIT=30,o.KEXECDH_REPLY=31,o.USERAUTH_PASSWD_CHANGEREQ=60,o.USERAUTH_PK_OK=60,o.USERAUTH_INFO_REQUEST=60,o.USERAUTH_INFO_RESPONSE=61;var s=t.DYNAMIC_KEXDH_MESSAGE={};s[o.KEXDH_GEX_GROUP]="KEXDH_GEX_GROUP",s[o.KEXDH_GEX_REPLY]="KEXDH_GEX_REPLY";var a=t.KEXDH_MESSAGE={};a[o.KEXDH_INIT]="KEXDH_INIT",a[o.KEXDH_REPLY]="KEXDH_REPLY";var f=t.DISCONNECT_REASON={HOST_NOT_ALLOWED_TO_CONNECT:1,PROTOCOL_ERROR:2,KEY_EXCHANGE_FAILED:3,RESERVED:4,MAC_ERROR:5,COMPRESSION_ERROR:6,SERVICE_NOT_AVAILABLE:7,PROTOCOL_VERSION_NOT_SUPPORTED:8,HOST_KEY_NOT_VERIFIABLE:9,CONNECTION_LOST:10,BY_APPLICATION:11,TOO_MANY_CONNECTIONS:12,AUTH_CANCELED_BY_USER:13,NO_MORE_AUTH_METHODS_AVAILABLE:14,ILLEGAL_USER_NAME:15};for(r=0,n=(i=Object.keys(f)).length;r<n;++r)f[f[i[r]]]=i[r];var h=t.CHANNEL_OPEN_FAILURE={ADMINISTRATIVELY_PROHIBITED:1,CONNECT_FAILED:2,UNKNOWN_CHANNEL_TYPE:3,RESOURCE_SHORTAGE:4};for(r=0,n=(i=Object.keys(h)).length;r<n;++r)h[h[i[r]]]=i[r];var c=t.TERMINAL_MODE={TTY_OP_END:0,VINTR:1,VQUIT:2,VERASE:3,VKILL:4,VEOF:5,VEOL:6,VEOL2:7,VSTART:8,VSTOP:9,VSUSP:10,VDSUSP:11,VREPRINT:12,VWERASE:13,VLNEXT:14,VFLUSH:15,VSWTCH:16,VSTATUS:17,VDISCARD:18,IGNPAR:30,PARMRK:31,INPCK:32,ISTRIP:33,INLCR:34,IGNCR:35,ICRNL:36,IUCLC:37,IXON:38,IXANY:39,IXOFF:40,IMAXBEL:41,ISIG:50,ICANON:51,XCASE:52,ECHO:53,ECHOE:54,ECHOK:55,ECHONL:56,NOFLSH:57,TOSTOP:58,IEXTEN:59,ECHOCTL:60,ECHOKE:61,PENDIN:62,OPOST:70,OLCUC:71,ONLCR:72,OCRNL:73,ONOCR:74,ONLRET:75,CS7:90,CS8:91,PARENB:92,PARODD:93,TTY_OP_ISPEED:128,TTY_OP_OSPEED:129};for(r=0,n=(i=Object.keys(c)).length;r<n;++r)c[c[i[r]]]=i[r];var u=t.CHANNEL_EXTENDED_DATATYPE={STDERR:1};for(r=0,n=(i=Object.keys(u)).length;r<n;++r)u[u[i[r]]]=i[r];t.SIGNALS=["ABRT","ALRM","FPE","HUP","ILL","INT","QUIT","SEGV","TERM","USR1","USR2","KILL","PIPE"];var l=["ecdh-sha2-nistp256","ecdh-sha2-nistp384","ecdh-sha2-nistp521","diffie-hellman-group-exchange-sha256","diffie-hellman-group14-sha1"],p=["diffie-hellman-group-exchange-sha1","diffie-hellman-group1-sha1"],d=Buffer.from(l.join(","),"ascii");p=l.concat(p);var g=["ssh-rsa","ecdsa-sha2-nistp256","ecdsa-sha2-nistp384","ecdsa-sha2-nistp521"],E=["ssh-dss"],v=Buffer.from(g.join(","),"ascii");E=g.concat(E);var m=["aes128-ctr","aes192-ctr","aes256-ctr","aes128-gcm","aes128-gcm@openssh.com","aes256-gcm","aes256-gcm@openssh.com"],y=["aes256-cbc","aes192-cbc","aes128-cbc","blowfish-cbc","3des-cbc","arcfour256","arcfour128","cast128-cbc","arcfour"],_=Buffer.from(m.join(","),"ascii");y=m.concat(y);var w=["hmac-sha2-256","hmac-sha2-512","hmac-sha1"],b=["hmac-md5","hmac-sha2-256-96","hmac-sha2-512-96","hmac-ripemd160","hmac-sha1-96","hmac-md5-96"],S=Buffer.from(w.join(","),"ascii");b=w.concat(b);var A=["none","zlib@openssh.com","zlib"],T=[],U=Buffer.from(A.join(","),"ascii");function B(e,t,r,i,n,o){return{blockLen:e,keyLen:t,ivLen:0===r?e:r,authLen:i,discardLen:n,stream:o}}function k(e,t){return{len:e,actualLen:t}}T=A.concat(T),t.CIPHER_INFO={"aes128-gcm":B(16,16,12,16,0,!1),"aes256-gcm":B(16,32,12,16,0,!1),"aes128-gcm@openssh.com":B(16,16,12,16,0,!1),"aes256-gcm@openssh.com":B(16,32,12,16,0,!1),"aes128-cbc":B(16,16,0,0,0,!1),"aes192-cbc":B(16,24,0,0,0,!1),"aes256-cbc":B(16,32,0,0,0,!1),"rijndael-cbc@lysator.liu.se":B(16,32,0,0,0,!1),"3des-cbc":B(8,24,0,0,0,!1),"blowfish-cbc":B(8,16,0,0,0,!1),"idea-cbc":B(8,16,0,0,0,!1),"cast128-cbc":B(8,16,0,0,0,!1),"camellia128-cbc":B(16,16,0,0,0,!1),"camellia192-cbc":B(16,24,0,0,0,!1),"camellia256-cbc":B(16,32,0,0,0,!1),"camellia128-cbc@openssh.com":B(16,16,0,0,0,!1),"camellia192-cbc@openssh.com":B(16,24,0,0,0,!1),"camellia256-cbc@openssh.com":B(16,32,0,0,0,!1),"aes128-ctr":B(16,16,0,0,0,!1),"aes192-ctr":B(16,24,0,0,0,!1),"aes256-ctr":B(16,32,0,0,0,!1),"3des-ctr":B(8,24,0,0,0,!1),"blowfish-ctr":B(8,16,0,0,0,!1),"cast128-ctr":B(8,16,0,0,0,!1),"camellia128-ctr":B(16,16,0,0,0,!1),"camellia192-ctr":B(16,24,0,0,0,!1),"camellia256-ctr":B(16,32,0,0,0,!1),"camellia128-ctr@openssh.com":B(16,16,0,0,0,!1),"camellia192-ctr@openssh.com":B(16,24,0,0,0,!1),"camellia256-ctr@openssh.com":B(16,32,0,0,0,!1),arcfour:B(8,16,0,0,1536,!0),arcfour128:B(8,16,0,0,1536,!0),arcfour256:B(8,32,0,0,1536,!0),arcfour512:B(8,64,0,0,1536,!0)},t.HMAC_INFO={"hmac-md5":k(16,16),"hmac-md5-96":k(16,12),"hmac-ripemd160":k(20,20),"hmac-sha1":k(20,20),"hmac-sha1-96":k(20,12),"hmac-sha2-256":k(32,32),"hmac-sha2-256-96":k(32,12),"hmac-sha2-512":k(64,64),"hmac-sha2-512-96":k(64,12)},t.ALGORITHMS={KEX:l,KEX_BUF:d,SUPPORTED_KEX:p,SERVER_HOST_KEY:g,SERVER_HOST_KEY_BUF:v,SUPPORTED_SERVER_HOST_KEY:E,CIPHER:m,CIPHER_BUF:_,SUPPORTED_CIPHER:y,HMAC:w,HMAC_BUF:S,SUPPORTED_HMAC:b,COMPRESS:A,COMPRESS_BUF:U,SUPPORTED_COMPRESS:T},t.SSH_TO_OPENSSL={"ecdh-sha2-nistp256":"prime256v1","ecdh-sha2-nistp384":"secp384r1","ecdh-sha2-nistp521":"secp521r1","aes128-gcm":"aes-128-gcm","aes256-gcm":"aes-256-gcm","aes128-gcm@openssh.com":"aes-128-gcm","aes256-gcm@openssh.com":"aes-256-gcm","3des-cbc":"des-ede3-cbc","blowfish-cbc":"bf-cbc","aes256-cbc":"aes-256-cbc","aes192-cbc":"aes-192-cbc","aes128-cbc":"aes-128-cbc","idea-cbc":"idea-cbc","cast128-cbc":"cast-cbc","rijndael-cbc@lysator.liu.se":"aes-256-cbc",arcfour128:"rc4",arcfour256:"rc4",arcfour512:"rc4",arcfour:"rc4","camellia128-cbc":"camellia-128-cbc","camellia192-cbc":"camellia-192-cbc","camellia256-cbc":"camellia-256-cbc","camellia128-cbc@openssh.com":"camellia-128-cbc","camellia192-cbc@openssh.com":"camellia-192-cbc","camellia256-cbc@openssh.com":"camellia-256-cbc","3des-ctr":"des-ede3","blowfish-ctr":"bf-ecb","aes256-ctr":"aes-256-ctr","aes192-ctr":"aes-192-ctr","aes128-ctr":"aes-128-ctr","cast128-ctr":"cast5-ecb","camellia128-ctr":"camellia-128-ecb","camellia192-ctr":"camellia-192-ecb","camellia256-ctr":"camellia-256-ecb","camellia128-ctr@openssh.com":"camellia-128-ecb","camellia192-ctr@openssh.com":"camellia-192-ecb","camellia256-ctr@openssh.com":"camellia-256-ecb","hmac-sha1-96":"sha1","hmac-sha1":"sha1","hmac-sha2-256":"sha256","hmac-sha2-256-96":"sha256","hmac-sha2-512":"sha512","hmac-sha2-512-96":"sha512","hmac-md5-96":"md5","hmac-md5":"md5","hmac-ripemd160":"ripemd160"};var N=t.BUGS={BAD_DHGEX:1,OLD_EXIT:2,DYN_RPORT_BUG:4};t.BUGGY_IMPLS=[["Cisco-1.25",N.BAD_DHGEX],[/^[0-9.]+$/,N.OLD_EXIT],[/^OpenSSH_5\.\d+/,N.DYN_RPORT_BUG]]},function(e,t,r){var i=r(38);e.exports={Ber:i,BerReader:i.Reader,BerWriter:i.Writer}},function(e,t,r){"use strict";var i,n=r(15),o=n.Buffer,s={};for(i in n)n.hasOwnProperty(i)&&"SlowBuffer"!==i&&"Buffer"!==i&&(s[i]=n[i]);var a=s.Buffer={};for(i in o)o.hasOwnProperty(i)&&"allocUnsafe"!==i&&"allocUnsafeSlow"!==i&&(a[i]=o[i]);if(s.Buffer.prototype=o.prototype,a.from&&a.from!==Uint8Array.from||(a.from=function(e,t,r){if("number"==typeof e)throw new TypeError('The "value" argument must not be of type number. Received type '+typeof e);if(e&&void 0===e.length)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof e);return o(e,t,r)}),a.alloc||(a.alloc=function(e,t,r){if("number"!=typeof e)throw new TypeError('The "size" argument must be of type number. Received type '+typeof e);if(e<0||e>=2*(1<<30))throw new RangeError('The value "'+e+'" is invalid for option "size"');var i=o(e);return t&&0!==t.length?"string"==typeof r?i.fill(t,r):i.fill(t):i.fill(0),i}),!s.kStringMaxLength)try{s.kStringMaxLength=process.binding("buffer").kStringMaxLength}catch(e){}s.constants||(s.constants={MAX_LENGTH:s.kMaxLength},s.kStringMaxLength&&(s.constants.MAX_STRING_LENGTH=s.kStringMaxLength)),e.exports=s},function(e,t,r){var i,n,o=r(12),s=o.createSign,a=o.createVerify,f=o.createDecipheriv,h=o.createHash,c=o.createHmac,u=o.getCiphers(),l=r(28).Ber,p=r(41).pbkdf,d=r(22),g=d.readUInt32BE,E=d.writeUInt32BE,v=r(27),m=v.ALGORITHMS.SUPPORTED_CIPHER,y=v.CIPHER_INFO,_=v.SSH_TO_OPENSSL,w=Symbol("Hash Algorithm"),b=Symbol("Private key PEM"),S=Symbol("Public key PEM"),A=Symbol("Public key SSH"),T=Symbol("Decrypted Key"),U=Object.create(null);function B(e,t){return"-----BEGIN "+e+" KEY-----\n"+(t=t.toString("base64")).replace(/.{64}/g,"$&\n")+(t.length%64?"\n":"")+"-----END "+e+" KEY-----"}function k(e,t){var r=Buffer.allocUnsafe(e.length+t.length);return e.copy(r,0),t.copy(r,e.length),r}function N(e,t){for(var r=e.length,i=e._pos||0,n=0;n<t;++n){var o=r-i;if(i>=r||o<4)return!1;var s=g(e,i);if(o<4+s)return!1;i+=4+s}return e._pos=i,!0}function R(e,t){var r=new l.Writer;return r.startSequence(),r.startSequence(),r.writeOID("1.2.840.113549.1.1.1"),r.writeNull(),r.endSequence(),r.startSequence(l.BitString),r.writeByte(0),r.startSequence(),r.writeBuffer(e,l.Integer),r.writeBuffer(t,l.Integer),r.endSequence(),r.endSequence(),r.endSequence(),B("PUBLIC",r.buffer)}function O(e,t){var r=Buffer.allocUnsafe(15+e.length+4+t.length);E(r,7,0),r.write("ssh-rsa",4,7,"ascii");var i=11;return E(r,t.length,i),t.copy(r,i+=4),E(r,e.length,i+=t.length),e.copy(r,i+4),r}!function(){for(var e=Object.keys(y),t=0;t<e.length;++t){var r=_[e[t]];r&&!U[r]&&(U[r]=y[e[t]])}}(),n="function"==typeof String.prototype.trimStart?function(e){return e.trimStart()}:function(e){for(var t=0,r=0;r<e.length;++r){switch(e.charCodeAt(r)){case 32:case 9:case 13:case 10:case 12:++t;continue}break}return 0===t?e:e.slice(t)};var D=function(){function e(e,t,r,i,n,o,s,a){var f=new l.Writer;return f.startSequence(),f.writeInt(0,l.Integer),f.writeBuffer(e,l.Integer),f.writeBuffer(t,l.Integer),f.writeBuffer(r,l.Integer),f.writeBuffer(i,l.Integer),f.writeBuffer(n,l.Integer),f.writeBuffer(o,l.Integer),f.writeBuffer(s,l.Integer),f.writeBuffer(a,l.Integer),f.endSequence(),f.buffer}try{var t=["return function genOpenSSLRSAPriv(n, e, d, iqmp, p, q) {","  var bn_d = bigIntFromBuffer(d);","  var dmp1 = bigIntToBuffer(bn_d % (bigIntFromBuffer(p) - 1n));","  var dmq1 = bigIntToBuffer(bn_d % (bigIntFromBuffer(q) - 1n));","  return makePEM('RSA PRIVATE', genRSAASN1Buf(n, e, d, p, q, dmp1, dmq1, iqmp));","};"].join("\n");return new Function("bigIntFromBuffer, bigIntToBuffer, makePEM, genRSAASN1Buf",t)(function(e){return BigInt("0x"+e.toString("hex"))},function(e){var t=e.toString(16);if(0!=(1&t.length))t="0"+t;else{var r=t.charCodeAt(0);(56===r||r>=97&&r<=102)&&(t="00"+t)}return Buffer.from(t,"hex")},B,e)}catch(t){return i=r(43),function(t,r,n,o,s,a){var f=new i(s,256),h=new i(a,256),c=new i(n,256),u=c.mod(f.subtract(i.ONE)),l=c.mod(h.subtract(i.ONE));return B("RSA PRIVATE",e(t,r,n,s,a,Buffer.from(u.toByteArray()),Buffer.from(l.toByteArray()),o))}}var i}();function C(e,t,r,i){var n=new l.Writer;return n.startSequence(),n.startSequence(),n.writeOID("1.2.840.10040.4.1"),n.startSequence(),n.writeBuffer(e,l.Integer),n.writeBuffer(t,l.Integer),n.writeBuffer(r,l.Integer),n.endSequence(),n.endSequence(),n.startSequence(l.BitString),n.writeByte(0),n.writeBuffer(i,l.Integer),n.endSequence(),n.endSequence(),B("PUBLIC",n.buffer)}function L(e,t,r,i){var n=Buffer.allocUnsafe(15+e.length+4+t.length+4+r.length+4+i.length);E(n,7,0),n.write("ssh-dss",4,7,"ascii");var o=11;return E(n,e.length,o),e.copy(n,o+=4),E(n,t.length,o+=e.length),t.copy(n,o+=4),E(n,r.length,o+=t.length),r.copy(n,o+=4),E(n,i.length,o+=r.length),i.copy(n,o+4),n}function I(e,t,r,i,n){var o=new l.Writer;return o.startSequence(),o.writeInt(0,l.Integer),o.writeBuffer(e,l.Integer),o.writeBuffer(t,l.Integer),o.writeBuffer(r,l.Integer),o.writeBuffer(i,l.Integer),o.writeBuffer(n,l.Integer),o.endSequence(),B("DSA PRIVATE",o.buffer)}function P(e,t){var r=new l.Writer;return r.startSequence(),r.startSequence(),r.writeOID("1.2.840.10045.2.1"),r.writeOID(e),r.endSequence(),r.startSequence(l.BitString),r.writeByte(0),r._ensure(t.length),t.copy(r._buf,r._offset,0,t.length),r._offset+=t.length,r.endSequence(),r.endSequence(),B("PUBLIC",r.buffer)}function H(e,t){var r;switch(e){case"1.2.840.10045.3.1.7":r="nistp256";break;case"1.3.132.0.34":r="nistp384";break;case"1.3.132.0.35":r="nistp521";break;default:return}var i=Buffer.allocUnsafe(39+t.length);return E(i,19,0),i.write("ecdsa-sha2-"+r,4,19,"ascii"),E(i,8,23),i.write(r,27,8,"ascii"),E(i,t.length,35),t.copy(i,39),i}function x(e,t,r){var i=new l.Writer;return i.startSequence(),i.writeInt(1,l.Integer),i.writeBuffer(r,l.OctetString),i.startSequence(160),i.writeOID(e),i.endSequence(),i.startSequence(161),i.startSequence(l.BitString),i.writeByte(0),i._ensure(t.length),t.copy(i._buf,i._offset,0,t.length),i._offset+=t.length,i.endSequence(),i.endSequence(),i.endSequence(),B("EC PRIVATE",i.buffer)}var M,G={sign:function(e){var t=this[b];if(null===t)return new Error("No private key available");var r=s(this[w]);return r.update(e),function(e,t){try{return e.sign(t)}catch(e){return e}}(r,t)},verify:function(e,t){var r=this[S];if(null===r)return new Error("No public key available");var i=a(this[w]);return i.update(e),function(e,t,r){try{return e.verify(t,r)}catch(e){return e}}(i,r,t)},getPrivatePEM:function(){return this[b]},getPublicPEM:function(){return this[S]},getPublicSSH:function(){return this[A]}};function K(e,t,r,i,n,o,s){this.type=e,this.comment=t,this[b]=r,this[S]=i,this[A]=n,this[w]=o,this[T]=s}function F(e,t,r,i,n,o,s){this.type=e,this.comment=t,this[b]=r,this[S]=i,this[A]=n,this[w]=o,this[T]=s}function q(e,t,r,i,n,o,s){this.type=e,this.comment=t,this[b]=r,this[S]=i,this[A]=n,this[w]=o,this[T]=s}function W(e,t,r,i,n){this.type=e,this.comment=t,this[b]=null,this[S]=r,this[A]=i,this[w]=n,this[T]=!1}function X(e,t,r,i,n){this.type=e,this.comment=t,this[b]=null,this[S]=r,this[A]=i,this[w]=n,this[T]=!1}K.prototype=G,function(){var e=/^-----BEGIN OPENSSH PRIVATE KEY-----(?:\r\n|\n)([\s\S]+)(?:\r\n|\n)-----END OPENSSH PRIVATE KEY-----$/;K.parse=function(t,n){var o,s=e.exec(t);if(null===s)return null;var a=Buffer.from(s[1],"base64");if(a.length<31)return new Error("Malformed OpenSSH private key");var h=a.toString("ascii",0,15);if("openssh-key-v1\0"!==h)return new Error("Unsupported OpenSSH key magic: "+h);i||(i=r(21));var c=i.readString(a,15,"ascii");if(!1===c)return new Error("Malformed OpenSSH private key");if("none"!==c&&-1===m.indexOf(c))return new Error("Unsupported cipher for OpenSSH key: "+c);var u,l,d,E=i.readString(a,a._pos,"ascii");if(!1===E)return new Error("Malformed OpenSSH private key");if("none"!==E){if("none"===c)return new Error("Malformed OpenSSH private key");if("bcrypt"!==E)return new Error("Unsupported kdf name for OpenSSH key: "+E);if(!n)return new Error("Encrypted private OpenSSH key detected, but no passphrase given")}else if("none"!==c)return new Error("Malformed OpenSSH private key");"none"!==c&&(u=y[c]);var v=i.readString(a,a._pos);if(!1===v)return new Error("Malformed OpenSSH private key");if(v.length)switch(E){case"none":return new Error("Malformed OpenSSH private key");case"bcrypt":var w=i.readString(v,0);if(!1===w||v._pos+4>v.length)return new Error("Malformed OpenSSH private key");var b=g(v,v._pos),S=Buffer.allocUnsafe(u.keyLen+u.ivLen);if(0!==p(n,n.length,w,w.length,S,S.length,b))return new Error("Failed to generate information to decrypt key");l=S.slice(0,u.keyLen),d=S.slice(u.keyLen)}else if("none"!==E)return new Error("Malformed OpenSSH private key");var A=i.readInt(a,a._pos);if(!1===A)return new Error("Malformed OpenSSH private key");if(a._pos+=4,A>0){for(var T=0;T<A;++T){var U=i.readString(a,a._pos);if(!1===U)return new Error("Malformed OpenSSH private key");if(!1===i.readString(U,0,"ascii"))return new Error("Malformed OpenSSH private key")}var B=i.readString(a,a._pos);if(!1===B)return new Error("Malformed OpenSSH private key");if(void 0!==l){if(B.length<u.blockLen||B.length%u.blockLen!=0)return new Error("Malformed OpenSSH private key");try{var M={authTagLength:u.authLen},G=f(_[c],l,d,M);if(u.authLen>0){if(a.length-a._pos<u.authLen)return new Error("Malformed OpenSSH private key");G.setAuthTag(a.slice(a._pos,a._pos+=u.authLen))}B=k(G.update(B),G.final())}catch(e){return e}}if(a._pos!==a.length)return new Error("Malformed OpenSSH private key");o=function(e,t,r){var n=[];if(e.length<8)return new Error("Malformed OpenSSH private key");var o,s,a=g(e,0),f=g(e,4);if(a!==f)return r?new Error("OpenSSH key integrity check failed -- bad passphrase?"):new Error("OpenSSH key integrity check failed");for(e._pos=8,o=0;o<t;++o){var h=void 0,c=void 0,u=void 0,l=void 0,p=i.readString(e,e._pos,"ascii");if(!1===p)return new Error("Malformed OpenSSH private key");switch(p){case"ssh-rsa":var d=i.readString(e,e._pos);if(!1===d)return new Error("Malformed OpenSSH private key");var E=i.readString(e,e._pos);if(!1===E)return new Error("Malformed OpenSSH private key");var v=i.readString(e,e._pos);if(!1===v)return new Error("Malformed OpenSSH private key");var m=i.readString(e,e._pos);if(!1===m)return new Error("Malformed OpenSSH private key");var y=i.readString(e,e._pos);if(!1===y)return new Error("Malformed OpenSSH private key");var _=i.readString(e,e._pos);if(!1===_)return new Error("Malformed OpenSSH private key");u=R(d,E),l=O(d,E),c=D(d,E,v,m,y,_),h="sha1";break;case"ssh-dss":var y=i.readString(e,e._pos);if(!1===y)return new Error("Malformed OpenSSH private key");var _=i.readString(e,e._pos);if(!1===_)return new Error("Malformed OpenSSH private key");var w=i.readString(e,e._pos);if(!1===w)return new Error("Malformed OpenSSH private key");var b=i.readString(e,e._pos);if(!1===b)return new Error("Malformed OpenSSH private key");var S=i.readString(e,e._pos);if(!1===S)return new Error("Malformed OpenSSH private key");u=C(y,_,w,b),l=L(y,_,w,b),c=I(y,_,w,b,S),h="sha1";break;case"ecdsa-sha2-nistp256":h="sha256",s="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":void 0===h&&(h="sha384",s="1.3.132.0.34");case"ecdsa-sha2-nistp521":if(void 0===h&&(h="sha512",s="1.3.132.0.35"),!N(e,1))return new Error("Malformed OpenSSH private key");var A=i.readString(e,e._pos);if(!1===A)return new Error("Malformed OpenSSH private key");var T=i.readString(e,e._pos);if(!1===T)return new Error("Malformed OpenSSH private key");u=P(s,A),l=H(s,A),c=x(s,A,T);break;default:return new Error("Unsupported OpenSSH private key type: "+p)}var U=i.readString(e,e._pos,"utf8");if(!1===U)return new Error("Malformed OpenSSH private key");n.push(new K(p,U,c,u,l,h,r))}var B=0;for(o=e._pos;o<e.length;++o)if(e[o]!==++B%255)return new Error("Malformed OpenSSH private key");return n}(B,A,void 0!==l)}else o=[];return o}}(),F.prototype=G,M=/^-----BEGIN (RSA|DSA|EC) PRIVATE KEY-----(?:\r\n|\n)((?:[^:]+:\s*[\S].*(?:\r\n|\n))*)([\s\S]+)(?:\r\n|\n)-----END (RSA|DSA|EC) PRIVATE KEY-----$/,F.parse=function(e,t){var r=M.exec(e);if(null===r)return null;var i,n,s,a,c,p,d=Buffer.from(r[3],"base64"),g=r[2],E=!1;if(void 0!==g){g=g.split(/\r\n|\n/g);for(var v=0;v<g.length;++v){var m=g[v],y=m.indexOf(":");if("DEK-Info"===m.slice(0,y)){var _=m.slice(y+2);if(-1===(y=_.indexOf(",")))continue;var w=_.slice(0,y).toLowerCase();if(-1===u.indexOf(w))return new Error("Cipher ("+w+") not supported for encrypted OpenSSH private key");var b=U[w];if(!b)return new Error("Cipher ("+w+") not supported for encrypted OpenSSH private key");var S=Buffer.from(_.slice(y+1),"hex");if(S.length!==b.ivLen)return new Error("Malformed encrypted OpenSSH private key");if(!t)return new Error("Encrypted OpenSSH private key detected, but no passphrase given");for(var A=h("md5").update(t).update(S.slice(0,8)).digest();A.length<b.keyLen;)A=k(A,h("md5").update(A).update(t).update(S).digest().slice(0,8));A.length>b.keyLen&&(A=A.slice(0,b.keyLen));try{var T=f(w,A,S);T.setAutoPadding(!1),d=k(T.update(d),T.final()),E=!0}catch(e){return e}}}}var N,D,I,x="Malformed OpenSSH private key";switch(E&&(x+=". Bad passphrase?"),r[1]){case"RSA":i="ssh-rsa",n=B("RSA PRIVATE",d);try{(p=new l.Reader(d)).readSequence(),p.readInt();var G=p.readString(l.Integer,!0);if(null===G)return new Error(x);var K=p.readString(l.Integer,!0);if(null===K)return new Error(x);s=R(G,K),a=O(G,K)}catch(e){return new Error(x)}c="sha1";break;case"DSA":i="ssh-dss",n=B("DSA PRIVATE",d);try{(p=new l.Reader(d)).readSequence(),p.readInt();var q=p.readString(l.Integer,!0);if(null===q)return new Error(x);var W=p.readString(l.Integer,!0);if(null===W)return new Error(x);var X=p.readString(l.Integer,!0);if(null===X)return new Error(x);var V=p.readString(l.Integer,!0);if(null===V)return new Error(x);s=C(q,W,X,V),a=L(q,W,X,V)}catch(e){return new Error(x)}c="sha1";break;case"EC":var Q,Y;try{(p=new l.Reader(d)).readSequence(),p.readInt(),Y=p.readString(l.OctetString,!0),p.readByte();var z=p.readLength();if(null===z)return new Error(x);p._offset=z;var j=p.readOID();if(null===j)return new Error(x);switch(j){case"1.2.840.10045.3.1.7":Q="prime256v1",i="ecdsa-sha2-nistp256",c="sha256";break;case"1.3.132.0.34":Q="secp384r1",i="ecdsa-sha2-nistp384",c="sha384";break;case"1.3.132.0.35":Q="secp521r1",i="ecdsa-sha2-nistp521",c="sha512";break;default:return new Error("Unsupported private key EC OID: "+j)}}catch(e){return new Error(x)}n=B("EC PRIVATE",d);var Z=(N=Q,D=Y,(I=o.createECDH(N)).setPrivateKey(D),I.getPublicKey());s=P(j,Z),a=H(j,Z)}return new F(i,"",n,s,a,c,E)},q.prototype=G,function(){var e=Buffer.alloc(0),t=Buffer.from([0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=Buffer.from([0,0,0,0]),o=Buffer.from([0,0,0,1]),s=/^PuTTY-User-Key-File-2: (ssh-(?:rsa|dss))\r?\nEncryption: (aes256-cbc|none)\r?\nComment: ([^\r\n]*)\r?\nPublic-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-Lines: \d+\r?\n([\s\S]+?)\r?\nPrivate-MAC: ([^\r\n]+)/;q.parse=function(a,u){var l=s.exec(a);if(null===l)return null;var p=l[2],d="none"!==p;if(d&&!u)return new Error("Encrypted PPK private key detected, but no passphrase given");var g=Buffer.from(l[5],"base64");if(d){var v=y[p],m=k(h("sha1").update(n).update(u).digest(),h("sha1").update(o).update(u).digest());m.length>v.keyLen&&(m=m.slice(0,v.keyLen));try{var w=f(_[p],m,t);w.setAutoPadding(!1),g=k(w.update(g),w.final()),decrypted=!0}catch(e){return e}}var b,S,A,T=l[1],U=l[3],B=Buffer.from(l[4],"base64"),P=l[6],H=T.length,x=p.length,M=Buffer.byteLength(U),G=B.length,K=g.length,F=Buffer.allocUnsafe(4+H+4+x+4+M+4+G+4+K);if(E(F,H,Y=0),F.write(T,Y+=4,H,"ascii"),E(F,x,Y+=H),F.write(p,Y+=4,x,"ascii"),E(F,M,Y+=x),F.write(U,Y+=4,M,"utf8"),E(F,G,Y+=M),B.copy(F,Y+=4),E(F,K,Y+=G),g.copy(F,Y+4),u||(u=e),c("sha1",h("sha1").update("putty-private-key-file-mac-key").update(u).digest()).update(F).digest("hex")!==P)return d?new Error("PPK private key integrity check failed -- bad passphrase?"):new Error("PPK private key integrity check failed");switch(i||(i=r(21)),B._pos=0,N(B,1),T){case"ssh-rsa":var W=i.readString(B,B._pos);if(!1===W)return new Error("Malformed PPK public key");var X=i.readString(B,B._pos);if(!1===X)return new Error("Malformed PPK public key");var V=i.readString(g,0);if(!1===V)return new Error("Malformed PPK private key");if(!1===(Y=i.readString(g,g._pos)))return new Error("Malformed PPK private key");if(!1===(z=i.readString(g,g._pos)))return new Error("Malformed PPK private key");var Q=i.readString(g,g._pos);if(!1===Q)return new Error("Malformed PPK private key");b=R(X,W),S=O(X,W),A=D(X,W,V,Q,Y,z);break;case"ssh-dss":var Y,z;if(!1===(Y=i.readString(B,B._pos)))return new Error("Malformed PPK public key");if(!1===(z=i.readString(B,B._pos)))return new Error("Malformed PPK public key");var j=i.readString(B,B._pos);if(!1===j)return new Error("Malformed PPK public key");var Z=i.readString(B,B._pos);if(!1===Z)return new Error("Malformed PPK public key");var $=i.readString(g,0);if(!1===$)return new Error("Malformed PPK private key");b=C(Y,z,j,Z),S=L(Y,z,j,Z),A=I(Y,z,j,Z,$)}return new q(T,U,A,b,S,"sha1",d)}}(),W.prototype=G,function(){var e=/^(((?:ssh-(?:rsa|dss))|ecdsa-sha2-nistp(?:256|384|521))(?:-cert-v0[01]@openssh.com)?) ([A-Z0-9a-z\/+=]+)(?:$|\s+([\S].*)?)$/;W.parse=function(t){var n=e.exec(t);if(null===n)return null;i||(i=r(21));var o,s=n[1],a=n[2],f=Buffer.from(n[3],"base64"),h=n[4]||"",c=i.readString(f,f._pos,"ascii");if(!1===c||0!==c.indexOf(a))return new Error("Malformed OpenSSH public key");var u=null,l=null;switch(a){case"ssh-rsa":var p=i.readString(f,f._pos);if(!1===p)return new Error("Malformed OpenSSH public key");var d=i.readString(f,f._pos);if(!1===d)return new Error("Malformed OpenSSH public key");u=R(d,p),l=O(d,p),o="sha1";break;case"ssh-dss":var g=i.readString(f,f._pos);if(!1===g)return new Error("Malformed OpenSSH public key");var E=i.readString(f,f._pos);if(!1===E)return new Error("Malformed OpenSSH public key");var v=i.readString(f,f._pos);if(!1===v)return new Error("Malformed OpenSSH public key");var m=i.readString(f,f._pos);if(!1===m)return new Error("Malformed OpenSSH public key");u=C(g,E,v,m),l=L(g,E,v,m),o="sha1";break;case"ecdsa-sha2-nistp256":o="sha256",oid="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":void 0===o&&(o="sha384",oid="1.3.132.0.34");case"ecdsa-sha2-nistp521":if(void 0===o&&(o="sha512",oid="1.3.132.0.35"),!N(f,1))return new Error("Malformed OpenSSH public key");var y=i.readString(f,f._pos);if(!1===y)return new Error("Malformed OpenSSH public key");u=P(oid,y),l=H(oid,y)}return new W(s,h,u,l,o)}}(),X.prototype=G,function(){var e=/^---- BEGIN SSH2 PUBLIC KEY ----(?:\r\n|\n)((?:(?:[\x21-\x7E]+?):(?:(?:.*?\\\r?\n)*.*)(?:\r\n|\n))*)((?:[A-Z0-9a-z\/+=]+(?:\r\n|\n))+)---- END SSH2 PUBLIC KEY ----$/,t=/^([\x21-\x7E]+?):((?:.*?\\\r?\n)*.*)$/gm,o=/\\\r?\n/g;X.parse=function(s){var a=e.exec(s);if(null===a)return null;var f=a[1],h=Buffer.from(a[2],"base64"),c="";if(void 0!==f)for(;a=t.exec(f);)"comment"===a[1].toLowerCase()&&(c=n(a[2].replace(o,""))).length>1&&34===c.charCodeAt(0)&&34===c.charCodeAt(c.length-1)&&(c=c.slice(1,-1));i||(i=r(21));var u=i.readString(h,0,"ascii");if(!1===u)return new Error("Malformed RFC4716 public key");var l=null,p=null;switch(u){case"ssh-rsa":var d=i.readString(h,h._pos);if(!1===d)return new Error("Malformed RFC4716 public key");var g=i.readString(h,h._pos);if(!1===g)return new Error("Malformed RFC4716 public key");l=R(g,d),p=O(g,d);break;case"ssh-dss":var E=i.readString(h,h._pos);if(!1===E)return new Error("Malformed RFC4716 public key");var v=i.readString(h,h._pos);if(!1===v)return new Error("Malformed RFC4716 public key");var m=i.readString(h,h._pos);if(!1===m)return new Error("Malformed RFC4716 public key");var y=i.readString(h,h._pos);if(!1===y)return new Error("Malformed RFC4716 public key");l=C(E,v,m,y),p=L(E,v,m,y);break;default:return new Error("Malformed RFC4716 public key")}return new X(u,c,l,p,"sha1")}}(),e.exports={pubDERToPEM:function(e,t){var n;switch(i||(i=r(21)),t){case"ssh-rsa":var o=i.readString(e,e._pos||0);if(!1===o)return new Error("Malformed DER RSA public key");var s=i.readString(e,e._pos);return!1===s?new Error("Malformed DER RSA public key"):R(s,o);case"ssh-dss":var a=i.readString(e,e._pos||0);if(!1===a)return new Error("Malformed DER DSA public key");var f=i.readString(e,e._pos);if(!1===f)return new Error("Malformed DER DSA public key");var h=i.readString(e,e._pos);if(!1===h)return new Error("Malformed DER DSA public key");var c=i.readString(e,e._pos);return!1===c?new Error("Malformed DER DSA public key"):C(a,f,h,c);case"ecdsa-sha2-nistp256":n="1.2.840.10045.3.1.7";case"ecdsa-sha2-nistp384":void 0===n&&(n="1.3.132.0.34");case"ecdsa-sha2-nistp521":if(void 0===n&&(n="1.3.132.0.35"),!1===i.readString(e,e._pos||0))return new Error("Malformed DER ECDSA public key");var u=i.readString(e,e._pos);return!1===u?new Error("Malformed DER ECDSA public key"):P(n,u)}return new Error("Unsupported key format")},parseKey:function(e,t){if(Buffer.isBuffer(e))e=e.toString("utf8").trim();else{if("string"!=typeof e)return new Error("Key data must be a Buffer or string");e=e.trim()}if(null!=t)if("string"==typeof t)t=Buffer.from(t);else if(!Buffer.isBuffer(t))return new Error("Passphrase must be a string or Buffer when supplied");var r;return null!==(r=K.parse(e,t))?r:null!==(r=F.parse(e,t))?r:null!==(r=q.parse(e,t))?r:null!==(r=W.parse(e))?r:null!==(r=X.parse(e))?r:new Error("Unsupported key format")}}},function(e,t,r){var i=r(7).inherits,n=r(8).Duplex,o=r(8).Readable,s=r(8).Writable,a=r(24).constants.CHANNEL_EXTENDED_DATATYPE.STDERR,f=1048576,h=f/2,c=["CHANNEL_EOF","CHANNEL_CLOSE","CHANNEL_DATA","CHANNEL_EXTENDED_DATA","CHANNEL_WINDOW_ADJUST","CHANNEL_SUCCESS","CHANNEL_FAILURE","CHANNEL_REQUEST"],u=c.length;function l(e,t,r){var i={highWaterMark:f,allowHalfOpen:!r||r&&!1!==r.allowHalfOpen};this.allowHalfOpen=i.allowHalfOpen,n.call(this,i);var s=this,a=r&&r.server;this.server=a,this.type=e.type,this.subtype=void 0;var l,g,E,v,m,y=this.incoming=e.incoming,_=y.id,w=this.outgoing=e.outgoing,b=this._callbacks=[];this._client=t,this._hasX11=!1;var S=t._channels,A=t._sshstream;function T(){s._waitClientDrain&&(s._waitClientDrain=!1,s._waitWindow||(s._chunk?s._write(s._chunk,null,s._chunkcb):s._chunkcb?s._chunkcb():s._chunkErr?s.stderr._write(s._chunkErr,null,s._chunkcbErr):s._chunkcbErr&&s._chunkcbErr()))}function U(){s.eof(),(a||!a&&!s.allowHalfOpen)&&s.close(),s.writable=!1}function B(){s.readable=!1}t._sock.on("drain",T),A.once("CHANNEL_EOF:"+_,function(){"open"===y.state&&(y.state="eof",s.readable&&s.push(null),!a&&s.stderr.readable&&s.stderr.push(null))}).once("CHANNEL_CLOSE:"+_,function(){if("closed"!==y.state){y.state="closed",s.readable&&s.push(null),a&&s.stderr.writable?s.stderr.end():!a&&s.stderr.readable&&s.stderr.push(null),"open"!==w.state&&"eof"!==w.state||s.close(),"closing"===w.state&&(w.state="closed"),delete S[_];var e=s._writableState;t._sock.removeListener("drain",T),e.ending||e.finished||s.end(),s._callbacks=[];for(var r=0;r<b.length;++r)b[r](!0);b=s._callbacks,a?s.readable?s.once("end",function(){s.emit("close")}):s.emit("close"):(s.readable?s.once("end",function(){null===l?s.emit("close",l,g,E,v,m):s.emit("close",l)}):null===l?s.emit("close",l,g,E,v,m):s.emit("close",l),s.stderr.readable?s.stderr.once("end",function(){s.stderr.emit("close")}):s.stderr.emit("close"));for(r=0;r<u;++r)A.removeAllListeners(c[r]+":"+_)}}).on("CHANNEL_DATA:"+_,function(e){0!==y.window&&(y.window-=e.length,s.push(e)?y.window<=h&&p(s):s._waitChanDrain=!0)}).on("CHANNEL_WINDOW_ADJUST:"+_,function(e){w.window+=e,s._waitWindow&&(s._waitWindow=!1,s._waitClientDrain||(s._chunk?s._write(s._chunk,null,s._chunkcb):s._chunkcb?s._chunkcb():s._chunkErr?s.stderr._write(s._chunkErr,null,s._chunkcbErr):s._chunkcbErr&&s._chunkcbErr()))}).on("CHANNEL_SUCCESS:"+_,function(){a?(A._kalast=Date.now(),A._kacnt=0):t._resetKA(),b.length&&b.shift()(!1)}).on("CHANNEL_FAILURE:"+_,function(){a?(A._kalast=Date.now(),A._kacnt=0):t._resetKA(),b.length&&b.shift()(!0)}).on("CHANNEL_REQUEST:"+_,function(e){if(!a){if("exit-status"===e.request)return void s.emit("exit",l=e.code);if("exit-signal"===e.request)return void s.emit("exit",l=null,g="SIG"+e.signal,E=e.coredump,v=e.description,m=e.lang)}e.wantReply&&A.channelFailure(w.id)}),this.stdin=this.stdout=this,a?this.stderr=new d(this):(this.stderr=new o(i),this.stderr._read=function(e){s._waitChanDrain&&(s._waitChanDrain=!1,y.window<=h&&p(s))},A.on("CHANNEL_EXTENDED_DATA:"+_,function(e,t){0!==y.window&&(y.window-=t.length,s.stderr.push(t)?y.window<=h&&p(s):s._waitChanDrain=!0)})),this._waitClientDrain=!1,this._waitWindow=!1,this._waitChanDrain=!1,this._chunk=void 0,this._chunkcb=void 0,this._chunkErr=void 0,this._chunkcbErr=void 0,this.on("finish",U).on("prefinish",U),this.on("end",B).on("close",B)}function p(e){if("closed"===e.outgoing.state)return!0;var t=f-e.incoming.window;return t<=0||(e.incoming.window+=t,e._client._sshstream.channelWindowAdjust(e.outgoing.id,t))}function d(e){s.call(this,{highWaterMark:f}),this._channel=e}i(l,n),l.prototype.eof=function(){var e=!0,t=this.outgoing;return"open"===t.state&&(t.state="eof",e=this._client._sshstream.channelEOF(t.id)),e},l.prototype.close=function(){var e=!0,t=this.outgoing;return"open"!==t.state&&"eof"!==t.state||(t.state="closing",e=this._client._sshstream.channelClose(t.id)),e},l.prototype._read=function(e){this._waitChanDrain&&(this._waitChanDrain=!1,this.incoming.window<=h&&p(this))},l.prototype._write=function(e,t,r){var i,n,o,s=this._client._sshstream,a=this.outgoing,f=a.packetSize,h=a.id,c=a.window,u=e.length,l=0;if("open"===a.state){for(;u-l>0&&c>0;)if((o=u-l)>c&&(o=c),o>f&&(o=f),i=s.channelData(h,e.slice(l,l+o)),l+=o,c-=o,!i){this._waitClientDrain=!0,this._chunk=void 0,this._chunkcb=r;break}if(a.window=c,u-l>0)return 0===c&&(this._waitWindow=!0),l>0?(n=Buffer.allocUnsafe(u-l),e.copy(n,0,l),this._chunk=n):this._chunk=e,void(this._chunkcb=r);this._waitClientDrain||r()}},l.prototype.destroy=function(){this.end()},l.prototype.setWindow=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||"shell"!==this.subtype&&"exec"!==this.subtype||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.windowChange(this.outgoing.id,e,t,r,i)},l.prototype.signal=function(e){if(this.server)throw new Error("Client-only method called in server mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||this._client._sshstream.signal(this.outgoing.id,e)},l.prototype.exit=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");return"session"!==this.type||!this.writable||"open"!==this.outgoing.state||("number"==typeof e?this._client._sshstream.exitStatus(this.outgoing.id,e):this._client._sshstream.exitSignal(this.outgoing.id,e,t,r))},l.MAX_WINDOW=f,l.PACKET_SIZE=32768,i(d,s),d.prototype._write=function(e,t,r){var i,n,o,s=this._channel,f=s._client._sshstream,h=s.outgoing,c=h.packetSize,u=h.id,l=h.window,p=e.length,d=0;if("open"===s.outgoing.state){for(;p-d>0&&l>0;)if((o=p-d)>l&&(o=l),o>c&&(o=c),i=f.channelExtData(u,e.slice(d,d+o),a),d+=o,l-=o,!i){s._waitClientDrain=!0,s._chunkErr=void 0,s._chunkcbErr=r;break}if(h.window=l,p-d>0)return 0===l&&(s._waitWindow=!0),d>0?(n=Buffer.allocUnsafe(p-d),e.copy(n,0,d),s._chunkErr=n):s._chunkErr=e,void(s._chunkcbErr=r);s._waitClientDrain||r()}},e.exports=l},function(e,t,r){var i=r(7).inherits,n=r(9).EventEmitter;function o(e){var t=this;n.call(this),this._stream=e,e.on("error",function(e){t.emit("error",e)}).on("end",function(){t.emit("end")}).on("close",function(){t.emit("close")}).on("continue",function(){t.emit("continue")})}i(o,n),o.prototype.end=function(){return this._stream.end()},o.prototype.createReadStream=function(e,t){return this._stream.createReadStream(e,t)},o.prototype.createWriteStream=function(e,t){return this._stream.createWriteStream(e,t)},o.prototype.open=function(e,t,r,i){return this._stream.open(e,t,r,i)},o.prototype.close=function(e,t){return this._stream.close(e,t)},o.prototype.read=function(e,t,r,i,n,o){return this._stream.readData(e,t,r,i,n,o)},o.prototype.write=function(e,t,r,i,n,o){return this._stream.writeData(e,t,r,i,n,o)},o.prototype.fastGet=function(e,t,r,i){return this._stream.fastGet(e,t,r,i)},o.prototype.fastPut=function(e,t,r,i){return this._stream.fastPut(e,t,r,i)},o.prototype.readFile=function(e,t,r){return this._stream.readFile(e,t,r)},o.prototype.writeFile=function(e,t,r,i){return this._stream.writeFile(e,t,r,i)},o.prototype.appendFile=function(e,t,r,i){return this._stream.appendFile(e,t,r,i)},o.prototype.exists=function(e,t){return this._stream.exists(e,t)},o.prototype.unlink=function(e,t){return this._stream.unlink(e,t)},o.prototype.rename=function(e,t,r){return this._stream.rename(e,t,r)},o.prototype.mkdir=function(e,t,r){return this._stream.mkdir(e,t,r)},o.prototype.rmdir=function(e,t){return this._stream.rmdir(e,t)},o.prototype.readdir=function(e,t,r){return this._stream.readdir(e,t,r)},o.prototype.fstat=function(e,t){return this._stream.fstat(e,t)},o.prototype.stat=function(e,t){return this._stream.stat(e,t)},o.prototype.lstat=function(e,t){return this._stream.lstat(e,t)},o.prototype.opendir=function(e,t){return this._stream.opendir(e,t)},o.prototype.setstat=function(e,t,r){return this._stream.setstat(e,t,r)},o.prototype.fsetstat=function(e,t,r){return this._stream.fsetstat(e,t,r)},o.prototype.futimes=function(e,t,r,i){return this._stream.futimes(e,t,r,i)},o.prototype.utimes=function(e,t,r,i){return this._stream.utimes(e,t,r,i)},o.prototype.fchown=function(e,t,r,i){return this._stream.fchown(e,t,r,i)},o.prototype.chown=function(e,t,r,i){return this._stream.chown(e,t,r,i)},o.prototype.fchmod=function(e,t,r){return this._stream.fchmod(e,t,r)},o.prototype.chmod=function(e,t,r){return this._stream.chmod(e,t,r)},o.prototype.readlink=function(e,t){return this._stream.readlink(e,t)},o.prototype.symlink=function(e,t,r){return this._stream.symlink(e,t,r)},o.prototype.realpath=function(e,t){return this._stream.realpath(e,t)},o.prototype.ext_openssh_rename=function(e,t,r){return this._stream.ext_openssh_rename(e,t,r)},o.prototype.ext_openssh_statvfs=function(e,t){return this._stream.ext_openssh_statvfs(e,t)},o.prototype.ext_openssh_fstatvfs=function(e,t){return this._stream.ext_openssh_fstatvfs(e,t)},o.prototype.ext_openssh_hardlink=function(e,t,r){return this._stream.ext_openssh_hardlink(e,t,r)},o.prototype.ext_openssh_fsync=function(e,t){return this._stream.ext_openssh_fsync(e,t)},e.exports=o},,,,function(e,t,r){var i=r(12),n=r(10).Socket,o=r(13).lookup,s=r(9).EventEmitter,a=r(7).inherits,f=i.getHashes(),h=r(24),c=h.SSH2Stream,u=h.SFTPStream,l=h.constants,p=l.BUGS,d=l.ALGORITHMS,g=h.utils.parseKey,E=r(31),v=r(47),m=r(32),y=r(23).readUInt32BE,_=Math.pow(2,32)-1,w=/^OpenSSH_(?:(?![0-4])\d)|(?:\d{2,})/,b=function(e){};function S(){if(!(this instanceof S))return new S;s.call(this),this.config={host:void 0,port:void 0,localAddress:void 0,localPort:void 0,forceIPv4:void 0,forceIPv6:void 0,keepaliveCountMax:void 0,keepaliveInterval:void 0,readyTimeout:void 0,username:void 0,password:void 0,privateKey:void 0,tryKeyboard:void 0,agent:void 0,allowAgentFwd:void 0,authHandler:void 0,hostHashAlgo:void 0,hostHashCb:void 0,strictVendor:void 0,debug:void 0},this._readyTimeout=void 0,this._channels=void 0,this._callbacks=void 0,this._forwarding=void 0,this._forwardingUnix=void 0,this._acceptX11=void 0,this._agentFwdEnabled=void 0,this._curChan=void 0,this._remoteVer=void 0,this._sshstream=void 0,this._sock=void 0,this._resetKA=void 0}function A(e,t,r,i){var n=T(e),o=E.MAX_WINDOW,s=E.PACKET_SIZE,a=!0;if(!1===n)return i(new Error("No free channels available"));"function"==typeof r&&(i=r,r={}),e._channels[n]=i;var f=e._sshstream;return f.once("CHANNEL_OPEN_CONFIRMATION:"+n,h).once("CHANNEL_OPEN_FAILURE:"+n,c).once("CHANNEL_CLOSE:"+n,c),"session"===t?a=f.session(n,o,s):"direct-tcpip"===t?a=f.directTcpip(n,o,s,r):"direct-streamlocal@openssh.com"===t&&(a=f.openssh_directStreamLocal(n,o,s,r)),a;function h(r){f.removeListener("CHANNEL_OPEN_FAILURE:"+n,c),f.removeListener("CHANNEL_CLOSE:"+n,c);var a={type:t,incoming:{id:n,window:o,packetSize:s,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};i(void 0,new E(a,e))}function c(t){var r;f.removeListener("CHANNEL_OPEN_CONFIRMATION:"+n,h),f.removeListener("CHANNEL_OPEN_FAILURE:"+n,c),f.removeListener("CHANNEL_CLOSE:"+n,c),delete e._channels[n],t instanceof Error?r=t:"object"==typeof t&&null!==t?((r=new Error("(SSH) Channel open failure: "+t.description)).reason=t.reason,r.lang=t.lang):(r=new Error("(SSH) Channel open failure: server closed channel unexpectedly")).reason=r.lang="",i(r)}}function T(e){if(e._curChan<_)return++e._curChan;for(var t=0,r=e._channels;t<_;++t)if(!r[t])return t;return!1}function U(e,t,r){var i={single:!1,protocol:"MIT-MAGIC-COOKIE-1",cookie:void 0,screen:0};"function"==typeof t?r=t:"object"==typeof t&&null!==t&&("boolean"==typeof t.single&&(i.single=t.single),"number"==typeof t.screen&&(i.screen=t.screen),"string"==typeof t.protocol&&(i.protocol=t.protocol),"string"==typeof t.cookie?i.cookie=t.cookie:Buffer.isBuffer(t.cookie)&&(i.cookie=t.cookie.toString("hex"))),void 0===i.cookie&&(i.cookie=O());var n="function"==typeof r;return"open"!==e.outgoing.state?(n&&r(new Error("Channel is not open")),!0):(n&&e._callbacks.push(function(t){if(t)return r(!0!==t?t:new Error("Unable to request X11"));e._hasX11=!0,++e._client._acceptX11,e.once("close",function(){e._client._acceptX11&&--e._client._acceptX11}),r()}),e._client._sshstream.x11Forward(e.outgoing.id,i,n))}function B(e,t,r){var i=24,n=80,o=640,s=480,a="vt100";"function"==typeof t?r=t:"object"==typeof t&&null!==t&&("number"==typeof t.rows&&(i=t.rows),"number"==typeof t.cols&&(n=t.cols),"number"==typeof t.width&&(o=t.width),"number"==typeof t.height&&(s=t.height),"string"==typeof t.term&&(a=t.term));var f="function"==typeof r;return"open"!==e.outgoing.state?(f&&r(new Error("Channel is not open")),!0):(f&&e._callbacks.push(function(e){if(e)return r(!0!==e?e:new Error("Unable to request a pseudo-terminal"));r()}),e._client._sshstream.pty(e.outgoing.id,i,n,s,o,a,null,f))}function k(e,t){var r="function"==typeof t;return"open"!==e.outgoing.state?(r&&t(new Error("Channel is not open")),!0):e._client._agentFwdEnabled?(r&&t(!1),!0):(e._client._agentFwdEnabled=!0,e._callbacks.push(function(i){if(i)return e._client._agentFwdEnabled=!1,void(r&&t(!0!==i?i:new Error("Unable to request agent forwarding")));r&&t()}),e._client._sshstream.openssh_agentForward(e.outgoing.id,!0))}function N(e,t){if("open"!==e.outgoing.state)return!0;for(var r,i,n=!0,o=Object.keys(t||{}),s=0,a=o.length;s<a;++s)i=t[r=o[s]],n=e._client._sshstream.env(e.outgoing.id,r,i,!1);return n}function R(e,t,r){return"open"!==e.outgoing.state?(r(new Error("Channel is not open")),!0):(e._callbacks.push(function(i){if(i)return r(!0!==i?i:new Error("Unable to start subsystem: "+t));e.subtype="subsystem",r(void 0,e)}),e._client._sshstream.subsystem(e.outgoing.id,t,!0))}a(S,s),S.prototype.connect=function(e){var t=this;if(this._sock&&this._sock.writable)return this.once("close",function(){t.connect(e)}),void this.end();this.config.host=e.hostname||e.host||"localhost",this.config.port=e.port||22,this.config.localAddress="string"==typeof e.localAddress?e.localAddress:void 0,this.config.localPort="string"==typeof e.localPort||"number"==typeof e.localPort?e.localPort:void 0,this.config.forceIPv4=e.forceIPv4||!1,this.config.forceIPv6=e.forceIPv6||!1,this.config.keepaliveCountMax="number"==typeof e.keepaliveCountMax&&e.keepaliveCountMax>=0?e.keepaliveCountMax:3,this.config.keepaliveInterval="number"==typeof e.keepaliveInterval&&e.keepaliveInterval>0?e.keepaliveInterval:0,this.config.readyTimeout="number"==typeof e.readyTimeout&&e.readyTimeout>=0?e.readyTimeout:2e4;var r,s={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var a,h;if(h=e.algorithms.kex,Array.isArray(h)&&h.length>0){for(a=d.SUPPORTED_KEX,r=0;r<h.length;++r)if(-1===a.indexOf(h[r]))throw new Error("Unsupported key exchange algorithm: "+h[r]);s.kex=h}if(h=e.algorithms.cipher,Array.isArray(h)&&h.length>0){for(a=d.SUPPORTED_CIPHER,r=0;r<h.length;++r)if(-1===a.indexOf(h[r]))throw new Error("Unsupported cipher algorithm: "+h[r]);s.cipher=h}if(h=e.algorithms.serverHostKey,Array.isArray(h)&&h.length>0){for(a=d.SUPPORTED_SERVER_HOST_KEY,r=0;r<h.length;++r)if(-1===a.indexOf(h[r]))throw new Error("Unsupported server host key algorithm: "+h[r]);s.serverHostKey=h}if(h=e.algorithms.hmac,Array.isArray(h)&&h.length>0){for(a=d.SUPPORTED_HMAC,r=0;r<h.length;++r)if(-1===a.indexOf(h[r]))throw new Error("Unsupported HMAC algorithm: "+h[r]);s.hmac=h}if(h=e.algorithms.compress,Array.isArray(h)&&h.length>0){for(a=d.SUPPORTED_COMPRESS,r=0;r<h.length;++r)if(-1===a.indexOf(h[r]))throw new Error("Unsupported compression algorithm: "+h[r]);s.compress=h}}if(void 0===s.compress&&(e.compress?(s.compress=["zlib@openssh.com","zlib"],"force"!==e.compress&&s.compress.push("none")):!1===e.compress&&(s.compress=["none"])),"string"==typeof e.username)this.config.username=e.username;else{if("string"!=typeof e.user)throw new Error("Invalid username");this.config.username=e.user}this.config.password="string"==typeof e.password?e.password:void 0,this.config.privateKey="string"==typeof e.privateKey||Buffer.isBuffer(e.privateKey)?e.privateKey:void 0,this.config.localHostname="string"==typeof e.localHostname&&e.localHostname.length?e.localHostname:void 0,this.config.localUsername="string"==typeof e.localUsername&&e.localUsername.length?e.localUsername:void 0,this.config.tryKeyboard=!0===e.tryKeyboard,this.config.agent="string"==typeof e.agent&&e.agent.length?e.agent:void 0,this.config.allowAgentFwd=!0===e.agentForward&&void 0!==this.config.agent;var u=this.config.authHandler="function"==typeof e.authHandler?e.authHandler:void 0;this.config.strictVendor="boolean"!=typeof e.strictVendor||e.strictVendor;var p=this.config.debug="function"==typeof e.debug?e.debug:b;if(!0===e.agentForward&&!this.config.allowAgentFwd)throw new Error("You must set a valid agent path to allow agent forwarding");var m,_=this._callbacks=[];if(this._channels={},this._forwarding={},this._forwardingUnix={},this._acceptX11=0,this._agentFwdEnabled=!1,this._curChan=-1,this._remoteVer=void 0,this.config.privateKey){if((m=g(this.config.privateKey,e.passphrase))instanceof Error)throw new Error("Cannot parse privateKey: "+m.message);if(Array.isArray(m)&&(m=m[0]),null===m.getPrivatePEM())throw new Error("privateKey value does not contain a (valid) private key")}var w=this._sshstream=new c({algorithms:s,debug:p===b?void 0:p}),S=this._sock=e.sock||new n;this._sock.stderr&&this._sock.stderr.resume();var A,U,B=this.config.keepaliveInterval,k=this.config.keepaliveCountMax,N=0;function R(){if(++N>k){if(clearInterval(A),S.readable){var e=new Error("Keepalive timeout");e.level="client-timeout",t.emit("error",e),S.destroy()}}else S.writable?(_.push(O),w.ping()):clearInterval(A)}function O(){B>0&&(N=0,clearInterval(A),S.writable&&(A=setInterval(R,B)))}if(this._resetKA=O,w.on("USERAUTH_BANNER",function(e){t.emit("banner",e)}),S.on("connect",function(){p("DEBUG: Client: Connected"),t.emit("connect"),e.sock||w.pipe(S).pipe(w)}).on("timeout",function(){t.emit("timeout")}).on("error",function(e){clearTimeout(t._readyTimeout),e.level="client-socket",t.emit("error",e)}).on("end",function(){w.unpipe(S),clearTimeout(t._readyTimeout),clearInterval(A),t.emit("end")}).on("close",function(){w.unpipe(S),clearTimeout(t._readyTimeout),clearInterval(A),t.emit("close");var e=_,i=new Error("No response from server");for(_=t._callbacks=[],r=0;r<e.length;++r)e[r](i);var n=t._channels,o=Object.keys(n);for(t._channels={},r=0;r<o.length;++r){var s,a=w.emit("CHANNEL_OPEN_FAILURE:"+o[r],i),f=w.emit("CHANNEL_CLOSE:"+o[r]);a||f||!(s=n[o[r]])||"function"!=typeof s||s(i)}}),w.on("drain",function(){t.emit("drain")}).once("header",function(e){t._remoteVer=e.versions.software,e.greeting&&t.emit("greeting",e.greeting)}).on("continue",function(){t.emit("continue")}).on("error",function(e){void 0===e.level?e.level="protocol":"handshake"===e.level&&clearTimeout(t._readyTimeout),t.emit("error",e)}).on("end",function(){S.resume()}),"function"==typeof e.hostVerifier){if(-1===f.indexOf(e.hostHash))throw new Error("Invalid host hash algorithm: "+e.hostHash);var D=e.hostVerifier,C=i.createHash(e.hostHash);w.once("fingerprint",function(e,t){C.update(e);var r=D(C.digest("hex"),t);void 0!==r&&t(r)})}var L,I=null,P=null,H=0,x=["none"];if(void 0!==this.config.password&&x.push("password"),void 0!==m&&x.push("publickey"),void 0!==this.config.agent&&x.push("agent"),this.config.tryKeyboard&&x.push("keyboard-interactive"),void 0!==m&&void 0!==this.config.localHostname&&void 0!==this.config.localUsername&&x.push("hostbased"),void 0===u){var M=0;u=function(e,t,r){return M!==x.length&&x[M++]}}var G=!1;function K(e){if(G=!0,!1===e){w.removeListener("USERAUTH_FAILURE",V),w.removeListener("USERAUTH_PK_OK",X);var r=new Error("All configured authentication methods failed");return r.level="client-authentication",t.emit("error",r),void(w.writable&&t.end())}if(-1===x.indexOf(e))throw new Error("Authentication method not allowed: "+e);switch(U=e){case"password":w.authPassword(t.config.username,t.config.password);break;case"publickey":w.authPK(t.config.username,m),w.once("USERAUTH_PK_OK",X);break;case"hostbased":;w.authHostbased(t.config.username,m,t.config.localHostname,t.config.localUsername,function(e,r){var i=m.sign(e);if(i instanceof Error)return i.message="Error while signing data with privateKey: "+i.message,i.level="client-authentication",t.emit("error",i),F();r(i)});break;case"agent":v(t.config.agent,function(e,r){return e?(e.level="agent",t.emit("error",e),L=void 0,F()):0===r.length?(p("DEBUG: Agent: No keys stored in agent"),L=void 0,F()):(L=r,H=0,w.authPK(t.config.username,r[0]),void w.once("USERAUTH_PK_OK",X))});break;case"keyboard-interactive":w.authKeyboard(t.config.username),w.on("USERAUTH_INFO_REQUEST",W);break;case"none":w.authNone(t.config.username)}}function F(){G=!1;var e=u(P,I,K);G||void 0===e||K(e)}function q(){if("agent"===U){if(H>=L.length)return;++H>=L.length?(p("DEBUG: Agent: No more keys left to try"),p("DEBUG: Client: agent auth failed"),L=void 0,F()):(p("DEBUG: Agent: Trying key #"+(H+1)),w.authPK(t.config.username,L[H]),w.once("USERAUTH_PK_OK",X))}}function W(e,r,i,n){if(0===(Array.isArray(n)?n.length:0))return p("DEBUG: Client: Sending automatic USERAUTH_INFO_RESPONSE"),w.authInfoRes();t.emit("keyboard-interactive",e,r,i,n,function(e){w.authInfoRes(e)})}function X(){if("agent"===U){var e=L[H],r=y(e,0),i=e.toString("ascii",4,4+r),n=i.slice(4);switch(i){case"ssh-rsa":case"ssh-dss":case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":break;default:return p("DEBUG: Agent: Skipping unsupported key type: "+i),q()}w.authPK(t.config.username,e,function(r,o){v(t.config.agent,e,n,r,function(e,r){if(e)e.level="agent",t.emit("error",e);else{var n=y(r,0);if(4+n+4<r.length){if(r.toString("ascii",4,4+n)===i)return o(r.slice(4+n+4));(e=new Error("Agent key/signature type mismatch")).level="agent",t.emit("error",e)}}q()})})}else"publickey"===U&&w.authPK(t.config.username,m,function(e,r){var i=m.sign(e);if(i instanceof Error)return i.message="Error while signing data with privateKey: "+i.message,i.level="client-authentication",t.emit("error",i),F();r(i)})}function V(e,t){if(w.removeListener("USERAUTH_PK_OK",X),w.removeListener("USERAUTH_INFO_REQUEST",W),"agent"===U)return p("DEBUG: Client: Agent key #"+(H+1)+" failed"),q();p("DEBUG: Client: "+U+" auth failed"),I=t,P=e,F()}if(w.once("USERAUTH_SUCCESS",function(){w.removeListener("USERAUTH_FAILURE",V),w.removeListener("USERAUTH_INFO_REQUEST",W),O(),clearTimeout(t._readyTimeout),t.emit("ready")}).on("USERAUTH_FAILURE",V),w.once("ready",function(){w.service("ssh-userauth"),w.once("SERVICE_ACCEPT",function(e){"ssh-userauth"===e&&F()})}),w.on("CHANNEL_OPEN",function(e){!function(e,t){var r,i=!1;function n(){var r={type:t.type,incoming:{id:i,window:E.MAX_WINDOW,packetSize:E.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}},n=new E(r,e);return e._sshstream.channelOpenConfirm(t.sender,i,E.MAX_WINDOW,E.PACKET_SIZE),n}function o(){void 0===r&&(r=!1===i?l.CHANNEL_OPEN_FAILURE.RESOURCE_SHORTAGE:l.CHANNEL_OPEN_FAILURE.CONNECT_FAILED),e._sshstream.channelOpenFail(t.sender,r,"","")}if("forwarded-tcpip"===t.type||"x11"===t.type||"auth-agent@openssh.com"===t.type||"forwarded-streamlocal@openssh.com"===t.type){var s="forwarded-tcpip"===t.type&&void 0===e._forwarding[t.data.destIP+":"+t.data.destPort]||"forwarded-streamlocal@openssh.com"===t.type&&void 0===e._forwardingUnix[t.data.socketPath]||"x11"===t.type&&0===e._acceptX11||"auth-agent@openssh.com"===t.type&&!e._agentFwdEnabled;s?(r=l.CHANNEL_OPEN_FAILURE.ADMINISTRATIVELY_PROHIBITED,e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unexpected channel open for: "+t.type)):!1===(i=T(e))?(e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: no channels available"),s=!0):e._channels[i]=!0,s&&o(),!1!==i&&("forwarded-tcpip"===t.type?(0===t.data.destPort&&(t.data.destPort=e._forwarding[t.data.destIP+":"+t.data.destPort]),e.emit("tcp connection",t.data,n,o)):"x11"===t.type?e.emit("x11",t.data,n,o):"forwarded-streamlocal@openssh.com"===t.type?e.emit("unix connection",t.data,n,o):v(e.config.agent,n,o))}else e.config.debug("DEBUG: Client: Automatic rejection of incoming channel open: unsupported type: "+t.type),r=l.CHANNEL_OPEN_FAILURE.UNKNOWN_CHANNEL_TYPE,o()}(t,e)}),w.on("REQUEST_SUCCESS",function(e){_.length&&_.shift()(!1,e)}).on("REQUEST_FAILURE",function(){_.length&&_.shift()(!0)}),w.on("GLOBAL_REQUEST",function(e,t,r){t&&w.requestFailure()}),e.sock)Z(),w.pipe(S).pipe(w);else{var Q=this.config.host,Y=this.config.forceIPv4,z=this.config.forceIPv6;function j(){Z(),t._sock.connect({host:Q,port:t.config.port,localAddress:t.config.localAddress,localPort:t.config.localPort}),t._sock.setNoDelay(!0),t._sock.setMaxListeners(0),t._sock.setTimeout("number"==typeof e.timeout?e.timeout:0)}p("DEBUG: Client: Trying "+Q+" on port "+this.config.port+" ..."),!Y&&!z||Y&&z?j():o(Q,Y?4:6,function(e,r,i){if(e){var n=new Error("Error while looking up "+(Y?"IPv4":"IPv6")+" address for host "+Q+": "+e);return clearTimeout(t._readyTimeout),n.level="client-dns",t.emit("error",n),void t.emit("close")}Q=r,j()})}function Z(){t.config.readyTimeout>0&&(t._readyTimeout=setTimeout(function(){var e=new Error("Timed out while waiting for handshake");e.level="client-timeout",t.emit("error",e),S.destroy()},t.config.readyTimeout))}},S.prototype.end=function(){return!!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable)&&this._sshstream.disconnect()},S.prototype.destroy=function(){this._sock&&this._sock.destroy()},S.prototype.exec=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");"function"==typeof t&&(r=t,t={});var i=this;return A(this,"session",{allowHalfOpen:!1!==t.allowHalfOpen},function(n,o){if(n)return r(n);var s=[];function a(e){if(e)return o.close(),r(e);s.length&&s.shift()()}(!0===i.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==i.config.agent)&&s.push(function(){k(o,a)}),"object"==typeof t&&null!==t&&("object"==typeof t.env&&null!==t.env&&N(o,t.env),("object"==typeof t.pty&&null!==t.pty||!0===t.pty)&&s.push(function(){B(o,t.pty,a)}),("object"==typeof t.x11&&null!==t.x11||"number"===t.x11||!0===t.x11)&&s.push(function(){U(o,t.x11,a)})),s.push(function(){!function(e,t,r,i){if("open"!==e.outgoing.state)return i(new Error("Channel is not open")),!0;e._callbacks.push(function(t){if(t)return i(!0!==t?t:new Error("Unable to exec"));e.subtype="exec",e.allowHalfOpen=!1!==r.allowHalfOpen,i(void 0,e)}),e._client._sshstream.exec(e.outgoing.id,t,!0)}(o,e,t,r)}),s.shift()()})},S.prototype.shell=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this;return"function"==typeof e?(r=e,e=t=void 0):"function"==typeof t&&(r=t,t=void 0),!e||void 0===e.x11&&void 0===e.env||(t=e,e=void 0),A(this,"session",function(n,o){if(n)return r(n);var s=[];function a(e){if(e)return o.close(),r(e);s.length&&s.shift()()}(!0===i.config.allowAgentFwd||t&&!0===t.agentForward&&void 0!==i.config.agent)&&s.push(function(){k(o,a)}),!1!==e&&s.push(function(){B(o,e,a)}),"object"==typeof t&&null!==t&&("object"==typeof t.env&&null!==t.env&&N(o,t.env),("object"==typeof t.x11&&null!==t.x11||"number"===t.x11||!0===t.x11)&&s.push(function(){U(o,t.x11,a)})),s.push(function(){!function(e,t){if("open"!==e.outgoing.state)return t(new Error("Channel is not open")),!0;e._callbacks.push(function(r){if(r)return t(!0!==r?r:new Error("Unable to open shell"));e.subtype="shell",t(void 0,e)}),e._client._sshstream.shell(e.outgoing.id,!0)}(o,r)}),s.shift()()})},S.prototype.subsys=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return A(this,"session",function(r,i){if(r)return t(r);R(i,e,function(e,r){if(e)return t(e);t(void 0,r)})})},S.prototype.sftp=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t=this;return A(this,"session",function(r,i){if(r)return e(r);R(i,"sftp",function(r,i){if(r)return e(r);var n=t._sshstream._state.incoming.identRaw,o={debug:t.config.debug},s=new u(o,n);function a(t){s.removeListener("ready",f),i.removeListener("exit",h),e(t)}function f(){s.removeListener("error",a),i.removeListener("exit",h),e(void 0,new m(s))}function h(t,r){var i;s.removeListener("ready",f),s.removeListener("error",a),i="number"==typeof t?"Received exit code "+t+" while establishing SFTP session":"Received signal "+r+" while establishing SFTP session";var n=new Error(i);n.code=t,n.signal=r,e(n)}s.once("error",a).once("ready",f).once("close",function(){i.end()}),i.once("exit",h),s.pipe(i).pipe(s)})})},S.prototype.forwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this,n="function"==typeof r;return n&&this._callbacks.push(function(n,o){if(n)return r(!0!==n?n:new Error("Unable to bind to "+e+":"+t));var s=t;0===t&&o&&o.length>=4&&(s=y(o,0),i._sshstream.remoteBugs&p.DYN_RPORT_BUG||(t=s)),i._forwarding[e+":"+t]=s,r(void 0,s)}),this._sshstream.tcpipForward(e,t,n)},S.prototype.unforwardIn=function(e,t,r){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var i=this,n="function"==typeof r;return n&&this._callbacks.push(function(n){if(n)return r(!0!==n?n:new Error("Unable to unbind from "+e+":"+t));delete i._forwarding[e+":"+t],r()}),this._sshstream.cancelTcpipForward(e,t,n)},S.prototype.forwardOut=function(e,t,r,i,n){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return A(this,"direct-tcpip",{srcIP:e,srcPort:t,dstIP:r,dstPort:i},n)},S.prototype.openssh_noMoreSessions=function(e){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var t="function"==typeof e;return!this.config.strictVendor||this.config.strictVendor&&w.test(this._remoteVer)?(t&&this._callbacks.push(function(t){if(t)return e(!0!==t?t:new Error("Unable to disable future sessions"));e()}),this._sshstream.openssh_noMoreSessions(t)):(t&&process.nextTick(function(){e(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}),!0)},S.prototype.openssh_forwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t,i=this;return!this.config.strictVendor||this.config.strictVendor&&w.test(this._remoteVer)?(r&&this._callbacks.push(function(r){if(r)return t(!0!==r?r:new Error("Unable to bind to "+e));i._forwardingUnix[e]=!0,t()}),this._sshstream.openssh_streamLocalForward(e,r)):(r&&process.nextTick(function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}),!0)},S.prototype.openssh_unforwardInStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");var r="function"==typeof t,i=this;return!this.config.strictVendor||this.config.strictVendor&&w.test(this._remoteVer)?(r&&this._callbacks.push(function(r){if(r)return t(!0!==r?r:new Error("Unable to unbind on "+e));delete i._forwardingUnix[e],t()}),this._sshstream.openssh_cancelStreamLocalForward(e,r)):(r&&process.nextTick(function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}),!0)},S.prototype.openssh_forwardOutStreamLocal=function(e,t){if(!(this._sock&&this._sock.writable&&this._sshstream&&this._sshstream.writable))throw new Error("Not connected");return!this.config.strictVendor||this.config.strictVendor&&w.test(this._remoteVer)?A(this,"direct-streamlocal@openssh.com",{socketPath:e},t):(process.nextTick(function(){t(new Error("strictVendor enabled and server is not OpenSSH or compatible version"))}),!0)};var O=function(){if("function"==typeof i.randomFillSync){var e=Buffer.alloc(16);return function(){return i.randomFillSync(e,0,16),e.toString("hex")}}return function(){return i.randomBytes(16).toString("hex")}}();S.Client=S,S.Server=r(48),S.utils=h.utils,S.SFTP_STATUS_CODE=u.STATUS_CODE,S.SFTP_OPEN_MODE=u.OPEN_MODE,e.exports=S},function(e,t,r){var i=r(8).Transform,n=r(8).Readable,o=r(8).Writable,s=r(5).constants||process.binding("constants"),a=r(7),f=a.inherits,h=a.isDate,c=r(9).EventEmitter.listenerCount,u=r(5),l=r(21).readString,p=r(21).readInt,d=r(22).readUInt32BE,g=r(22).writeUInt32BE,E={SIZE:1,UIDGID:2,PERMISSIONS:4,ACMODTIME:8,EXTENDED:2147483648},v={OK:0,EOF:1,NO_SUCH_FILE:2,PERMISSION_DENIED:3,FAILURE:4,BAD_MESSAGE:5,NO_CONNECTION:6,CONNECTION_LOST:7,OP_UNSUPPORTED:8};Object.keys(v).forEach(function(e){v[v[e]]=e});var m={0:"No error",1:"End of file",2:"No such file or directory",3:"Permission denied",4:"Failure",5:"Bad message",6:"No connection",7:"Connection lost",8:"Operation unsupported"};k.STATUS_CODE=v;var y={INIT:1,OPEN:3,CLOSE:4,READ:5,WRITE:6,LSTAT:7,FSTAT:8,SETSTAT:9,FSETSTAT:10,OPENDIR:11,READDIR:12,REMOVE:13,MKDIR:14,RMDIR:15,REALPATH:16,STAT:17,RENAME:18,READLINK:19,SYMLINK:20,EXTENDED:200};Object.keys(y).forEach(function(e){y[y[e]]=e});var _={VERSION:2,STATUS:101,HANDLE:102,DATA:103,NAME:104,ATTRS:105,EXTENDED:201};Object.keys(_).forEach(function(e){_[_[e]]=e});var w={READ:1,WRITE:2,APPEND:4,CREAT:8,TRUNC:16,EXCL:32};k.OPEN_MODE=w;var b=Math.pow(2,32)-1,S=Buffer.from([0,0,0,5,y.INIT,0,0,0,3]),A=Buffer.from([0,0,0,5,_.VERSION,0,0,0,3]),T=/^SSH-2.0-(?:OpenSSH|dropbear)/,U=260096;function B(e){}function k(e,t){"string"!=typeof e||t||(t=e,e=void 0),"object"==typeof e&&e||(e={}),i.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this.debug="function"==typeof e.debug?e.debug:B,this.server=!!e.server,this._isOpenSSH=t&&T.test(t),this._needContinue=!1,this._state={status:"packet_header",writeReqid:-1,pktLeft:void 0,pktHdrBuf:Buffer.allocUnsafe(9),pktBuf:void 0,pktType:void 0,version:void 0,extensions:{},maxDataLen:this._isOpenSSH?U:32768,requests:{}};var r=this;function n(){r.writable=!1,r._cleanup(!1)}this.on("end",function(){r.readable=!1}).on("finish",n).on("prefinish",n),this.server||this.push(S)}function N(e,t,r,i,n,o){var s,a,f,h,c=64,l=32768;"function"==typeof n?o=n:"object"==typeof n&&("number"==typeof n.concurrency&&n.concurrency>0&&!isNaN(n.concurrency)&&(c=n.concurrency),"number"==typeof n.chunkSize&&n.chunkSize>0&&!isNaN(n.chunkSize)&&(l=n.chunkSize),"function"==typeof n.step&&(s=n.step),"string"!=typeof n.mode&&"number"!=typeof n.mode||(a=I(n.mode)));var p,d,g,E=0,v=0,m=0,y=0,_=!1,w=l*c;function b(r){if(!_){_=!0;var i,n=0;p||d?(i=function(){0==--n&&o(r)},p&&(e===u||e.writable)&&++n,d&&(t===u||t.writable)&&++n,p&&(e===u||e.writable)&&e.close(p,i),d&&(t===u||t.writable)&&t.close(d,i)):o(r)}}e.open(r,"r",function(n,_){if(n)return b(n);p=_,e.fstat(p,function n(_,S){if(_)return e!==u?void e.stat(r,function(e,t){if(e)return b(_);n(null,t)}):b(_);f=S.size,t.open(i,"w",function(r,n){if(r)return b(r);if(d=n,f<=0)return b();for(;w>f;){if(1===c){w=f;break}w-=l,--c}if((g=function(e){try{return Buffer.allocUnsafe(e)}catch(e){return e}}(w))instanceof Error)return b(g);function _(r,i,n,a,h){if(r)return b(r);function c(r){if(r)return b(r);y+=i,s&&s(y,i,f),0==--m&&(y===f?t.close(d,function(t){if(d=void 0,t)return b(t);e.close(p,function(e){if(p=void 0,e)return b(e);o()})}):A())}e===u?t.writeData(d,n,h||0,i,a,c):t.write(d,n,h||0,i,a,c)}function S(e,t){return function(r,i,n){_(r,i,n,t,e)}}function A(){for(;v<f&&m<c;)h=v+l>f?f-v:l,e===u?e.read(p,g,E,h,v,S(E,v)):e.readData(p,g,E,h,v,_),E+=h,v+=h,++m;E=0}void 0!==a?t.fchmod(d,a,function e(r){r?t.chmod(i,a,function(t){e()}):A()}):A()})})})}function R(e,t,r,i,n,o,s){var a="function"==typeof s?s:void 0;e.writeData(t,r,i,n,o,function(s,f){if(s)return e.close(t,function(){a&&a(s)});f===n?e.close(t,a):R(e,t,r,i+=f,n-=f,o+=f,a)})}function O(e,t,r,i){var n=d(e,t),o=new M;if(t+=4,n&E.SIZE){var s=D(e,t,r,i);if(!1===s)return!1;o.size=s,t+=8}if(n&E.UIDGID){var a,f;if(!1===(a=p(e,t,this,i)))return!1;if(o.uid=a,!1===(f=p(e,t+=4,this,i)))return!1;o.gid=f,t+=4}if(n&E.PERMISSIONS){var h=p(e,t,this,i);if(!1===h)return!1;o.mode=h,o.permissions=h,t+=4}if(n&E.ACMODTIME){var c,u;if(!1===(c=p(e,t,this,i)))return!1;if(o.atime=c,!1===(u=p(e,t+=4,this,i)))return!1;o.mtime=u,t+=4}if(n&E.EXTENDED){var l=p(e,t,this,i);if(!1===l)return!1;t+=4;for(var g,v=0;v<l;++v){if(!1===(g=p(e,t,this,i)))return!1;t+=4+g}}return e._pos=t,o}function D(e,t,r,i){if(e.length-t<8)return r&&r._cleanup(i),!1;for(var n=0,o=t+8;t<o;++t)n*=256,n+=e[t];return e._pos=t,n}function C(e){var t=0,r=0,i=[],n=0;if("number"==typeof e.size){t|=E.SIZE,r+=8;var o=new Array(8),s=e.size;for(n=7;n>=0;--n)o[n]=255&s,s/=256;i.push(o)}if("number"==typeof e.uid&&"number"==typeof e.gid&&(t|=E.UIDGID,r+=8,i.push([e.uid>>24&255,e.uid>>16&255,e.uid>>8&255,255&e.uid]),i.push([e.gid>>24&255,e.gid>>16&255,e.gid>>8&255,255&e.gid])),"number"==typeof e.permissions||"string"==typeof e.permissions||"number"==typeof e.mode||"string"==typeof e.mode){var a=I(e.mode||e.permissions);t|=E.PERMISSIONS,r+=4,i.push([a>>24&255,a>>16&255,a>>8&255,255&a])}if(("number"==typeof e.atime||h(e.atime))&&("number"==typeof e.mtime||h(e.mtime))){var f=L(e.atime),c=L(e.mtime);t|=E.ACMODTIME,r+=8,i.push([f>>24&255,f>>16&255,f>>8&255,255&f]),i.push([c>>24&255,c>>16&255,c>>8&255,255&c])}return{flags:t,nbytes:r,bytes:i}}function L(e){if("number"==typeof e&&!isNaN(e))return e;if(h(e))return parseInt(e.getTime()/1e3,10);throw new Error("Cannot parse time: "+e)}function I(e){if("number"==typeof e&&!isNaN(e))return e;if("string"==typeof e)return I(parseInt(e,8));throw new Error("Cannot parse mode: "+e)}f(k,i),k.prototype.__read=i.prototype._read,k.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},k.prototype.__push=i.prototype.push,k.prototype.push=function(e,t){if(!this.readable)return!1;null===e&&(this.readable=!1);var r=this.__push(e,t);return this._needContinue=!1===r,r},k.prototype._cleanup=function(e){var t=this._state;t.pktBuf=void 0;var r=t.requests,i=Object.keys(r),n=i.length;if(n){if(this.readable)for(var o,s=new Error("SFTP session ended early"),a=0;a<n;++a)(o=r[i[a]].cb)&&o(s);t.requests={}}this.readable&&this.push(null),this._readableState.endEmitted||this._readableState.flowing||this.resume(),!1!==e&&(this.debug("DEBUG[SFTP]: Parser: Malformed packet"),e&&e(new Error("Malformed packet")))},k.prototype._transform=function(e,t,r){for(var i,n,o,s=this._state,a=this.server,f=s.status,h=s.pktType,u=s.pktBuf,E=s.pktLeft,w=s.version,b=s.pktHdrBuf,S=s.requests,T=this.debug,U=e.length,B=0;;){if("discard"===f){if(!(E<=(n=U-B))){E-=n;break}B+=E,E=0,f="packet_header",i=u=void 0}else{if(void 0!==u){if(E<=(n=U-B)){e.copy(u,u.length-E,B,B+E),B+=E,E=0,i=u,u=void 0;continue}e.copy(u,u.length-E,B),E-=n;break}if("packet_header"===f)if(i){if(E=d(i,4)-1,h=i[8],a){if(void 0===w&&h!==y.INIT)return T("DEBUG[SFTP]: Parser: Unexpected packet before init"),this._cleanup(!1),r(new Error("Unexpected packet before init"));if(void 0!==w&&h===y.INIT)T("DEBUG[SFTP]: Parser: Unexpected duplicate init"),f="bad_pkt";else{if(E>34e3)return T("DEBUG[SFTP]: Parser: "+(Q="Packet length ("+E+") exceeds max length (34000)")),this._cleanup(!1),r(new Error(Q));h===y.EXTENDED?f="bad_pkt":void 0===y[h]&&(T("DEBUG[SFTP]: Parser: Unsupported packet type: "+h),f="discard")}}else{if(void 0===w&&h!==_.VERSION)return T("DEBUG[SFTP]: Parser: Unexpected packet before version"),this._cleanup(!1),r(new Error("Unexpected packet before version"));void 0!==w&&h===_.VERSION?(T("DEBUG[SFTP]: Parser: Unexpected duplicate version"),f="bad_pkt"):void 0===_[h]&&(f="discard")}"bad_pkt"===f?(g(b,E,0),b[4]=h,E=4,u=b):(u=Buffer.allocUnsafe(E),f="payload")}else E=5,u=b;else if("payload"===f){if(h===_.VERSION||h===y.INIT){if(!1===(w=s.version=p(i,0,this,r)))return;if(w<3)return this._cleanup(!1),r(new Error("Incompatible SFTP version: "+w));a&&this.push(A);var k,N,R=i.length;for(i._pos=4;i._pos<R;){if(!1===(k=l(i,i._pos,"ascii",this,r)))return;if(!1===(N=l(i,i._pos,"ascii",this,r)))return;s.extensions[k]?s.extensions[k].push(N):s.extensions[k]=[N]}this.emit("ready")}else{if(!1===(o=p(i,0,this,r)))return;var C,L,I,P;if(a){var H,x,M=y[h];if(T("DEBUG[SFTP]: Parser: Request: "+M),c(this,M)){if(h===y.OPEN){if(!1===(C=l(i,4,"utf8",this,r)))return;var G=p(i,i._pos,this,r);if(!1===G)return;if(!1===(L=O(i,i._pos+4,this,r)))return;this.emit(M,o,C,G,L)}else if(h===y.CLOSE||h===y.FSTAT||h===y.READDIR){if(!1===(I=l(i,4,this,r)))return;this.emit(M,o,I)}else if(h===y.READ){if(!1===(I=l(i,4,this,r)))return;if(!1===(H=D(i,i._pos,this,r)))return;var K=p(i,i._pos,this,r);if(!1===K)return;this.emit(M,o,I,H,K)}else if(h===y.WRITE){if(!1===(I=l(i,4,this,r)))return;if(!1===(H=D(i,i._pos,this,r)))return;if(!1===(P=l(i,i._pos,this,r)))return;this.emit(M,o,I,H,P)}else if(h===y.LSTAT||h===y.STAT||h===y.OPENDIR||h===y.REMOVE||h===y.RMDIR||h===y.REALPATH||h===y.READLINK){if(!1===(x=l(i,4,"utf8",this,r)))return;this.emit(M,o,x)}else if(h===y.SETSTAT||h===y.MKDIR){if(!1===(x=l(i,4,"utf8",this,r)))return;if(!1===(L=O(i,i._pos,this,r)))return;this.emit(M,o,x,L)}else if(h===y.FSETSTAT){if(!1===(I=l(i,4,this,r)))return;if(!1===(L=O(i,i._pos,this,r)))return;this.emit(M,o,I,L)}else if(h===y.RENAME||h===y.SYMLINK){var F,q;if(!1===(F=l(i,4,"utf8",this,r)))return;if(!1===(q=l(i,i._pos,"utf8",this,r)))return;h===y.SYMLINK&&this._isOpenSSH?this.emit(M,o,q,F):this.emit(M,o,F,q)}}else this.status(o,v.OP_UNSUPPORTED)}else{var W=S[o],X=W&&W.cb;if(T("DEBUG[SFTP]: Parser: Response: "+_[h]),W&&X)if(h===_.STATUS){var V=p(i,4,this,r);if(!1===V)return;if(V===v.OK)X();else{var Q,Y="";if(i.length>=12){if(!1===(Q=l(i,8,"utf8",this,r)))return;if(i._pos+4<i.length&&!1===(Y=l(i,i._pos,"ascii",this,r)))return}var z=new Error(Q||m[V]||"Unknown status");z.code=V,z.lang=Y,X(z)}}else if(h===_.HANDLE){if(!1===(I=l(i,4,this,r)))return;X(void 0,I)}else if(h===_.DATA)if(W.buffer){var j=p(i,4,this,r);if(!1===j)return;var Z=W.buffer.length;if(j>Z&&g(i,Z,4),!1===(P=l(i,4,W.buffer,this,r)))return;X(void 0,P,j)}else{if(!1===(P=l(i,4,this,r)))return;X(void 0,P)}else if(h===_.NAME){var $=p(i,4,this,r);if(!1===$)return;var J,ee=[];i._pos=8;for(var te=0;te<$;++te){if(!1===(C=l(i,i._pos,"utf8",this,r)))return;if(!1===(J=l(i,i._pos,"utf8",this,r)))return;if(!1===(L=O(i,i._pos,this,r)))return;ee.push({filename:C,longname:J,attrs:L})}X(void 0,ee)}else if(h===_.ATTRS){if(!1===(L=O(i,4,this,r)))return;X(void 0,L)}else if(h===_.EXTENDED){if(W.extended)switch(W.extended){case"statvfs@openssh.com":case"fstatvfs@openssh.com":var re={f_bsize:void 0,f_frsize:void 0,f_blocks:void 0,f_bfree:void 0,f_bavail:void 0,f_files:void 0,f_ffree:void 0,f_favail:void 0,f_sid:void 0,f_flag:void 0,f_namemax:void 0};if(re.f_bsize=D(i,4,this,r),!1===re.f_bsize)return;if(re.f_frsize=D(i,12,this,r),!1===re.f_frsize)return;if(re.f_blocks=D(i,20,this,r),!1===re.f_blocks)return;if(re.f_bfree=D(i,28,this,r),!1===re.f_bfree)return;if(re.f_bavail=D(i,36,this,r),!1===re.f_bavail)return;if(re.f_files=D(i,44,this,r),!1===re.f_files)return;if(re.f_ffree=D(i,52,this,r),!1===re.f_ffree)return;if(re.f_favail=D(i,60,this,r),!1===re.f_favail)return;if(re.f_sid=D(i,68,this,r),!1===re.f_sid)return;if(re.f_flag=D(i,76,this,r),!1===re.f_flag)return;if(re.f_namemax=D(i,84,this,r),!1===re.f_namemax)return;X(void 0,re)}X()}W&&delete S[o]}}f="packet_header",i=u=void 0}else if("bad_pkt"===f){if(a&&i[4]!==y.INIT){var ie=i[4]===y.EXTENDED?v.OP_UNSUPPORTED:v.FAILURE;if(i[4]===y.INIT||i[4]===_.VERSION)return this._cleanup(r);if(!1===(o=p(i,5,this,r)))return;this.status(o,ie)}E=d(i,0)-5,f="discard"}}if(B>=U)break}s.status=f,s.pktType=h,s.pktBuf=u,s.pktLeft=E,s.version=w,r()},k.prototype.createReadStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new K(this,e,t)},k.prototype.createWriteStream=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");return new F(this,e,t)},k.prototype.open=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=this._state;"function"==typeof r&&(i=r,r=void 0);var o=x(t);if(null===o)throw new Error("Unknown flags string: "+t);var s=0,a=0;"string"!=typeof r&&"number"!=typeof r||(r={mode:r}),"object"==typeof r&&(s=(r=C(r)).flags,a=r.nbytes,r=r.bytes);var f=Buffer.byteLength(e),h=9,c=Buffer.allocUnsafe(13+f+4+4+a);g(c,c.length-4,0),c[4]=y.OPEN;var u=n.writeReqid=(n.writeReqid+1)%b;if(g(c,u,5),g(c,f,h),c.write(e,h+=4,f,"utf8"),g(c,o,h+=f),g(c,s,h+=4),r&&s){h+=4;for(var l=0,p=r.length;l<p;++l)for(var d=0,E=r[l].length;d<E;++d)c[h++]=r[l][d]}return n.requests[u]={cb:i},this.debug("DEBUG[SFTP]: Outgoing: Writing OPEN"),this.push(c)},k.prototype.close=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,i=e.length,n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.CLOSE;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),e.copy(o,n+=4),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing CLOSE"),this.push(o)},k.prototype.readData=function(e,t,r,i,n,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>=t.length)throw new Error("offset is out of bounds");if(r+i>t.length)throw new Error("length extends beyond buffer");if(null===n)throw new Error("null position currently unsupported");var s=this._state,a=e.length,f=9,h=n,c=Buffer.allocUnsafe(13+a+8+4);g(c,c.length-4,0),c[4]=y.READ;var u=s.writeReqid=(s.writeReqid+1)%b;g(c,u,5),g(c,a,f),e.copy(c,f+=4),f+=a;for(var l=7;l>=0;--l)c[f+l]=255&h,h/=256;return g(c,i,f+=8),s.requests[u]={cb:function(e,t,r){if(e&&e.code!==v.EOF)return o(e);o(void 0,r||0,t,n)},buffer:t.slice(r,r+i)},this.debug("DEBUG[SFTP]: Outgoing: Writing READ"),this.push(c)},k.prototype.writeData=function(e,t,r,i,n,o){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");if(!Buffer.isBuffer(t))throw new Error("buffer is not a Buffer");if(r>t.length)throw new Error("offset is out of bounds");if(r+i>t.length)throw new Error("length extends beyond buffer");if(null===n)throw new Error("null position currently unsupported");var s=this,a=this._state;if(i){var f=i>a.maxDataLen?i-a.maxDataLen:0,h=n;f&&(i=a.maxDataLen);var c=e.length,u=9,l=Buffer.allocUnsafe(13+c+8+4+i);g(l,l.length-4,0),l[4]=y.WRITE;var p=a.writeReqid=(a.writeReqid+1)%b;g(l,p,5),g(l,c,u),e.copy(l,u+=4),u+=c;for(var d=7;d>=0;--d)l[u+d]=255&n,n/=256;return g(l,i,u+=8),t.copy(l,u+=4,r,r+i),a.requests[p]={cb:function(n){n?o&&o(n):f?s.writeData(e,t,r+i,f,h+i,o):o&&o(void 0,r+i)}},this.debug("DEBUG[SFTP]: Outgoing: Writing WRITE"),this.push(l)}o&&process.nextTick(function(){o(void 0,0)})},k.prototype.fastGet=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");N(this,u,e,t,r,i)},k.prototype.fastPut=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");N(u,this,e,t,r,i)},k.prototype.readFile=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i;"function"==typeof r?i=r:"function"==typeof t&&(i=t,t=void 0);var n=this;if("string"==typeof t)t={encoding:t,flag:"r"};else if(t){if("object"!=typeof t)throw new TypeError("Bad arguments")}else t={encoding:null,flag:"r"};var o,s,a,f=t.encoding;if(f&&!Buffer.isEncoding(f))throw new Error("Unknown encoding: "+f);var h,c=0,u=0,l=t.flag||"r";function p(){0===o?(s=Buffer.allocUnsafe(8192),n.readData(h,s,0,8192,u,d)):n.readData(h,s,c,o-c,u,d)}function d(e,t){return e?n.close(h,function(){return i&&i(e)}):0===t?g():(u+=t,c+=t,void(0!==o?c===o?g():p():(a.push(s.slice(0,t)),p())))}function g(){n.close(h,function(e){return 0===o?s=Buffer.concat(a,c):c<o&&(s=s.slice(0,c)),f&&(s=s.toString(f)),i&&i(e,s)})}this.open(e,l,438,function(t,r){if(t)return i&&i(t);h=r,n.fstat(h,function t(r,f){if(r)n.stat(e,function(e,o){if(e)return n.close(h,function(){i&&i(r)});t(null,o)});else{if(0===(o=f.size||0))return a=[],p();s=Buffer.allocUnsafe(o),p()}})})},k.prototype.writeFile=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n;"function"==typeof i?n=i:"function"==typeof r&&(n=r,r=void 0);var o=this;if("string"==typeof r)r={encoding:r,mode:438,flag:"w"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"w"};if(r.encoding&&!Buffer.isEncoding(r.encoding))throw new Error("Unknown encoding: "+r.encoding);var s=r.flag||"w";this.open(e,s,r.mode,function(i,a){if(i)n&&n(i);else{var f=Buffer.isBuffer(t)?t:Buffer.from(""+t,r.encoding||"utf8"),h=/a/.test(s)?null:0;if(null===h)return void o.fstat(a,function t(r,i){r?o.stat(e,function(e,i){if(e)return o.close(a,function(){n&&n(r)});t(null,i)}):R(o,a,f,0,f.length,i.size,n)});R(o,a,f,0,f.length,h,n)}})},k.prototype.appendFile=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n;if("function"==typeof i?n=i:"function"==typeof r&&(n=r,r=void 0),"string"==typeof r)r={encoding:r,mode:438,flag:"a"};else if(r){if("object"!=typeof r)throw new TypeError("Bad arguments")}else r={encoding:"utf8",mode:438,flag:"a"};r.flag||(r=a._extend({flag:"a"},r)),this.writeFile(e,t,r,n)},k.prototype.exists=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");this.stat(e,function(e){t&&t(!e)})},k.prototype.unlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.REMOVE;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing REMOVE"),this.push(o)},k.prototype.rename=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=this._state,n=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(13+n+4+o);g(a,a.length-4,0),a[4]=y.RENAME;var f=i.writeReqid=(i.writeReqid+1)%b;return g(a,f,5),g(a,n,s),a.write(e,s+=4,n,"utf8"),g(a,o,s+=n),a.write(t,s+=4,o,"utf8"),i.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing RENAME"),this.push(a)},k.prototype.mkdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=0,n=0,o=this._state;"function"==typeof t&&(r=t,t=void 0),"object"==typeof t&&(i=(t=C(t)).flags,n=t.nbytes,t=t.bytes);var s=Buffer.byteLength(e),a=9,f=Buffer.allocUnsafe(13+s+4+n);g(f,f.length-4,0),f[4]=y.MKDIR;var h=o.writeReqid=(o.writeReqid+1)%b;if(g(f,h,5),g(f,s,a),f.write(e,a+=4,s,"utf8"),g(f,i,a+=s),i){a+=4;for(var c=0,u=t.length;c<u;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[h]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing MKDIR"),this.push(f)},k.prototype.rmdir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.RMDIR;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing RMDIR"),this.push(o)},k.prototype.readdir=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i,n=this._state;if("function"==typeof t&&(r=t,t={}),"object"!=typeof t&&(t={}),i=!t||!t.full,!Buffer.isBuffer(e)&&"string"!=typeof e)throw new Error("missing directory handle or path");if("string"==typeof e){var o=this,s=[],a=0;return this.opendir(e,function e(i,n){if(i)return r(i);o.readdir(n,t,function(t,i){var f=t&&t.code===v.EOF;if(t&&!f)return o.close(n,function(){r(t)});if(f)return o.close(n,function(e){if(e)return r(e);r(void 0,s)});for(var h=0,c=i.length;h<c;++h,++a)s[a]=i[h];e(void 0,n)})})}var f=e.length,h=9,c=Buffer.allocUnsafe(13+f);g(c,c.length-4,0),c[4]=y.READDIR;var u=n.writeReqid=(n.writeReqid+1)%b;return g(c,u,5),g(c,f,h),e.copy(c,h+=4),n.requests[u]={cb:i?function(e,t){if(e)return r(e);for(var i=t.length-1;i>=0;--i)"."!==t[i].filename&&".."!==t[i].filename||t.splice(i,1);r(void 0,t)}:r},this.debug("DEBUG[SFTP]: Outgoing: Writing READDIR"),this.push(c)},k.prototype.fstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var r=this._state,i=e.length,n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.FSTAT;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),e.copy(o,n+=4),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing FSTAT"),this.push(o)},k.prototype.stat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.STAT;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing STAT"),this.push(o)},k.prototype.lstat=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.LSTAT;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing LSTAT"),this.push(o)},k.prototype.opendir=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.OPENDIR;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing OPENDIR"),this.push(o)},k.prototype.setstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=0,n=0,o=this._state;"object"==typeof t?(i=(t=C(t)).flags,n=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var s=Buffer.byteLength(e),a=9,f=Buffer.allocUnsafe(13+s+4+n);g(f,f.length-4,0),f[4]=y.SETSTAT;var h=o.writeReqid=(o.writeReqid+1)%b;if(g(f,h,5),g(f,s,a),f.write(e,a+=4,s,"utf8"),g(f,i,a+=s),i){a+=4;for(var c=0,u=t.length;c<u;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[h]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SETSTAT"),this.push(f)},k.prototype.fsetstat=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=0,n=0,o=this._state;"object"==typeof t?(i=(t=C(t)).flags,n=t.nbytes,t=t.bytes):"function"==typeof t&&(r=t);var s=e.length,a=9,f=Buffer.allocUnsafe(13+s+4+n);g(f,f.length-4,0),f[4]=y.FSETSTAT;var h=o.writeReqid=(o.writeReqid+1)%b;if(g(f,h,5),g(f,s,a),e.copy(f,a+=4),g(f,i,a+=s),i){a+=4;for(var c=0,u=t.length;c<u;++c)for(var l=0,p=t[c].length;l<p;++l)f[a++]=t[c][l]}return o.requests[h]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing FSETSTAT"),this.push(f)},k.prototype.futimes=function(e,t,r,i){return this.fsetstat(e,{atime:L(t),mtime:L(r)},i)},k.prototype.utimes=function(e,t,r,i){return this.setstat(e,{atime:L(t),mtime:L(r)},i)},k.prototype.fchown=function(e,t,r,i){return this.fsetstat(e,{uid:t,gid:r},i)},k.prototype.chown=function(e,t,r,i){return this.setstat(e,{uid:t,gid:r},i)},k.prototype.fchmod=function(e,t,r){return this.fsetstat(e,{mode:t},r)},k.prototype.chmod=function(e,t,r){return this.setstat(e,{mode:t},r)},k.prototype.readlink=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.READLINK;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing link info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing READLINK"),this.push(o)},k.prototype.symlink=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=this._state,n=Buffer.byteLength(t),o=Buffer.byteLength(e),s=9,a=Buffer.allocUnsafe(13+n+4+o);g(a,a.length-4,0),a[4]=y.SYMLINK;var f=i.writeReqid=(i.writeReqid+1)%b;return g(a,f,5),this._isOpenSSH?(g(a,o,s),a.write(e,s+=4,o,"utf8"),g(a,n,s+=o),a.write(t,s+=4,n,"utf8")):(g(a,n,s),a.write(t,s+=4,n,"utf8"),g(a,o,s+=n),a.write(e,s+=4,o,"utf8")),i.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing SYMLINK"),this.push(a)},k.prototype.realpath=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=this._state,i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(13+i);g(o,o.length-4,0),o[4]=y.REALPATH;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,i,n),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:function(e,r){return e?t(e):r&&r.length?void t(void 0,r[0].filename):t(new Error("Response missing path info"))}},this.debug("DEBUG[SFTP]: Outgoing: Writing REALPATH"),this.push(o)},k.prototype.ext_openssh_rename=function(e,t,r){var i=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!i.extensions["posix-rename@openssh.com"]||-1===i.extensions["posix-rename@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var n=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(41+n+4+o);g(a,a.length-4,0),a[4]=y.EXTENDED;var f=i.writeReqid=(i.writeReqid+1)%b;return g(a,f,5),g(a,24,s),a.write("posix-rename@openssh.com",s+=4,24,"ascii"),g(a,n,s+=24),a.write(e,s+=4,n,"utf8"),g(a,o,s+=n),a.write(t,s+=4,o,"utf8"),i.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing posix-rename@openssh.com"),this.push(a)},k.prototype.ext_openssh_statvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["statvfs@openssh.com"]||-1===r.extensions["statvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");var i=Buffer.byteLength(e),n=9,o=Buffer.allocUnsafe(36+i);g(o,o.length-4,0),o[4]=y.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,19,n),o.write("statvfs@openssh.com",n+=4,19,"ascii"),g(o,i,n+=19),o.write(e,n+=4,i,"utf8"),r.requests[s]={extended:"statvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing statvfs@openssh.com"),this.push(o)},k.prototype.ext_openssh_fstatvfs=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fstatvfs@openssh.com"]||-1===r.extensions["fstatvfs@openssh.com"].indexOf("2"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=e.length,n=9,o=Buffer.allocUnsafe(37+i);g(o,o.length-4,0),o[4]=y.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,20,n),o.write("fstatvfs@openssh.com",n+=4,20,"ascii"),g(o,i,n+=20),o.write(e,n+=4,i,"utf8"),r.requests[s]={extended:"fstatvfs@openssh.com",cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fstatvfs@openssh.com"),this.push(o)},k.prototype.ext_openssh_hardlink=function(e,t,r){var i=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!i.extensions["hardlink@openssh.com"]||-1===i.extensions["hardlink@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");var n=Buffer.byteLength(e),o=Buffer.byteLength(t),s=9,a=Buffer.allocUnsafe(37+n+4+o);g(a,a.length-4,0),a[4]=y.EXTENDED;var f=i.writeReqid=(i.writeReqid+1)%b;return g(a,f,5),g(a,20,s),a.write("hardlink@openssh.com",s+=4,20,"ascii"),g(a,n,s+=20),a.write(e,s+=4,n,"utf8"),g(a,o,s+=n),a.write(t,s+=4,o,"utf8"),i.requests[f]={cb:r},this.debug("DEBUG[SFTP]: Outgoing: Writing hardlink@openssh.com"),this.push(a)},k.prototype.ext_openssh_fsync=function(e,t){var r=this._state;if(this.server)throw new Error("Client-only method called in server mode");if(!r.extensions["fsync@openssh.com"]||-1===r.extensions["fsync@openssh.com"].indexOf("1"))throw new Error("Server does not support this extended request");if(!Buffer.isBuffer(e))throw new Error("handle is not a Buffer");var i=e.length,n=9,o=Buffer.allocUnsafe(34+i);g(o,o.length-4,0),o[4]=y.EXTENDED;var s=r.writeReqid=(r.writeReqid+1)%b;return g(o,s,5),g(o,17,n),o.write("fsync@openssh.com",n+=4,17,"ascii"),g(o,i,n+=17),o.write(e,n+=4,i,"utf8"),r.requests[s]={cb:t},this.debug("DEBUG[SFTP]: Outgoing: Writing fsync@openssh.com"),this.push(o)},k.prototype.status=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");if(!v[t]||"number"!=typeof t)throw new Error("Bad status code: "+t);r||(r=""),i||(i="");var n=Buffer.byteLength(r),o=Buffer.byteLength(i),s=Buffer.allocUnsafe(17+n+4+o);return g(s,s.length-4,0),s[4]=_.STATUS,g(s,e,5),g(s,t,9),g(s,n,13),n&&s.write(r,17,n,"utf8"),g(s,o,17+n),o&&s.write(i,17+n+4,o,"ascii"),this.debug("DEBUG[SFTP]: Outgoing: Writing STATUS"),this.push(s)},k.prototype.handle=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(!Buffer.isBuffer(t))throw new Error("handle is not a Buffer");var r=t.length;if(r>256)throw new Error("handle too large (> 256 bytes)");var i=Buffer.allocUnsafe(13+r);return g(i,i.length-4,0),i[4]=_.HANDLE,g(i,e,5),g(i,r,9),r&&t.copy(i,13),this.debug("DEBUG[SFTP]: Outgoing: Writing HANDLE"),this.push(i)},k.prototype.data=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var i=Buffer.isBuffer(t);if(!i&&"string"!=typeof t)throw new Error("data is not a Buffer or string");i||r||(r="utf8");var n=i?t.length:Buffer.byteLength(t,r),o=Buffer.allocUnsafe(13+n);return g(o,o.length-4,0),o[4]=_.DATA,g(o,e,5),g(o,n,9),n&&(i?t.copy(o,13):o.write(t,13,n,r)),this.debug("DEBUG[SFTP]: Outgoing: Writing DATA"),this.push(o)},k.prototype.name=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if(Array.isArray(t)||"object"!=typeof t){if(!Array.isArray(t))throw new Error("names is not an object or array")}else t=[t];var r,i,n,o,s,a,f,h,c,u,l,p,d=t.length,E=0,v=[];for(u=0;u<d;++u)n=(i=t[u])&&i.filename&&"string"==typeof i.filename?i.filename:"",E+=4+Buffer.byteLength(n),o=i&&i.longname&&"string"==typeof i.longname?i.longname:"",E+=4+Buffer.byteLength(o),"object"==typeof i.attrs?(E+=4+(r=C(i.attrs)).nbytes,v.push(r)):(E+=4,v.push(null));for(h=Buffer.allocUnsafe(13+E),g(h,h.length-4,0),h[4]=_.NAME,g(h,e,5),g(h,d,9),c=13,u=0;u<d;++u)if(n=(i=t[u])&&i.filename&&"string"==typeof i.filename?i.filename:"",a=Buffer.byteLength(n),g(h,a,c),c+=4,a&&(h.write(n,c,a,"utf8"),c+=a),o=i&&i.longname&&"string"==typeof i.longname?i.longname:"",a=Buffer.byteLength(o),g(h,a,c),c+=4,a&&(h.write(o,c,a,"utf8"),c+=a),s=v[u]){if(g(h,s.flags,c),c+=4,s.flags&&s.bytes){var m=s.bytes;for(l=0,a=m.length;l<a;++l)for(p=0,f=m[l].length;p<f;++p)h[c++]=m[l][p]}}else g(h,0,c),c+=4;return this.debug("DEBUG[SFTP]: Outgoing: Writing NAME"),this.push(h)},k.prototype.attrs=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");if("object"!=typeof t)throw new Error("attrs is not an object");var r=C(t),i=Buffer.allocUnsafe(13+r.nbytes),n=13;if(g(i,i.length-4,0),i[4]=_.ATTRS,g(i,e,5),g(i,r.flags,9),r.flags&&r.bytes)for(var o=r.bytes,s=0,a=o.length;s<a;++s)for(var f=0,h=o[s].length;f<h;++f)i[n++]=o[s][f];return this.debug("DEBUG[SFTP]: Outgoing: Writing ATTRS"),this.push(i)};var P={r:w.READ,"r+":w.READ|w.WRITE,w:w.TRUNC|w.CREAT|w.WRITE,wx:w.TRUNC|w.CREAT|w.WRITE|w.EXCL,xw:w.TRUNC|w.CREAT|w.WRITE|w.EXCL,"w+":w.TRUNC|w.CREAT|w.READ|w.WRITE,"wx+":w.TRUNC|w.CREAT|w.READ|w.WRITE|w.EXCL,"xw+":w.TRUNC|w.CREAT|w.READ|w.WRITE|w.EXCL,a:w.APPEND|w.CREAT|w.WRITE,ax:w.APPEND|w.CREAT|w.WRITE|w.EXCL,xa:w.APPEND|w.CREAT|w.WRITE|w.EXCL,"a+":w.APPEND|w.CREAT|w.READ|w.WRITE,"ax+":w.APPEND|w.CREAT|w.READ|w.WRITE|w.EXCL,"xa+":w.APPEND|w.CREAT|w.READ|w.WRITE|w.EXCL},H=Object.keys(P);function x(e){var t=P[e];return void 0!==t?t:null}function M(e){this.mode=e&&e.mode,this.permissions=this.mode,this.uid=e&&e.uid,this.gid=e&&e.gid,this.size=e&&e.size,this.atime=e&&e.atime,this.mtime=e&&e.mtime}k.stringToFlags=x,k.flagsToString=function(e){for(var t=0;t<H.length;++t){var r=H[t];if(P[r]===e)return r}return null},M.prototype._checkModeProperty=function(e){return(this.mode&s.S_IFMT)===e},M.prototype.isDirectory=function(){return this._checkModeProperty(s.S_IFDIR)},M.prototype.isFile=function(){return this._checkModeProperty(s.S_IFREG)},M.prototype.isBlockDevice=function(){return this._checkModeProperty(s.S_IFBLK)},M.prototype.isCharacterDevice=function(){return this._checkModeProperty(s.S_IFCHR)},M.prototype.isSymbolicLink=function(){return this._checkModeProperty(s.S_IFLNK)},M.prototype.isFIFO=function(){return this._checkModeProperty(s.S_IFIFO)},M.prototype.isSocket=function(){return this._checkModeProperty(s.S_IFSOCK)},k.Stats=M;var G;function K(e,t,r){if(!(this instanceof K))return new K(e,t,r);var i=this;if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}if(void 0===r.highWaterMark&&(r.highWaterMark=65536),n.call(this,r),this.path=t,this.handle=void 0===r.handle?null:r.handle,this.flags=void 0===r.flags?"r":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=void 0===r.start?void 0:r.start,this.end=void 0===r.end?void 0:r.end,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.sftp=e,void 0!==this.start){if("number"!=typeof this.start)throw new TypeError("start must be a Number");if(void 0===this.end)this.end=1/0;else if("number"!=typeof this.end)throw new TypeError("end must be a Number");if(this.start>this.end)throw new Error("start must be <= end");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}this.on("end",function(){i.autoClose&&i.destroy()}),Buffer.isBuffer(this.handle)||this.open()}function F(e,t,r){if(!(this instanceof F))return new F(e,t,r);if(void 0===r)r={};else if("string"==typeof r)r={encoding:r};else{if(null===r||"object"!=typeof r)throw new TypeError('"options" argument must be a string or an object');r=Object.create(r)}if(o.call(this,r),this.path=t,this.handle=void 0===r.handle?null:r.handle,this.flags=void 0===r.flags?"w":r.flags,this.mode=void 0===r.mode?438:r.mode,this.start=void 0===r.start?void 0:r.start,this.autoClose=void 0===r.autoClose||r.autoClose,this.pos=0,this.bytesWritten=0,this.sftp=e,void 0!==this.start){if("number"!=typeof this.start)throw new TypeError("start must be a Number");if(this.start<0)throw new Error("start must be >= zero");this.pos=this.start}r.encoding&&this.setDefaultEncoding(r.encoding),Buffer.isBuffer(this.handle)||this.open(),this.once("finish",function(){this.autoClose&&this.close()})}f(K,n),K.prototype.open=function(){var e=this;this.sftp.open(this.path,this.flags,this.mode,function(t,r){if(t)return e.emit("error",t),this.destroyed=this.closed=!0,void e.emit("close");e.handle=r,e.emit("open",r),e.read()})},K.prototype._read=function(e){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._read(e)});if(!this.destroyed){var t;(!G||G.length-G.used<128)&&(G=null,t=this._readableState.highWaterMark,(G=Buffer.allocUnsafe(t)).used=0);var r=G,i=Math.min(G.length-G.used,e),n=G.used;if(void 0!==this.end&&(i=Math.min(this.end-this.pos+1,i)),i<=0)return this.push(null);var o=this;this.sftp.readData(this.handle,G,G.used,i,this.pos,function(e,t){if(e)o.autoClose&&o.destroy(),o.emit("error",e);else{var i=null;t>0&&(i=r.slice(n,n+t)),o.push(i)}}),this.pos+=i,G.used+=i}},K.prototype.destroy=function(){this.destroyed||(this.destroyed=!0,Buffer.isBuffer(this.handle)&&this.close())},K.prototype.close=function(e){var t=this;if(e&&this.once("close",e),this.closed||!Buffer.isBuffer(this.handle))return Buffer.isBuffer(this.handle)?process.nextTick(this.emit.bind(this,"close")):void this.once("open",r);function r(e){t.sftp.close(e||t.handle,function(e){e?t.emit("error",e):t.emit("close")}),t.handle=null}this.closed=!0,r()},f(F,o),F.prototype.open=function(){var e=this;this.sftp.open(this.path,this.flags,this.mode,function(t,r){if(t)return e.emit("error",t),void(e.autoClose&&(e.destroyed=e.closed=!0,e.emit("close")));e.handle=r,e.sftp.fchmod(r,e.mode,function t(i){i?e.sftp.chmod(e.path,e.mode,function(e){t()}):"a"!==e.flags[0]?e.emit("open",r):e.sftp.fstat(r,function t(i,n){i?e.sftp.stat(e.path,function(r,n){if(r)return e.destroy(),void e.emit("error",i);t(null,n)}):(e.pos=n.size,e.emit("open",r))})})})},F.prototype._write=function(e,t,r){if(!Buffer.isBuffer(e))return this.emit("error",new Error("Invalid data"));if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._write(e,t,r)});var i=this;this.sftp.writeData(this.handle,e,0,e.length,this.pos,function(e,t){if(e)return i.autoClose&&i.destroy(),r(e);i.bytesWritten+=t,r()}),this.pos+=e.length},F.prototype._writev=function(e,t){if(!Buffer.isBuffer(this.handle))return this.once("open",function(){this._writev(e,t)});for(var r=this.sftp,i=this.handle,n=e.length,o=this,s=0;s<e.length;++s){var a=e[s].chunk;r.writeData(i,a,0,a.length,this.pos,f),this.pos+=a.length}function f(e,r){if(e)return o.destroy(),t(e);o.bytesWritten+=r,0==--n&&t()}},F.prototype.destroy=K.prototype.destroy,F.prototype.close=K.prototype.close,F.prototype.destroySoon=F.prototype.end,e.exports=k},function(e,t,r){var i=r(25),n=r(26),o=r(39),s=r(40);for(var a in e.exports={Reader:o,Writer:s},n)n.hasOwnProperty(a)&&(e.exports[a]=n[a]);for(var f in i)i.hasOwnProperty(f)&&(e.exports[f]=i[f])},function(e,t,r){var i=r(14),n=r(29).Buffer,o=r(26),s=r(25).newInvalidAsn1Error;function a(e){if(!e||!n.isBuffer(e))throw new TypeError("data must be a node Buffer");this._buf=e,this._size=e.length,this._len=0,this._offset=0}Object.defineProperty(a.prototype,"length",{enumerable:!0,get:function(){return this._len}}),Object.defineProperty(a.prototype,"offset",{enumerable:!0,get:function(){return this._offset}}),Object.defineProperty(a.prototype,"remain",{get:function(){return this._size-this._offset}}),Object.defineProperty(a.prototype,"buffer",{get:function(){return this._buf.slice(this._offset)}}),a.prototype.readByte=function(e){if(this._size-this._offset<1)return null;var t=255&this._buf[this._offset];return e||(this._offset+=1),t},a.prototype.peek=function(){return this.readByte(!0)},a.prototype.readLength=function(e){if(void 0===e&&(e=this._offset),e>=this._size)return null;var t=255&this._buf[e++];if(null===t)return null;if(128==(128&t)){if(0===(t&=127))throw s("Indefinite length not supported");if(t>4)throw s("encoding too long");if(this._size-e<t)return null;this._len=0;for(var r=0;r<t;r++)this._len=(this._len<<8)+(255&this._buf[e++])}else this._len=t;return e},a.prototype.readSequence=function(e){var t=this.peek();if(null===t)return null;if(void 0!==e&&e!==t)throw s("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);return null===r?null:(this._offset=r,t)},a.prototype.readInt=function(){return this._readTag(o.Integer)},a.prototype.readBoolean=function(){return 0!==this._readTag(o.Boolean)},a.prototype.readEnumeration=function(){return this._readTag(o.Enumeration)},a.prototype.readString=function(e,t){e||(e=o.OctetString);var r=this.peek();if(null===r)return null;if(r!==e)throw s("Expected 0x"+e.toString(16)+": got 0x"+r.toString(16));var i=this.readLength(this._offset+1);if(null===i)return null;if(this.length>this._size-i)return null;if(this._offset=i,0===this.length)return t?n.alloc(0):"";var a=this._buf.slice(this._offset,this._offset+this.length);return this._offset+=this.length,t?a:a.toString("utf8")},a.prototype.readOID=function(e){e||(e=o.OID);var t=this.readString(e,!0);if(null===t)return null;for(var r=[],i=0,n=0;n<t.length;n++){var s=255&t[n];i<<=7,i+=127&s,0==(128&s)&&(r.push(i),i=0)}return i=r.shift(),r.unshift(i%40),r.unshift(i/40>>0),r.join(".")},a.prototype._readTag=function(e){i.ok(void 0!==e);var t=this.peek();if(null===t)return null;if(t!==e)throw s("Expected 0x"+e.toString(16)+": got 0x"+t.toString(16));var r=this.readLength(this._offset+1);if(null===r)return null;if(this.length>4)throw s("Integer too long: "+this.length);if(this.length>this._size-r)return null;this._offset=r;for(var n=this._buf[this._offset],o=0,a=0;a<this.length;a++)o<<=8,o|=255&this._buf[this._offset++];return 128==(128&n)&&4!==a&&(o-=1<<8*a),o>>0},e.exports=a},function(e,t,r){var i=r(14),n=r(29).Buffer,o=r(26),s=r(25).newInvalidAsn1Error,a={size:1024,growthFactor:8};function f(e){var t,r;t=a,r=e||{},i.ok(t),i.equal(typeof t,"object"),i.ok(r),i.equal(typeof r,"object"),Object.getOwnPropertyNames(t).forEach(function(e){if(!r[e]){var i=Object.getOwnPropertyDescriptor(t,e);Object.defineProperty(r,e,i)}}),e=r,this._buf=n.alloc(e.size||1024),this._size=this._buf.length,this._offset=0,this._options=e,this._seq=[]}Object.defineProperty(f.prototype,"buffer",{get:function(){if(this._seq.length)throw s(this._seq.length+" unended sequence(s)");return this._buf.slice(0,this._offset)}}),f.prototype.writeByte=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");this._ensure(1),this._buf[this._offset++]=e},f.prototype.writeInt=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");"number"!=typeof t&&(t=o.Integer);for(var r=4;(0==(4286578688&e)||-8388608==(4286578688&e))&&r>1;)r--,e<<=8;if(r>4)throw s("BER ints cannot be > 0xffffffff");for(this._ensure(2+r),this._buf[this._offset++]=t,this._buf[this._offset++]=r;r-- >0;)this._buf[this._offset++]=(4278190080&e)>>>24,e<<=8},f.prototype.writeNull=function(){this.writeByte(o.Null),this.writeByte(0)},f.prototype.writeEnumeration=function(e,t){if("number"!=typeof e)throw new TypeError("argument must be a Number");return"number"!=typeof t&&(t=o.Enumeration),this.writeInt(e,t)},f.prototype.writeBoolean=function(e,t){if("boolean"!=typeof e)throw new TypeError("argument must be a Boolean");"number"!=typeof t&&(t=o.Boolean),this._ensure(3),this._buf[this._offset++]=t,this._buf[this._offset++]=1,this._buf[this._offset++]=e?255:0},f.prototype.writeString=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string (was: "+typeof e+")");"number"!=typeof t&&(t=o.OctetString);var r=n.byteLength(e);this.writeByte(t),this.writeLength(r),r&&(this._ensure(r),this._buf.write(e,this._offset),this._offset+=r)},f.prototype.writeBuffer=function(e,t){if("number"!=typeof t)throw new TypeError("tag must be a number");if(!n.isBuffer(e))throw new TypeError("argument must be a buffer");this.writeByte(t),this.writeLength(e.length),this._ensure(e.length),e.copy(this._buf,this._offset,0,e.length),this._offset+=e.length},f.prototype.writeStringArray=function(e){if(!e instanceof Array)throw new TypeError("argument must be an Array[String]");var t=this;e.forEach(function(e){t.writeString(e)})},f.prototype.writeOID=function(e,t){if("string"!=typeof e)throw new TypeError("argument must be a string");if("number"!=typeof t&&(t=o.OID),!/^([0-9]+\.){3,}[0-9]+$/.test(e))throw new Error("argument is not a valid OID string");var r=e.split("."),i=[];i.push(40*parseInt(r[0],10)+parseInt(r[1],10)),r.slice(2).forEach(function(e){!function(e,t){t<128?e.push(t):t<16384?(e.push(t>>>7|128),e.push(127&t)):t<2097152?(e.push(t>>>14|128),e.push(255&(t>>>7|128)),e.push(127&t)):t<268435456?(e.push(t>>>21|128),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t)):(e.push(255&(t>>>28|128)),e.push(255&(t>>>21|128)),e.push(255&(t>>>14|128)),e.push(255&(t>>>7|128)),e.push(127&t))}(i,parseInt(e,10))});var n=this;this._ensure(2+i.length),this.writeByte(t),this.writeLength(i.length),i.forEach(function(e){n.writeByte(e)})},f.prototype.writeLength=function(e){if("number"!=typeof e)throw new TypeError("argument must be a Number");if(this._ensure(4),e<=127)this._buf[this._offset++]=e;else if(e<=255)this._buf[this._offset++]=129,this._buf[this._offset++]=e;else if(e<=65535)this._buf[this._offset++]=130,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e;else{if(!(e<=16777215))throw s("Length too long (> 4 bytes)");this._buf[this._offset++]=131,this._buf[this._offset++]=e>>16,this._buf[this._offset++]=e>>8,this._buf[this._offset++]=e}},f.prototype.startSequence=function(e){"number"!=typeof e&&(e=o.Sequence|o.Constructor),this.writeByte(e),this._seq.push(this._offset),this._ensure(3),this._offset+=3},f.prototype.endSequence=function(){var e=this._seq.pop(),t=e+3,r=this._offset-t;if(r<=127)this._shift(t,r,-2),this._buf[e]=r;else if(r<=255)this._shift(t,r,-1),this._buf[e]=129,this._buf[e+1]=r;else if(r<=65535)this._buf[e]=130,this._buf[e+1]=r>>8,this._buf[e+2]=r;else{if(!(r<=16777215))throw s("Sequence too long");this._shift(t,r,1),this._buf[e]=131,this._buf[e+1]=r>>16,this._buf[e+2]=r>>8,this._buf[e+3]=r}},f.prototype._shift=function(e,t,r){i.ok(void 0!==e),i.ok(void 0!==t),i.ok(r),this._buf.copy(this._buf,e+r,e,e+t),this._offset+=r},f.prototype._ensure=function(e){if(i.ok(e),this._size-this._offset<e){var t=this._size*this._options.growthFactor;t-this._offset<e&&(t+=e);var r=n.alloc(t);this._buf.copy(r,0,0,this._offset),this._buf=r,this._size=t}},e.exports=f},function(e,t,r){"use strict";var i=r(42).lowlevel.crypto_hash,n=0,o=function(){this.S=[new Uint32Array([3509652390,2564797868,805139163,3491422135,3101798381,1780907670,3128725573,4046225305,614570311,3012652279,134345442,2240740374,1667834072,1901547113,2757295779,4103290238,227898511,1921955416,1904987480,2182433518,2069144605,3260701109,2620446009,720527379,3318853667,677414384,3393288472,3101374703,2390351024,1614419982,1822297739,2954791486,3608508353,3174124327,2024746970,1432378464,3864339955,2857741204,1464375394,1676153920,1439316330,715854006,3033291828,289532110,2706671279,2087905683,3018724369,1668267050,732546397,1947742710,3462151702,2609353502,2950085171,1814351708,2050118529,680887927,999245976,1800124847,3300911131,1713906067,1641548236,4213287313,1216130144,1575780402,4018429277,3917837745,3693486850,3949271944,596196993,3549867205,258830323,2213823033,772490370,2760122372,1774776394,2652871518,566650946,4142492826,1728879713,2882767088,1783734482,3629395816,2517608232,2874225571,1861159788,326777828,3124490320,2130389656,2716951837,967770486,1724537150,2185432712,2364442137,1164943284,2105845187,998989502,3765401048,2244026483,1075463327,1455516326,1322494562,910128902,469688178,1117454909,936433444,3490320968,3675253459,1240580251,122909385,2157517691,634681816,4142456567,3825094682,3061402683,2540495037,79693498,3249098678,1084186820,1583128258,426386531,1761308591,1047286709,322548459,995290223,1845252383,2603652396,3431023940,2942221577,3202600964,3727903485,1712269319,422464435,3234572375,1170764815,3523960633,3117677531,1434042557,442511882,3600875718,1076654713,1738483198,4213154764,2393238008,3677496056,1014306527,4251020053,793779912,2902807211,842905082,4246964064,1395751752,1040244610,2656851899,3396308128,445077038,3742853595,3577915638,679411651,2892444358,2354009459,1767581616,3150600392,3791627101,3102740896,284835224,4246832056,1258075500,768725851,2589189241,3069724005,3532540348,1274779536,3789419226,2764799539,1660621633,3471099624,4011903706,913787905,3497959166,737222580,2514213453,2928710040,3937242737,1804850592,3499020752,2949064160,2386320175,2390070455,2415321851,4061277028,2290661394,2416832540,1336762016,1754252060,3520065937,3014181293,791618072,3188594551,3933548030,2332172193,3852520463,3043980520,413987798,3465142937,3030929376,4245938359,2093235073,3534596313,375366246,2157278981,2479649556,555357303,3870105701,2008414854,3344188149,4221384143,3956125452,2067696032,3594591187,2921233993,2428461,544322398,577241275,1471733935,610547355,4027169054,1432588573,1507829418,2025931657,3646575487,545086370,48609733,2200306550,1653985193,298326376,1316178497,3007786442,2064951626,458293330,2589141269,3591329599,3164325604,727753846,2179363840,146436021,1461446943,4069977195,705550613,3059967265,3887724982,4281599278,3313849956,1404054877,2845806497,146425753,1854211946]),new Uint32Array([1266315497,3048417604,3681880366,3289982499,290971e4,1235738493,2632868024,2414719590,3970600049,1771706367,1449415276,3266420449,422970021,1963543593,2690192192,3826793022,1062508698,1531092325,1804592342,2583117782,2714934279,4024971509,1294809318,4028980673,1289560198,2221992742,1669523910,35572830,157838143,1052438473,1016535060,1802137761,1753167236,1386275462,3080475397,2857371447,1040679964,2145300060,2390574316,1461121720,2956646967,4031777805,4028374788,33600511,2920084762,1018524850,629373528,3691585981,3515945977,2091462646,2486323059,586499841,988145025,935516892,3367335476,2599673255,2839830854,265290510,3972581182,2759138881,3795373465,1005194799,847297441,406762289,1314163512,1332590856,1866599683,4127851711,750260880,613907577,1450815602,3165620655,3734664991,3650291728,3012275730,3704569646,1427272223,778793252,1343938022,2676280711,2052605720,1946737175,3164576444,3914038668,3967478842,3682934266,1661551462,3294938066,4011595847,840292616,3712170807,616741398,312560963,711312465,1351876610,322626781,1910503582,271666773,2175563734,1594956187,70604529,3617834859,1007753275,1495573769,4069517037,2549218298,2663038764,504708206,2263041392,3941167025,2249088522,1514023603,1998579484,1312622330,694541497,2582060303,2151582166,1382467621,776784248,2618340202,3323268794,2497899128,2784771155,503983604,4076293799,907881277,423175695,432175456,1378068232,4145222326,3954048622,3938656102,3820766613,2793130115,2977904593,26017576,3274890735,3194772133,1700274565,1756076034,4006520079,3677328699,720338349,1533947780,354530856,688349552,3973924725,1637815568,332179504,3949051286,53804574,2852348879,3044236432,1282449977,3583942155,3416972820,4006381244,1617046695,2628476075,3002303598,1686838959,431878346,2686675385,1700445008,1080580658,1009431731,832498133,3223435511,2605976345,2271191193,2516031870,1648197032,4164389018,2548247927,300782431,375919233,238389289,3353747414,2531188641,2019080857,1475708069,455242339,2609103871,448939670,3451063019,1395535956,2413381860,1841049896,1491858159,885456874,4264095073,4001119347,1565136089,3898914787,1108368660,540939232,1173283510,2745871338,3681308437,4207628240,3343053890,4016749493,1699691293,1103962373,3625875870,2256883143,3830138730,1031889488,3479347698,1535977030,4236805024,3251091107,2132092099,1774941330,1199868427,1452454533,157007616,2904115357,342012276,595725824,1480756522,206960106,497939518,591360097,863170706,2375253569,3596610801,1814182875,2094937945,3421402208,1082520231,3463918190,2785509508,435703966,3908032597,1641649973,2842273706,3305899714,1510255612,2148256476,2655287854,3276092548,4258621189,236887753,3681803219,274041037,1734335097,3815195456,3317970021,1899903192,1026095262,4050517792,356393447,2410691914,3873677099,3682840055]),new Uint32Array([3913112168,2491498743,4132185628,2489919796,1091903735,1979897079,3170134830,3567386728,3557303409,857797738,1136121015,1342202287,507115054,2535736646,337727348,3213592640,1301675037,2528481711,1895095763,1721773893,3216771564,62756741,2142006736,835421444,2531993523,1442658625,3659876326,2882144922,676362277,1392781812,170690266,3921047035,1759253602,3611846912,1745797284,664899054,1329594018,3901205900,3045908486,2062866102,2865634940,3543621612,3464012697,1080764994,553557557,3656615353,3996768171,991055499,499776247,1265440854,648242737,3940784050,980351604,3713745714,1749149687,3396870395,4211799374,3640570775,1161844396,3125318951,1431517754,545492359,4268468663,3499529547,1437099964,2702547544,3433638243,2581715763,2787789398,1060185593,1593081372,2418618748,4260947970,69676912,2159744348,86519011,2512459080,3838209314,1220612927,3339683548,133810670,1090789135,1078426020,1569222167,845107691,3583754449,4072456591,1091646820,628848692,1613405280,3757631651,526609435,236106946,48312990,2942717905,3402727701,1797494240,859738849,992217954,4005476642,2243076622,3870952857,3732016268,765654824,3490871365,2511836413,1685915746,3888969200,1414112111,2273134842,3281911079,4080962846,172450625,2569994100,980381355,4109958455,2819808352,2716589560,2568741196,3681446669,3329971472,1835478071,660984891,3704678404,4045999559,3422617507,3040415634,1762651403,1719377915,3470491036,2693910283,3642056355,3138596744,1364962596,2073328063,1983633131,926494387,3423689081,2150032023,4096667949,1749200295,3328846651,309677260,2016342300,1779581495,3079819751,111262694,1274766160,443224088,298511866,1025883608,3806446537,1145181785,168956806,3641502830,3584813610,1689216846,3666258015,3200248200,1692713982,2646376535,4042768518,1618508792,1610833997,3523052358,4130873264,2001055236,3610705100,2202168115,4028541809,2961195399,1006657119,2006996926,3186142756,1430667929,3210227297,1314452623,4074634658,4101304120,2273951170,1399257539,3367210612,3027628629,1190975929,2062231137,2333990788,2221543033,2438960610,1181637006,548689776,2362791313,3372408396,3104550113,3145860560,296247880,1970579870,3078560182,3769228297,1714227617,3291629107,3898220290,166772364,1251581989,493813264,448347421,195405023,2709975567,677966185,3703036547,1463355134,2715995803,1338867538,1343315457,2802222074,2684532164,233230375,2599980071,2000651841,3277868038,1638401717,4028070440,3237316320,6314154,819756386,300326615,590932579,1405279636,3267499572,3150704214,2428286686,3959192993,3461946742,1862657033,1266418056,963775037,2089974820,2263052895,1917689273,448879540,3550394620,3981727096,150775221,3627908307,1303187396,508620638,2975983352,2726630617,1817252668,1876281319,1457606340,908771278,3720792119,3617206836,2455994898,1729034894,1080033504]),new Uint32Array([976866871,3556439503,2881648439,1522871579,1555064734,1336096578,3548522304,2579274686,3574697629,3205460757,3593280638,3338716283,3079412587,564236357,2993598910,1781952180,1464380207,3163844217,3332601554,1699332808,1393555694,1183702653,3581086237,1288719814,691649499,2847557200,2895455976,3193889540,2717570544,1781354906,1676643554,2592534050,3230253752,1126444790,2770207658,2633158820,2210423226,2615765581,2414155088,3127139286,673620729,2805611233,1269405062,4015350505,3341807571,4149409754,1057255273,2012875353,2162469141,2276492801,2601117357,993977747,3918593370,2654263191,753973209,36408145,2530585658,25011837,3520020182,2088578344,530523599,2918365339,1524020338,1518925132,3760827505,3759777254,1202760957,3985898139,3906192525,674977740,4174734889,2031300136,2019492241,3983892565,4153806404,3822280332,352677332,2297720250,60907813,90501309,3286998549,1016092578,2535922412,2839152426,457141659,509813237,4120667899,652014361,1966332200,2975202805,55981186,2327461051,676427537,3255491064,2882294119,3433927263,1307055953,942726286,933058658,2468411793,3933900994,4215176142,1361170020,2001714738,2830558078,3274259782,1222529897,1679025792,2729314320,3714953764,1770335741,151462246,3013232138,1682292957,1483529935,471910574,1539241949,458788160,3436315007,1807016891,3718408830,978976581,1043663428,3165965781,1927990952,4200891579,2372276910,3208408903,3533431907,1412390302,2931980059,4132332400,1947078029,3881505623,4168226417,2941484381,1077988104,1320477388,886195818,18198404,3786409e3,2509781533,112762804,3463356488,1866414978,891333506,18488651,661792760,1628790961,3885187036,3141171499,876946877,2693282273,1372485963,791857591,2686433993,3759982718,3167212022,3472953795,2716379847,445679433,3561995674,3504004811,3574258232,54117162,3331405415,2381918588,3769707343,4154350007,1140177722,4074052095,668550556,3214352940,367459370,261225585,2610173221,4209349473,3468074219,3265815641,314222801,3066103646,3808782860,282218597,3406013506,3773591054,379116347,1285071038,846784868,2669647154,3771962079,3550491691,2305946142,453669953,1268987020,3317592352,3279303384,3744833421,2610507566,3859509063,266596637,3847019092,517658769,3462560207,3443424879,370717030,4247526661,2224018117,4143653529,4112773975,2788324899,2477274417,1456262402,2901442914,1517677493,1846949527,2295493580,3734397586,2176403920,1280348187,1908823572,3871786941,846861322,1172426758,3287448474,3383383037,1655181056,3139813346,901632758,1897031941,2986607138,3066810236,3447102507,1393639104,373351379,950779232,625454576,3124240540,4148612726,2007998917,544563296,2244738638,2330496472,2058025392,1291430526,424198748,50039436,29584100,3605783033,2429876329,2791104160,1057563949,3255363231,3075367218,3463963227,1469046755,985887462])],this.P=new Uint32Array([608135816,2242054355,320440878,57701188,2752067618,698298832,137296536,3964562569,1160258022,953160567,3193202383,887688300,3232508343,3380367581,1065670069,3041331479,2450970073,2306472731])};function s(e,t,r){return(e[0][t[r+3]]+e[1][t[r+2]]^e[2][t[r+1]])+e[3][t[r]]}function a(e,t){var r,i=0;for(r=0;r<4;r++,n++)n>=t&&(n=0),i=i<<8|e[n];return i}o.prototype.encipher=function(e,t){void 0===t&&(t=new Uint8Array(e.buffer),0!==e.byteOffset&&(t=t.subarray(e.byteOffset))),e[0]^=this.P[0];for(var r=1;r<16;r+=2)e[1]^=s(this.S,t,0)^this.P[r],e[0]^=s(this.S,t,4)^this.P[r+1];var i=e[0];e[0]=e[1]^this.P[17],e[1]=i},o.prototype.decipher=function(e){var t=new Uint8Array(e.buffer);0!==e.byteOffset&&(t=t.subarray(e.byteOffset)),e[0]^=this.P[17];for(var r=16;r>0;r-=2)e[1]^=s(this.S,t,0)^this.P[r],e[0]^=s(this.S,t,4)^this.P[r-1];var i=e[0];e[0]=e[1]^this.P[0],e[1]=i},o.prototype.expand0state=function(e,t){var r,i,o=new Uint32Array(2),s=new Uint8Array(o.buffer);for(r=0,n=0;r<18;r++)this.P[r]^=a(e,t);for(n=0,r=0;r<18;r+=2)this.encipher(o,s),this.P[r]=o[0],this.P[r+1]=o[1];for(r=0;r<4;r++)for(i=0;i<256;i+=2)this.encipher(o,s),this.S[r][i]=o[0],this.S[r][i+1]=o[1]},o.prototype.expandstate=function(e,t,r,i){var o,s,f=new Uint32Array(2);for(o=0,n=0;o<18;o++)this.P[o]^=a(r,i);for(o=0,n=0;o<18;o+=2)f[0]^=a(e,t),f[1]^=a(e,t),this.encipher(f),this.P[o]=f[0],this.P[o+1]=f[1];for(o=0;o<4;o++)for(s=0;s<256;s+=2)f[0]^=a(e,t),f[1]^=a(e,t),this.encipher(f),this.S[o][s]=f[0],this.S[o][s+1]=f[1];n=0},o.prototype.enc=function(e,t){for(var r=0;r<t;r++)this.encipher(e.subarray(2*r))},o.prototype.dec=function(e,t){for(var r=0;r<t;r++)this.decipher(e.subarray(2*r))};var f=8,h=32;function c(e,t,r){var i,n=new o,s=new Uint32Array(f),h=new Uint8Array([79,120,121,99,104,114,111,109,97,116,105,99,66,108,111,119,102,105,115,104,83,119,97,116,68,121,110,97,109,105,116,101]);for(n.expandstate(t,64,e,64),i=0;i<64;i++)n.expand0state(t,64),n.expand0state(e,64);for(i=0;i<f;i++)s[i]=a(h,h.byteLength);for(i=0;i<64;i++)n.enc(s,s.byteLength/8);for(i=0;i<f;i++)r[4*i+3]=s[i]>>>24,r[4*i+2]=s[i]>>>16,r[4*i+1]=s[i]>>>8,r[4*i+0]=s[i]}e.exports={BLOCKS:f,HASHSIZE:h,hash:c,pbkdf:function(e,t,r,n,o,s,a){var f,u,l,p,d,g,E=new Uint8Array(64),v=new Uint8Array(64),m=new Uint8Array(h),y=new Uint8Array(h),_=new Uint8Array(n+4),w=s;if(a<1)return-1;if(0===t||0===n||0===s||s>m.byteLength*m.byteLength||n>1<<20)return-1;for(p=Math.floor((s+m.byteLength-1)/m.byteLength),l=Math.floor((s+p-1)/p),f=0;f<n;f++)_[f]=r[f];for(i(E,e,t),g=1;s>0;g++){for(_[n+0]=g>>>24,_[n+1]=g>>>16,_[n+2]=g>>>8,_[n+3]=g,i(v,_,n+4),c(E,v,y),f=m.byteLength;f--;)m[f]=y[f];for(f=1;f<a;f++)for(i(v,y,y.byteLength),c(E,v,y),u=0;u<m.byteLength;u++)m[u]^=y[u];for(l=Math.min(l,s),f=0;f<l&&!((d=f*p+(g-1))>=w);f++)o[d]=m[f];s-=f}return 0}}},function(e,t,r){!function(e){"use strict";var t=function(e){var t,r=new Float64Array(16);if(e)for(t=0;t<e.length;t++)r[t]=e[t];return r},i=function(){throw new Error("no PRNG")},n=new Uint8Array(16),o=new Uint8Array(32);o[0]=9;var s=t(),a=t([1]),f=t([56129,1]),h=t([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),c=t([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),u=t([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),l=t([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),p=t([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function d(e,t,r,i){e[t]=r>>24&255,e[t+1]=r>>16&255,e[t+2]=r>>8&255,e[t+3]=255&r,e[t+4]=i>>24&255,e[t+5]=i>>16&255,e[t+6]=i>>8&255,e[t+7]=255&i}function g(e,t,r,i,n){var o,s=0;for(o=0;o<n;o++)s|=e[t+o]^r[i+o];return(1&s-1>>>8)-1}function E(e,t,r,i){return g(e,t,r,i,16)}function v(e,t,r,i){return g(e,t,r,i,32)}function m(e,t,r,i){!function(e,t,r,i){for(var n,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,h=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,d=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,E=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,y=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,w=o,b=s,S=a,A=f,T=h,U=c,B=u,k=l,N=p,R=d,O=g,D=E,C=v,L=m,I=y,P=_,H=0;H<20;H+=2)w^=(n=(C^=(n=(N^=(n=(T^=(n=w+C|0)<<7|n>>>25)+w|0)<<9|n>>>23)+T|0)<<13|n>>>19)+N|0)<<18|n>>>14,U^=(n=(b^=(n=(L^=(n=(R^=(n=U+b|0)<<7|n>>>25)+U|0)<<9|n>>>23)+R|0)<<13|n>>>19)+L|0)<<18|n>>>14,O^=(n=(B^=(n=(S^=(n=(I^=(n=O+B|0)<<7|n>>>25)+O|0)<<9|n>>>23)+I|0)<<13|n>>>19)+S|0)<<18|n>>>14,P^=(n=(D^=(n=(k^=(n=(A^=(n=P+D|0)<<7|n>>>25)+P|0)<<9|n>>>23)+A|0)<<13|n>>>19)+k|0)<<18|n>>>14,w^=(n=(A^=(n=(S^=(n=(b^=(n=w+A|0)<<7|n>>>25)+w|0)<<9|n>>>23)+b|0)<<13|n>>>19)+S|0)<<18|n>>>14,U^=(n=(T^=(n=(k^=(n=(B^=(n=U+T|0)<<7|n>>>25)+U|0)<<9|n>>>23)+B|0)<<13|n>>>19)+k|0)<<18|n>>>14,O^=(n=(R^=(n=(N^=(n=(D^=(n=O+R|0)<<7|n>>>25)+O|0)<<9|n>>>23)+D|0)<<13|n>>>19)+N|0)<<18|n>>>14,P^=(n=(I^=(n=(L^=(n=(C^=(n=P+I|0)<<7|n>>>25)+P|0)<<9|n>>>23)+C|0)<<13|n>>>19)+L|0)<<18|n>>>14;w=w+o|0,b=b+s|0,S=S+a|0,A=A+f|0,T=T+h|0,U=U+c|0,B=B+u|0,k=k+l|0,N=N+p|0,R=R+d|0,O=O+g|0,D=D+E|0,C=C+v|0,L=L+m|0,I=I+y|0,P=P+_|0,e[0]=w>>>0&255,e[1]=w>>>8&255,e[2]=w>>>16&255,e[3]=w>>>24&255,e[4]=b>>>0&255,e[5]=b>>>8&255,e[6]=b>>>16&255,e[7]=b>>>24&255,e[8]=S>>>0&255,e[9]=S>>>8&255,e[10]=S>>>16&255,e[11]=S>>>24&255,e[12]=A>>>0&255,e[13]=A>>>8&255,e[14]=A>>>16&255,e[15]=A>>>24&255,e[16]=T>>>0&255,e[17]=T>>>8&255,e[18]=T>>>16&255,e[19]=T>>>24&255,e[20]=U>>>0&255,e[21]=U>>>8&255,e[22]=U>>>16&255,e[23]=U>>>24&255,e[24]=B>>>0&255,e[25]=B>>>8&255,e[26]=B>>>16&255,e[27]=B>>>24&255,e[28]=k>>>0&255,e[29]=k>>>8&255,e[30]=k>>>16&255,e[31]=k>>>24&255,e[32]=N>>>0&255,e[33]=N>>>8&255,e[34]=N>>>16&255,e[35]=N>>>24&255,e[36]=R>>>0&255,e[37]=R>>>8&255,e[38]=R>>>16&255,e[39]=R>>>24&255,e[40]=O>>>0&255,e[41]=O>>>8&255,e[42]=O>>>16&255,e[43]=O>>>24&255,e[44]=D>>>0&255,e[45]=D>>>8&255,e[46]=D>>>16&255,e[47]=D>>>24&255,e[48]=C>>>0&255,e[49]=C>>>8&255,e[50]=C>>>16&255,e[51]=C>>>24&255,e[52]=L>>>0&255,e[53]=L>>>8&255,e[54]=L>>>16&255,e[55]=L>>>24&255,e[56]=I>>>0&255,e[57]=I>>>8&255,e[58]=I>>>16&255,e[59]=I>>>24&255,e[60]=P>>>0&255,e[61]=P>>>8&255,e[62]=P>>>16&255,e[63]=P>>>24&255}(e,t,r,i)}function y(e,t,r,i){!function(e,t,r,i){for(var n,o=255&i[0]|(255&i[1])<<8|(255&i[2])<<16|(255&i[3])<<24,s=255&r[0]|(255&r[1])<<8|(255&r[2])<<16|(255&r[3])<<24,a=255&r[4]|(255&r[5])<<8|(255&r[6])<<16|(255&r[7])<<24,f=255&r[8]|(255&r[9])<<8|(255&r[10])<<16|(255&r[11])<<24,h=255&r[12]|(255&r[13])<<8|(255&r[14])<<16|(255&r[15])<<24,c=255&i[4]|(255&i[5])<<8|(255&i[6])<<16|(255&i[7])<<24,u=255&t[0]|(255&t[1])<<8|(255&t[2])<<16|(255&t[3])<<24,l=255&t[4]|(255&t[5])<<8|(255&t[6])<<16|(255&t[7])<<24,p=255&t[8]|(255&t[9])<<8|(255&t[10])<<16|(255&t[11])<<24,d=255&t[12]|(255&t[13])<<8|(255&t[14])<<16|(255&t[15])<<24,g=255&i[8]|(255&i[9])<<8|(255&i[10])<<16|(255&i[11])<<24,E=255&r[16]|(255&r[17])<<8|(255&r[18])<<16|(255&r[19])<<24,v=255&r[20]|(255&r[21])<<8|(255&r[22])<<16|(255&r[23])<<24,m=255&r[24]|(255&r[25])<<8|(255&r[26])<<16|(255&r[27])<<24,y=255&r[28]|(255&r[29])<<8|(255&r[30])<<16|(255&r[31])<<24,_=255&i[12]|(255&i[13])<<8|(255&i[14])<<16|(255&i[15])<<24,w=0;w<20;w+=2)o^=(n=(v^=(n=(p^=(n=(h^=(n=o+v|0)<<7|n>>>25)+o|0)<<9|n>>>23)+h|0)<<13|n>>>19)+p|0)<<18|n>>>14,c^=(n=(s^=(n=(m^=(n=(d^=(n=c+s|0)<<7|n>>>25)+c|0)<<9|n>>>23)+d|0)<<13|n>>>19)+m|0)<<18|n>>>14,g^=(n=(u^=(n=(a^=(n=(y^=(n=g+u|0)<<7|n>>>25)+g|0)<<9|n>>>23)+y|0)<<13|n>>>19)+a|0)<<18|n>>>14,_^=(n=(E^=(n=(l^=(n=(f^=(n=_+E|0)<<7|n>>>25)+_|0)<<9|n>>>23)+f|0)<<13|n>>>19)+l|0)<<18|n>>>14,o^=(n=(f^=(n=(a^=(n=(s^=(n=o+f|0)<<7|n>>>25)+o|0)<<9|n>>>23)+s|0)<<13|n>>>19)+a|0)<<18|n>>>14,c^=(n=(h^=(n=(l^=(n=(u^=(n=c+h|0)<<7|n>>>25)+c|0)<<9|n>>>23)+u|0)<<13|n>>>19)+l|0)<<18|n>>>14,g^=(n=(d^=(n=(p^=(n=(E^=(n=g+d|0)<<7|n>>>25)+g|0)<<9|n>>>23)+E|0)<<13|n>>>19)+p|0)<<18|n>>>14,_^=(n=(y^=(n=(m^=(n=(v^=(n=_+y|0)<<7|n>>>25)+_|0)<<9|n>>>23)+v|0)<<13|n>>>19)+m|0)<<18|n>>>14;e[0]=o>>>0&255,e[1]=o>>>8&255,e[2]=o>>>16&255,e[3]=o>>>24&255,e[4]=c>>>0&255,e[5]=c>>>8&255,e[6]=c>>>16&255,e[7]=c>>>24&255,e[8]=g>>>0&255,e[9]=g>>>8&255,e[10]=g>>>16&255,e[11]=g>>>24&255,e[12]=_>>>0&255,e[13]=_>>>8&255,e[14]=_>>>16&255,e[15]=_>>>24&255,e[16]=u>>>0&255,e[17]=u>>>8&255,e[18]=u>>>16&255,e[19]=u>>>24&255,e[20]=l>>>0&255,e[21]=l>>>8&255,e[22]=l>>>16&255,e[23]=l>>>24&255,e[24]=p>>>0&255,e[25]=p>>>8&255,e[26]=p>>>16&255,e[27]=p>>>24&255,e[28]=d>>>0&255,e[29]=d>>>8&255,e[30]=d>>>16&255,e[31]=d>>>24&255}(e,t,r,i)}var _=new Uint8Array([101,120,112,97,110,100,32,51,50,45,98,121,116,101,32,107]);function w(e,t,r,i,n,o,s){var a,f,h=new Uint8Array(16),c=new Uint8Array(64);for(f=0;f<16;f++)h[f]=0;for(f=0;f<8;f++)h[f]=o[f];for(;n>=64;){for(m(c,h,s,_),f=0;f<64;f++)e[t+f]=r[i+f]^c[f];for(a=1,f=8;f<16;f++)a=a+(255&h[f])|0,h[f]=255&a,a>>>=8;n-=64,t+=64,i+=64}if(n>0)for(m(c,h,s,_),f=0;f<n;f++)e[t+f]=r[i+f]^c[f];return 0}function b(e,t,r,i,n){var o,s,a=new Uint8Array(16),f=new Uint8Array(64);for(s=0;s<16;s++)a[s]=0;for(s=0;s<8;s++)a[s]=i[s];for(;r>=64;){for(m(f,a,n,_),s=0;s<64;s++)e[t+s]=f[s];for(o=1,s=8;s<16;s++)o=o+(255&a[s])|0,a[s]=255&o,o>>>=8;r-=64,t+=64}if(r>0)for(m(f,a,n,_),s=0;s<r;s++)e[t+s]=f[s];return 0}function S(e,t,r,i,n){var o=new Uint8Array(32);y(o,i,n,_);for(var s=new Uint8Array(8),a=0;a<8;a++)s[a]=i[a+16];return b(e,t,r,s,o)}function A(e,t,r,i,n,o,s){var a=new Uint8Array(32);y(a,o,s,_);for(var f=new Uint8Array(8),h=0;h<8;h++)f[h]=o[h+16];return w(e,t,r,i,n,f,a)}var T=function(e){var t,r,i,n,o,s,a,f;this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.leftover=0,this.fin=0,t=255&e[0]|(255&e[1])<<8,this.r[0]=8191&t,r=255&e[2]|(255&e[3])<<8,this.r[1]=8191&(t>>>13|r<<3),i=255&e[4]|(255&e[5])<<8,this.r[2]=7939&(r>>>10|i<<6),n=255&e[6]|(255&e[7])<<8,this.r[3]=8191&(i>>>7|n<<9),o=255&e[8]|(255&e[9])<<8,this.r[4]=255&(n>>>4|o<<12),this.r[5]=o>>>1&8190,s=255&e[10]|(255&e[11])<<8,this.r[6]=8191&(o>>>14|s<<2),a=255&e[12]|(255&e[13])<<8,this.r[7]=8065&(s>>>11|a<<5),f=255&e[14]|(255&e[15])<<8,this.r[8]=8191&(a>>>8|f<<8),this.r[9]=f>>>5&127,this.pad[0]=255&e[16]|(255&e[17])<<8,this.pad[1]=255&e[18]|(255&e[19])<<8,this.pad[2]=255&e[20]|(255&e[21])<<8,this.pad[3]=255&e[22]|(255&e[23])<<8,this.pad[4]=255&e[24]|(255&e[25])<<8,this.pad[5]=255&e[26]|(255&e[27])<<8,this.pad[6]=255&e[28]|(255&e[29])<<8,this.pad[7]=255&e[30]|(255&e[31])<<8};function U(e,t,r,i,n,o){var s=new T(o);return s.update(r,i,n),s.finish(e,t),0}function B(e,t,r,i,n,o){var s=new Uint8Array(16);return U(s,0,r,i,n,o),E(e,t,s,0)}function k(e,t,r,i,n){var o;if(r<32)return-1;for(A(e,0,t,0,r,i,n),U(e,16,e,32,r-32,e),o=0;o<16;o++)e[o]=0;return 0}function N(e,t,r,i,n){var o,s=new Uint8Array(32);if(r<32)return-1;if(S(s,0,32,i,n),0!==B(t,16,t,32,r-32,s))return-1;for(A(e,0,t,0,r,i,n),o=0;o<32;o++)e[o]=0;return 0}function R(e,t){var r;for(r=0;r<16;r++)e[r]=0|t[r]}function O(e){var t,r,i=1;for(t=0;t<16;t++)r=e[t]+i+65535,i=Math.floor(r/65536),e[t]=r-65536*i;e[0]+=i-1+37*(i-1)}function D(e,t,r){for(var i,n=~(r-1),o=0;o<16;o++)i=n&(e[o]^t[o]),e[o]^=i,t[o]^=i}function C(e,r){var i,n,o,s=t(),a=t();for(i=0;i<16;i++)a[i]=r[i];for(O(a),O(a),O(a),n=0;n<2;n++){for(s[0]=a[0]-65517,i=1;i<15;i++)s[i]=a[i]-65535-(s[i-1]>>16&1),s[i-1]&=65535;s[15]=a[15]-32767-(s[14]>>16&1),o=s[15]>>16&1,s[14]&=65535,D(a,s,1-o)}for(i=0;i<16;i++)e[2*i]=255&a[i],e[2*i+1]=a[i]>>8}function L(e,t){var r=new Uint8Array(32),i=new Uint8Array(32);return C(r,e),C(i,t),v(r,0,i,0)}function I(e){var t=new Uint8Array(32);return C(t,e),1&t[0]}function P(e,t){var r;for(r=0;r<16;r++)e[r]=t[2*r]+(t[2*r+1]<<8);e[15]&=32767}function H(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]+r[i]}function x(e,t,r){for(var i=0;i<16;i++)e[i]=t[i]-r[i]}function M(e,t,r){var i,n,o=0,s=0,a=0,f=0,h=0,c=0,u=0,l=0,p=0,d=0,g=0,E=0,v=0,m=0,y=0,_=0,w=0,b=0,S=0,A=0,T=0,U=0,B=0,k=0,N=0,R=0,O=0,D=0,C=0,L=0,I=0,P=r[0],H=r[1],x=r[2],M=r[3],G=r[4],K=r[5],F=r[6],q=r[7],W=r[8],X=r[9],V=r[10],Q=r[11],Y=r[12],z=r[13],j=r[14],Z=r[15];o+=(i=t[0])*P,s+=i*H,a+=i*x,f+=i*M,h+=i*G,c+=i*K,u+=i*F,l+=i*q,p+=i*W,d+=i*X,g+=i*V,E+=i*Q,v+=i*Y,m+=i*z,y+=i*j,_+=i*Z,s+=(i=t[1])*P,a+=i*H,f+=i*x,h+=i*M,c+=i*G,u+=i*K,l+=i*F,p+=i*q,d+=i*W,g+=i*X,E+=i*V,v+=i*Q,m+=i*Y,y+=i*z,_+=i*j,w+=i*Z,a+=(i=t[2])*P,f+=i*H,h+=i*x,c+=i*M,u+=i*G,l+=i*K,p+=i*F,d+=i*q,g+=i*W,E+=i*X,v+=i*V,m+=i*Q,y+=i*Y,_+=i*z,w+=i*j,b+=i*Z,f+=(i=t[3])*P,h+=i*H,c+=i*x,u+=i*M,l+=i*G,p+=i*K,d+=i*F,g+=i*q,E+=i*W,v+=i*X,m+=i*V,y+=i*Q,_+=i*Y,w+=i*z,b+=i*j,S+=i*Z,h+=(i=t[4])*P,c+=i*H,u+=i*x,l+=i*M,p+=i*G,d+=i*K,g+=i*F,E+=i*q,v+=i*W,m+=i*X,y+=i*V,_+=i*Q,w+=i*Y,b+=i*z,S+=i*j,A+=i*Z,c+=(i=t[5])*P,u+=i*H,l+=i*x,p+=i*M,d+=i*G,g+=i*K,E+=i*F,v+=i*q,m+=i*W,y+=i*X,_+=i*V,w+=i*Q,b+=i*Y,S+=i*z,A+=i*j,T+=i*Z,u+=(i=t[6])*P,l+=i*H,p+=i*x,d+=i*M,g+=i*G,E+=i*K,v+=i*F,m+=i*q,y+=i*W,_+=i*X,w+=i*V,b+=i*Q,S+=i*Y,A+=i*z,T+=i*j,U+=i*Z,l+=(i=t[7])*P,p+=i*H,d+=i*x,g+=i*M,E+=i*G,v+=i*K,m+=i*F,y+=i*q,_+=i*W,w+=i*X,b+=i*V,S+=i*Q,A+=i*Y,T+=i*z,U+=i*j,B+=i*Z,p+=(i=t[8])*P,d+=i*H,g+=i*x,E+=i*M,v+=i*G,m+=i*K,y+=i*F,_+=i*q,w+=i*W,b+=i*X,S+=i*V,A+=i*Q,T+=i*Y,U+=i*z,B+=i*j,k+=i*Z,d+=(i=t[9])*P,g+=i*H,E+=i*x,v+=i*M,m+=i*G,y+=i*K,_+=i*F,w+=i*q,b+=i*W,S+=i*X,A+=i*V,T+=i*Q,U+=i*Y,B+=i*z,k+=i*j,N+=i*Z,g+=(i=t[10])*P,E+=i*H,v+=i*x,m+=i*M,y+=i*G,_+=i*K,w+=i*F,b+=i*q,S+=i*W,A+=i*X,T+=i*V,U+=i*Q,B+=i*Y,k+=i*z,N+=i*j,R+=i*Z,E+=(i=t[11])*P,v+=i*H,m+=i*x,y+=i*M,_+=i*G,w+=i*K,b+=i*F,S+=i*q,A+=i*W,T+=i*X,U+=i*V,B+=i*Q,k+=i*Y,N+=i*z,R+=i*j,O+=i*Z,v+=(i=t[12])*P,m+=i*H,y+=i*x,_+=i*M,w+=i*G,b+=i*K,S+=i*F,A+=i*q,T+=i*W,U+=i*X,B+=i*V,k+=i*Q,N+=i*Y,R+=i*z,O+=i*j,D+=i*Z,m+=(i=t[13])*P,y+=i*H,_+=i*x,w+=i*M,b+=i*G,S+=i*K,A+=i*F,T+=i*q,U+=i*W,B+=i*X,k+=i*V,N+=i*Q,R+=i*Y,O+=i*z,D+=i*j,C+=i*Z,y+=(i=t[14])*P,_+=i*H,w+=i*x,b+=i*M,S+=i*G,A+=i*K,T+=i*F,U+=i*q,B+=i*W,k+=i*X,N+=i*V,R+=i*Q,O+=i*Y,D+=i*z,C+=i*j,L+=i*Z,_+=(i=t[15])*P,s+=38*(b+=i*x),a+=38*(S+=i*M),f+=38*(A+=i*G),h+=38*(T+=i*K),c+=38*(U+=i*F),u+=38*(B+=i*q),l+=38*(k+=i*W),p+=38*(N+=i*X),d+=38*(R+=i*V),g+=38*(O+=i*Q),E+=38*(D+=i*Y),v+=38*(C+=i*z),m+=38*(L+=i*j),y+=38*(I+=i*Z),o=(i=(o+=38*(w+=i*H))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),E=(i=E+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),_=(i=_+n+65535)-65536*(n=Math.floor(i/65536)),o=(i=(o+=n-1+37*(n-1))+(n=1)+65535)-65536*(n=Math.floor(i/65536)),s=(i=s+n+65535)-65536*(n=Math.floor(i/65536)),a=(i=a+n+65535)-65536*(n=Math.floor(i/65536)),f=(i=f+n+65535)-65536*(n=Math.floor(i/65536)),h=(i=h+n+65535)-65536*(n=Math.floor(i/65536)),c=(i=c+n+65535)-65536*(n=Math.floor(i/65536)),u=(i=u+n+65535)-65536*(n=Math.floor(i/65536)),l=(i=l+n+65535)-65536*(n=Math.floor(i/65536)),p=(i=p+n+65535)-65536*(n=Math.floor(i/65536)),d=(i=d+n+65535)-65536*(n=Math.floor(i/65536)),g=(i=g+n+65535)-65536*(n=Math.floor(i/65536)),E=(i=E+n+65535)-65536*(n=Math.floor(i/65536)),v=(i=v+n+65535)-65536*(n=Math.floor(i/65536)),m=(i=m+n+65535)-65536*(n=Math.floor(i/65536)),y=(i=y+n+65535)-65536*(n=Math.floor(i/65536)),_=(i=_+n+65535)-65536*(n=Math.floor(i/65536)),o+=n-1+37*(n-1),e[0]=o,e[1]=s,e[2]=a,e[3]=f,e[4]=h,e[5]=c,e[6]=u,e[7]=l,e[8]=p,e[9]=d,e[10]=g,e[11]=E,e[12]=v,e[13]=m,e[14]=y,e[15]=_}function G(e,t){M(e,t,t)}function K(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=253;i>=0;i--)G(n,n),2!==i&&4!==i&&M(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}function F(e,r,i){var n,o,s=new Uint8Array(32),a=new Float64Array(80),h=t(),c=t(),u=t(),l=t(),p=t(),d=t();for(o=0;o<31;o++)s[o]=r[o];for(s[31]=127&r[31]|64,s[0]&=248,P(a,i),o=0;o<16;o++)c[o]=a[o],l[o]=h[o]=u[o]=0;for(h[0]=l[0]=1,o=254;o>=0;--o)D(h,c,n=s[o>>>3]>>>(7&o)&1),D(u,l,n),H(p,h,u),x(h,h,u),H(u,c,l),x(c,c,l),G(l,p),G(d,h),M(h,u,h),M(u,c,p),H(p,h,u),x(h,h,u),G(c,h),x(u,l,d),M(h,u,f),H(h,h,l),M(u,u,h),M(h,l,d),M(l,c,a),G(c,p),D(h,c,n),D(u,l,n);for(o=0;o<16;o++)a[o+16]=h[o],a[o+32]=u[o],a[o+48]=c[o],a[o+64]=l[o];var g=a.subarray(32),E=a.subarray(16);return K(g,g),M(E,E,g),C(e,E),0}function q(e,t){return F(e,t,o)}function W(e,t){return i(t,32),q(e,t)}function X(e,t,r){var i=new Uint8Array(32);return F(i,r,t),y(e,n,i,_)}T.prototype.blocks=function(e,t,r){for(var i,n,o,s,a,f,h,c,u,l,p,d,g,E,v,m,y,_,w,b=this.fin?0:2048,S=this.h[0],A=this.h[1],T=this.h[2],U=this.h[3],B=this.h[4],k=this.h[5],N=this.h[6],R=this.h[7],O=this.h[8],D=this.h[9],C=this.r[0],L=this.r[1],I=this.r[2],P=this.r[3],H=this.r[4],x=this.r[5],M=this.r[6],G=this.r[7],K=this.r[8],F=this.r[9];r>=16;)l=u=0,l+=(S+=8191&(i=255&e[t+0]|(255&e[t+1])<<8))*C,l+=(A+=8191&(i>>>13|(n=255&e[t+2]|(255&e[t+3])<<8)<<3))*(5*F),l+=(T+=8191&(n>>>10|(o=255&e[t+4]|(255&e[t+5])<<8)<<6))*(5*K),l+=(U+=8191&(o>>>7|(s=255&e[t+6]|(255&e[t+7])<<8)<<9))*(5*G),u=(l+=(B+=8191&(s>>>4|(a=255&e[t+8]|(255&e[t+9])<<8)<<12))*(5*M))>>>13,l&=8191,l+=(k+=a>>>1&8191)*(5*x),l+=(N+=8191&(a>>>14|(f=255&e[t+10]|(255&e[t+11])<<8)<<2))*(5*H),l+=(R+=8191&(f>>>11|(h=255&e[t+12]|(255&e[t+13])<<8)<<5))*(5*P),l+=(O+=8191&(h>>>8|(c=255&e[t+14]|(255&e[t+15])<<8)<<8))*(5*I),p=u+=(l+=(D+=c>>>5|b)*(5*L))>>>13,p+=S*L,p+=A*C,p+=T*(5*F),p+=U*(5*K),u=(p+=B*(5*G))>>>13,p&=8191,p+=k*(5*M),p+=N*(5*x),p+=R*(5*H),p+=O*(5*P),u+=(p+=D*(5*I))>>>13,p&=8191,d=u,d+=S*I,d+=A*L,d+=T*C,d+=U*(5*F),u=(d+=B*(5*K))>>>13,d&=8191,d+=k*(5*G),d+=N*(5*M),d+=R*(5*x),d+=O*(5*H),g=u+=(d+=D*(5*P))>>>13,g+=S*P,g+=A*I,g+=T*L,g+=U*C,u=(g+=B*(5*F))>>>13,g&=8191,g+=k*(5*K),g+=N*(5*G),g+=R*(5*M),g+=O*(5*x),E=u+=(g+=D*(5*H))>>>13,E+=S*H,E+=A*P,E+=T*I,E+=U*L,u=(E+=B*C)>>>13,E&=8191,E+=k*(5*F),E+=N*(5*K),E+=R*(5*G),E+=O*(5*M),v=u+=(E+=D*(5*x))>>>13,v+=S*x,v+=A*H,v+=T*P,v+=U*I,u=(v+=B*L)>>>13,v&=8191,v+=k*C,v+=N*(5*F),v+=R*(5*K),v+=O*(5*G),m=u+=(v+=D*(5*M))>>>13,m+=S*M,m+=A*x,m+=T*H,m+=U*P,u=(m+=B*I)>>>13,m&=8191,m+=k*L,m+=N*C,m+=R*(5*F),m+=O*(5*K),y=u+=(m+=D*(5*G))>>>13,y+=S*G,y+=A*M,y+=T*x,y+=U*H,u=(y+=B*P)>>>13,y&=8191,y+=k*I,y+=N*L,y+=R*C,y+=O*(5*F),_=u+=(y+=D*(5*K))>>>13,_+=S*K,_+=A*G,_+=T*M,_+=U*x,u=(_+=B*H)>>>13,_&=8191,_+=k*P,_+=N*I,_+=R*L,_+=O*C,w=u+=(_+=D*(5*F))>>>13,w+=S*F,w+=A*K,w+=T*G,w+=U*M,u=(w+=B*x)>>>13,w&=8191,w+=k*H,w+=N*P,w+=R*I,w+=O*L,S=l=8191&(u=(u=((u+=(w+=D*C)>>>13)<<2)+u|0)+(l&=8191)|0),A=p+=u>>>=13,T=d&=8191,U=g&=8191,B=E&=8191,k=v&=8191,N=m&=8191,R=y&=8191,O=_&=8191,D=w&=8191,t+=16,r-=16;this.h[0]=S,this.h[1]=A,this.h[2]=T,this.h[3]=U,this.h[4]=B,this.h[5]=k,this.h[6]=N,this.h[7]=R,this.h[8]=O,this.h[9]=D},T.prototype.finish=function(e,t){var r,i,n,o,s=new Uint16Array(10);if(this.leftover){for(o=this.leftover,this.buffer[o++]=1;o<16;o++)this.buffer[o]=0;this.fin=1,this.blocks(this.buffer,0,16)}for(r=this.h[1]>>>13,this.h[1]&=8191,o=2;o<10;o++)this.h[o]+=r,r=this.h[o]>>>13,this.h[o]&=8191;for(this.h[0]+=5*r,r=this.h[0]>>>13,this.h[0]&=8191,this.h[1]+=r,r=this.h[1]>>>13,this.h[1]&=8191,this.h[2]+=r,s[0]=this.h[0]+5,r=s[0]>>>13,s[0]&=8191,o=1;o<10;o++)s[o]=this.h[o]+r,r=s[o]>>>13,s[o]&=8191;for(s[9]-=8192,i=(1^r)-1,o=0;o<10;o++)s[o]&=i;for(i=~i,o=0;o<10;o++)this.h[o]=this.h[o]&i|s[o];for(this.h[0]=65535&(this.h[0]|this.h[1]<<13),this.h[1]=65535&(this.h[1]>>>3|this.h[2]<<10),this.h[2]=65535&(this.h[2]>>>6|this.h[3]<<7),this.h[3]=65535&(this.h[3]>>>9|this.h[4]<<4),this.h[4]=65535&(this.h[4]>>>12|this.h[5]<<1|this.h[6]<<14),this.h[5]=65535&(this.h[6]>>>2|this.h[7]<<11),this.h[6]=65535&(this.h[7]>>>5|this.h[8]<<8),this.h[7]=65535&(this.h[8]>>>8|this.h[9]<<5),n=this.h[0]+this.pad[0],this.h[0]=65535&n,o=1;o<8;o++)n=(this.h[o]+this.pad[o]|0)+(n>>>16)|0,this.h[o]=65535&n;e[t+0]=this.h[0]>>>0&255,e[t+1]=this.h[0]>>>8&255,e[t+2]=this.h[1]>>>0&255,e[t+3]=this.h[1]>>>8&255,e[t+4]=this.h[2]>>>0&255,e[t+5]=this.h[2]>>>8&255,e[t+6]=this.h[3]>>>0&255,e[t+7]=this.h[3]>>>8&255,e[t+8]=this.h[4]>>>0&255,e[t+9]=this.h[4]>>>8&255,e[t+10]=this.h[5]>>>0&255,e[t+11]=this.h[5]>>>8&255,e[t+12]=this.h[6]>>>0&255,e[t+13]=this.h[6]>>>8&255,e[t+14]=this.h[7]>>>0&255,e[t+15]=this.h[7]>>>8&255},T.prototype.update=function(e,t,r){var i,n;if(this.leftover){for((n=16-this.leftover)>r&&(n=r),i=0;i<n;i++)this.buffer[this.leftover+i]=e[t+i];if(r-=n,t+=n,this.leftover+=n,this.leftover<16)return;this.blocks(this.buffer,0,16),this.leftover=0}if(r>=16&&(n=r-r%16,this.blocks(e,t,n),t+=n,r-=n),r){for(i=0;i<r;i++)this.buffer[this.leftover+i]=e[t+i];this.leftover+=r}};var V=k,Q=N;var Y=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function z(e,t,r,i){for(var n,o,s,a,f,h,c,u,l,p,d,g,E,v,m,y,_,w,b,S,A,T,U,B,k,N,R=new Int32Array(16),O=new Int32Array(16),D=e[0],C=e[1],L=e[2],I=e[3],P=e[4],H=e[5],x=e[6],M=e[7],G=t[0],K=t[1],F=t[2],q=t[3],W=t[4],X=t[5],V=t[6],Q=t[7],z=0;i>=128;){for(b=0;b<16;b++)S=8*b+z,R[b]=r[S+0]<<24|r[S+1]<<16|r[S+2]<<8|r[S+3],O[b]=r[S+4]<<24|r[S+5]<<16|r[S+6]<<8|r[S+7];for(b=0;b<80;b++)if(n=D,o=C,s=L,a=I,f=P,h=H,c=x,M,l=G,p=K,d=F,g=q,E=W,v=X,m=V,Q,U=65535&(T=Q),B=T>>>16,k=65535&(A=M),N=A>>>16,U+=65535&(T=(W>>>14|P<<18)^(W>>>18|P<<14)^(P>>>9|W<<23)),B+=T>>>16,k+=65535&(A=(P>>>14|W<<18)^(P>>>18|W<<14)^(W>>>9|P<<23)),N+=A>>>16,U+=65535&(T=W&X^~W&V),B+=T>>>16,k+=65535&(A=P&H^~P&x),N+=A>>>16,A=Y[2*b],U+=65535&(T=Y[2*b+1]),B+=T>>>16,k+=65535&A,N+=A>>>16,A=R[b%16],B+=(T=O[b%16])>>>16,k+=65535&A,N+=A>>>16,k+=(B+=(U+=65535&T)>>>16)>>>16,U=65535&(T=w=65535&U|B<<16),B=T>>>16,k=65535&(A=_=65535&k|(N+=k>>>16)<<16),N=A>>>16,U+=65535&(T=(G>>>28|D<<4)^(D>>>2|G<<30)^(D>>>7|G<<25)),B+=T>>>16,k+=65535&(A=(D>>>28|G<<4)^(G>>>2|D<<30)^(G>>>7|D<<25)),N+=A>>>16,B+=(T=G&K^G&F^K&F)>>>16,k+=65535&(A=D&C^D&L^C&L),N+=A>>>16,u=65535&(k+=(B+=(U+=65535&T)>>>16)>>>16)|(N+=k>>>16)<<16,y=65535&U|B<<16,U=65535&(T=g),B=T>>>16,k=65535&(A=a),N=A>>>16,B+=(T=w)>>>16,k+=65535&(A=_),N+=A>>>16,C=n,L=o,I=s,P=a=65535&(k+=(B+=(U+=65535&T)>>>16)>>>16)|(N+=k>>>16)<<16,H=f,x=h,M=c,D=u,K=l,F=p,q=d,W=g=65535&U|B<<16,X=E,V=v,Q=m,G=y,b%16==15)for(S=0;S<16;S++)A=R[S],U=65535&(T=O[S]),B=T>>>16,k=65535&A,N=A>>>16,A=R[(S+9)%16],U+=65535&(T=O[(S+9)%16]),B+=T>>>16,k+=65535&A,N+=A>>>16,_=R[(S+1)%16],U+=65535&(T=((w=O[(S+1)%16])>>>1|_<<31)^(w>>>8|_<<24)^(w>>>7|_<<25)),B+=T>>>16,k+=65535&(A=(_>>>1|w<<31)^(_>>>8|w<<24)^_>>>7),N+=A>>>16,_=R[(S+14)%16],B+=(T=((w=O[(S+14)%16])>>>19|_<<13)^(_>>>29|w<<3)^(w>>>6|_<<26))>>>16,k+=65535&(A=(_>>>19|w<<13)^(w>>>29|_<<3)^_>>>6),N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,R[S]=65535&k|N<<16,O[S]=65535&U|B<<16;U=65535&(T=G),B=T>>>16,k=65535&(A=D),N=A>>>16,A=e[0],B+=(T=t[0])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[0]=D=65535&k|N<<16,t[0]=G=65535&U|B<<16,U=65535&(T=K),B=T>>>16,k=65535&(A=C),N=A>>>16,A=e[1],B+=(T=t[1])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[1]=C=65535&k|N<<16,t[1]=K=65535&U|B<<16,U=65535&(T=F),B=T>>>16,k=65535&(A=L),N=A>>>16,A=e[2],B+=(T=t[2])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[2]=L=65535&k|N<<16,t[2]=F=65535&U|B<<16,U=65535&(T=q),B=T>>>16,k=65535&(A=I),N=A>>>16,A=e[3],B+=(T=t[3])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[3]=I=65535&k|N<<16,t[3]=q=65535&U|B<<16,U=65535&(T=W),B=T>>>16,k=65535&(A=P),N=A>>>16,A=e[4],B+=(T=t[4])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[4]=P=65535&k|N<<16,t[4]=W=65535&U|B<<16,U=65535&(T=X),B=T>>>16,k=65535&(A=H),N=A>>>16,A=e[5],B+=(T=t[5])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[5]=H=65535&k|N<<16,t[5]=X=65535&U|B<<16,U=65535&(T=V),B=T>>>16,k=65535&(A=x),N=A>>>16,A=e[6],B+=(T=t[6])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[6]=x=65535&k|N<<16,t[6]=V=65535&U|B<<16,U=65535&(T=Q),B=T>>>16,k=65535&(A=M),N=A>>>16,A=e[7],B+=(T=t[7])>>>16,k+=65535&A,N+=A>>>16,N+=(k+=(B+=(U+=65535&T)>>>16)>>>16)>>>16,e[7]=M=65535&k|N<<16,t[7]=Q=65535&U|B<<16,z+=128,i-=128}return i}function j(e,t,r){var i,n=new Int32Array(8),o=new Int32Array(8),s=new Uint8Array(256),a=r;for(n[0]=1779033703,n[1]=3144134277,n[2]=1013904242,n[3]=2773480762,n[4]=1359893119,n[5]=2600822924,n[6]=528734635,n[7]=1541459225,o[0]=4089235720,o[1]=2227873595,o[2]=4271175723,o[3]=1595750129,o[4]=2917565137,o[5]=725511199,o[6]=4215389547,o[7]=327033209,z(n,o,t,r),r%=128,i=0;i<r;i++)s[i]=t[a-r+i];for(s[r]=128,s[(r=256-128*(r<112?1:0))-9]=0,d(s,r-8,a/536870912|0,a<<3),z(n,o,s,r),i=0;i<8;i++)d(e,8*i,n[i],o[i]);return 0}function Z(e,r){var i=t(),n=t(),o=t(),s=t(),a=t(),f=t(),h=t(),u=t(),l=t();x(i,e[1],e[0]),x(l,r[1],r[0]),M(i,i,l),H(n,e[0],e[1]),H(l,r[0],r[1]),M(n,n,l),M(o,e[3],r[3]),M(o,o,c),M(s,e[2],r[2]),H(s,s,s),x(a,n,i),x(f,s,o),H(h,s,o),H(u,n,i),M(e[0],a,f),M(e[1],u,h),M(e[2],h,f),M(e[3],a,u)}function $(e,t,r){var i;for(i=0;i<4;i++)D(e[i],t[i],r)}function J(e,r){var i=t(),n=t(),o=t();K(o,r[2]),M(i,r[0],o),M(n,r[1],o),C(e,n),e[31]^=I(i)<<7}function ee(e,t,r){var i,n;for(R(e[0],s),R(e[1],a),R(e[2],a),R(e[3],s),n=255;n>=0;--n)$(e,t,i=r[n/8|0]>>(7&n)&1),Z(t,e),Z(e,e),$(e,t,i)}function te(e,r){var i=[t(),t(),t(),t()];R(i[0],u),R(i[1],l),R(i[2],a),M(i[3],u,l),ee(e,i,r)}function re(e,r,n){var o,s=new Uint8Array(64),a=[t(),t(),t(),t()];for(n||i(r,32),j(s,r,32),s[0]&=248,s[31]&=127,s[31]|=64,te(a,s),J(e,a),o=0;o<32;o++)r[o+32]=e[o];return 0}var ie=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function ne(e,t){var r,i,n,o;for(i=63;i>=32;--i){for(r=0,n=i-32,o=i-12;n<o;++n)t[n]+=r-16*t[i]*ie[n-(i-32)],r=t[n]+128>>8,t[n]-=256*r;t[n]+=r,t[i]=0}for(r=0,n=0;n<32;n++)t[n]+=r-(t[31]>>4)*ie[n],r=t[n]>>8,t[n]&=255;for(n=0;n<32;n++)t[n]-=r*ie[n];for(i=0;i<32;i++)t[i+1]+=t[i]>>8,e[i]=255&t[i]}function oe(e){var t,r=new Float64Array(64);for(t=0;t<64;t++)r[t]=e[t];for(t=0;t<64;t++)e[t]=0;ne(e,r)}function se(e,r,i,n){var o,s,a=new Uint8Array(64),f=new Uint8Array(64),h=new Uint8Array(64),c=new Float64Array(64),u=[t(),t(),t(),t()];j(a,n,32),a[0]&=248,a[31]&=127,a[31]|=64;var l=i+64;for(o=0;o<i;o++)e[64+o]=r[o];for(o=0;o<32;o++)e[32+o]=a[32+o];for(j(h,e.subarray(32),i+32),oe(h),te(u,h),J(e,u),o=32;o<64;o++)e[o]=n[o];for(j(f,e,i+64),oe(f),o=0;o<64;o++)c[o]=0;for(o=0;o<32;o++)c[o]=h[o];for(o=0;o<32;o++)for(s=0;s<32;s++)c[o+s]+=f[o]*a[s];return ne(e.subarray(32),c),l}function ae(e,r){var i=t(),n=t(),o=t(),f=t(),c=t(),u=t(),l=t();return R(e[2],a),P(e[1],r),G(o,e[1]),M(f,o,h),x(o,o,e[2]),H(f,e[2],f),G(c,f),G(u,c),M(l,u,c),M(i,l,o),M(i,i,f),function(e,r){var i,n=t();for(i=0;i<16;i++)n[i]=r[i];for(i=250;i>=0;i--)G(n,n),1!==i&&M(n,n,r);for(i=0;i<16;i++)e[i]=n[i]}(i,i),M(i,i,o),M(i,i,f),M(i,i,f),M(e[0],i,f),G(n,e[0]),M(n,n,f),L(n,o)&&M(e[0],e[0],p),G(n,e[0]),M(n,n,f),L(n,o)?-1:(I(e[0])===r[31]>>7&&x(e[0],s,e[0]),M(e[3],e[0],e[1]),0)}function fe(e,r,i,n){var o,s=new Uint8Array(32),a=new Uint8Array(64),f=[t(),t(),t(),t()],h=[t(),t(),t(),t()];if(-1,i<64)return-1;if(ae(h,n))return-1;for(o=0;o<i;o++)e[o]=r[o];for(o=0;o<32;o++)e[o+32]=n[o];if(j(a,e,i),oe(a),ee(f,h,a),te(h,r.subarray(32)),Z(f,h),J(s,f),i-=64,v(r,0,s,0)){for(o=0;o<i;o++)e[o]=0;return-1}for(o=0;o<i;o++)e[o]=r[o+64];return i}var he=32,ce=24,ue=32,le=32,pe=ce;function de(e,t){if(e.length!==he)throw new Error("bad key size");if(t.length!==ce)throw new Error("bad nonce size")}function ge(){var e,t;for(t=0;t<arguments.length;t++)if("[object Uint8Array]"!==(e=Object.prototype.toString.call(arguments[t])))throw new TypeError("unexpected type "+e+", use Uint8Array")}function Ee(e){for(var t=0;t<e.length;t++)e[t]=0}e.lowlevel={crypto_core_hsalsa20:y,crypto_stream_xor:A,crypto_stream:S,crypto_stream_salsa20_xor:w,crypto_stream_salsa20:b,crypto_onetimeauth:U,crypto_onetimeauth_verify:B,crypto_verify_16:E,crypto_verify_32:v,crypto_secretbox:k,crypto_secretbox_open:N,crypto_scalarmult:F,crypto_scalarmult_base:q,crypto_box_beforenm:X,crypto_box_afternm:V,crypto_box:function(e,t,r,i,n,o){var s=new Uint8Array(32);return X(s,n,o),V(e,t,r,i,s)},crypto_box_open:function(e,t,r,i,n,o){var s=new Uint8Array(32);return X(s,n,o),Q(e,t,r,i,s)},crypto_box_keypair:W,crypto_hash:j,crypto_sign:se,crypto_sign_keypair:re,crypto_sign_open:fe,crypto_secretbox_KEYBYTES:he,crypto_secretbox_NONCEBYTES:ce,crypto_secretbox_ZEROBYTES:32,crypto_secretbox_BOXZEROBYTES:16,crypto_scalarmult_BYTES:32,crypto_scalarmult_SCALARBYTES:32,crypto_box_PUBLICKEYBYTES:ue,crypto_box_SECRETKEYBYTES:le,crypto_box_BEFORENMBYTES:32,crypto_box_NONCEBYTES:pe,crypto_box_ZEROBYTES:32,crypto_box_BOXZEROBYTES:16,crypto_sign_BYTES:64,crypto_sign_PUBLICKEYBYTES:32,crypto_sign_SECRETKEYBYTES:64,crypto_sign_SEEDBYTES:32,crypto_hash_BYTES:64},e.util||(e.util={},e.util.decodeUTF8=e.util.encodeUTF8=e.util.encodeBase64=e.util.decodeBase64=function(){throw new Error("nacl.util moved into separate package: https://github.com/dchest/tweetnacl-util-js")}),e.randomBytes=function(e){var t=new Uint8Array(e);return i(t,e),t},e.secretbox=function(e,t,r){ge(e,t,r),de(r,t);for(var i=new Uint8Array(32+e.length),n=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+32]=e[o];return k(n,i,i.length,t,r),n.subarray(16)},e.secretbox.open=function(e,t,r){ge(e,t,r),de(r,t);for(var i=new Uint8Array(16+e.length),n=new Uint8Array(i.length),o=0;o<e.length;o++)i[o+16]=e[o];return!(i.length<32)&&(0===N(n,i,i.length,t,r)&&n.subarray(32))},e.secretbox.keyLength=he,e.secretbox.nonceLength=ce,e.secretbox.overheadLength=16,e.scalarMult=function(e,t){if(ge(e,t),32!==e.length)throw new Error("bad n size");if(32!==t.length)throw new Error("bad p size");var r=new Uint8Array(32);return F(r,e,t),r},e.scalarMult.base=function(e){if(ge(e),32!==e.length)throw new Error("bad n size");var t=new Uint8Array(32);return q(t,e),t},e.scalarMult.scalarLength=32,e.scalarMult.groupElementLength=32,e.box=function(t,r,i,n){var o=e.box.before(i,n);return e.secretbox(t,r,o)},e.box.before=function(e,t){ge(e,t),function(e,t){if(e.length!==ue)throw new Error("bad public key size");if(t.length!==le)throw new Error("bad secret key size")}(e,t);var r=new Uint8Array(32);return X(r,e,t),r},e.box.after=e.secretbox,e.box.open=function(t,r,i,n){var o=e.box.before(i,n);return e.secretbox.open(t,r,o)},e.box.open.after=e.secretbox.open,e.box.keyPair=function(){var e=new Uint8Array(ue),t=new Uint8Array(le);return W(e,t),{publicKey:e,secretKey:t}},e.box.keyPair.fromSecretKey=function(e){if(ge(e),e.length!==le)throw new Error("bad secret key size");var t=new Uint8Array(ue);return q(t,e),{publicKey:t,secretKey:new Uint8Array(e)}},e.box.publicKeyLength=ue,e.box.secretKeyLength=le,e.box.sharedKeyLength=32,e.box.nonceLength=pe,e.box.overheadLength=e.secretbox.overheadLength,e.sign=function(e,t){if(ge(e,t),64!==t.length)throw new Error("bad secret key size");var r=new Uint8Array(64+e.length);return se(r,e,e.length,t),r},e.sign.open=function(e,t){if(2!==arguments.length)throw new Error("nacl.sign.open accepts 2 arguments; did you mean to use nacl.sign.detached.verify?");if(ge(e,t),32!==t.length)throw new Error("bad public key size");var r=new Uint8Array(e.length),i=fe(r,e,e.length,t);if(i<0)return null;for(var n=new Uint8Array(i),o=0;o<n.length;o++)n[o]=r[o];return n},e.sign.detached=function(t,r){for(var i=e.sign(t,r),n=new Uint8Array(64),o=0;o<n.length;o++)n[o]=i[o];return n},e.sign.detached.verify=function(e,t,r){if(ge(e,t,r),64!==t.length)throw new Error("bad signature size");if(32!==r.length)throw new Error("bad public key size");var i,n=new Uint8Array(64+e.length),o=new Uint8Array(64+e.length);for(i=0;i<64;i++)n[i]=t[i];for(i=0;i<e.length;i++)n[i+64]=e[i];return fe(o,n,n.length,r)>=0},e.sign.keyPair=function(){var e=new Uint8Array(32),t=new Uint8Array(64);return re(e,t),{publicKey:e,secretKey:t}},e.sign.keyPair.fromSecretKey=function(e){if(ge(e),64!==e.length)throw new Error("bad secret key size");for(var t=new Uint8Array(32),r=0;r<t.length;r++)t[r]=e[32+r];return{publicKey:t,secretKey:new Uint8Array(e)}},e.sign.keyPair.fromSeed=function(e){if(ge(e),32!==e.length)throw new Error("bad seed size");for(var t=new Uint8Array(32),r=new Uint8Array(64),i=0;i<32;i++)r[i]=e[i];return re(t,r,!0),{publicKey:t,secretKey:r}},e.sign.publicKeyLength=32,e.sign.secretKeyLength=64,e.sign.seedLength=32,e.sign.signatureLength=64,e.hash=function(e){ge(e);var t=new Uint8Array(64);return j(t,e,e.length),t},e.hash.hashLength=64,e.verify=function(e,t){return ge(e,t),0!==e.length&&0!==t.length&&(e.length===t.length&&0===g(e,0,t,0,e.length))},e.setPRNG=function(e){i=e},function(){var t="undefined"!=typeof self?self.crypto||self.msCrypto:null;if(t&&t.getRandomValues){e.setPRNG(function(e,r){var i,n=new Uint8Array(r);for(i=0;i<r;i+=65536)t.getRandomValues(n.subarray(i,i+Math.min(r-i,65536)));for(i=0;i<r;i++)e[i]=n[i];Ee(n)})}else(t=r(12))&&t.randomBytes&&e.setPRNG(function(e,r){var i,n=t.randomBytes(r);for(i=0;i<r;i++)e[i]=n[i];Ee(n)})}()}(e.exports?e.exports:self.nacl=self.nacl||{})},function(e,t){function r(e,t,r){null!=e&&("number"==typeof e?this.fromNumber(e,t,r):null==t&&"string"!=typeof e?this.fromString(e,256):this.fromString(e,t))}function i(){return new r(null)}r.prototype.am=function(e,t,r,i,n,o){for(var s=16383&t,a=t>>14;--o>=0;){var f=16383&this[e],h=this[e++]>>14,c=a*f+h*s;n=((f=s*f+((16383&c)<<14)+r[i]+n)>>28)+(c>>14)+a*h,r[i++]=268435455&f}return n},r.prototype.DB=28,r.prototype.DM=268435455,r.prototype.DV=1<<28;r.prototype.FV=Math.pow(2,52),r.prototype.F1=24,r.prototype.F2=4;var n,o,s="0123456789abcdefghijklmnopqrstuvwxyz",a=new Array;for(n="0".charCodeAt(0),o=0;o<=9;++o)a[n++]=o;for(n="a".charCodeAt(0),o=10;o<36;++o)a[n++]=o;for(n="A".charCodeAt(0),o=10;o<36;++o)a[n++]=o;function f(e){return s.charAt(e)}function h(e,t){var r=a[e.charCodeAt(t)];return null==r?-1:r}function c(e){var t=i();return t.fromInt(e),t}function u(e){var t,r=1;return 0!=(t=e>>>16)&&(e=t,r+=16),0!=(t=e>>8)&&(e=t,r+=8),0!=(t=e>>4)&&(e=t,r+=4),0!=(t=e>>2)&&(e=t,r+=2),0!=(t=e>>1)&&(e=t,r+=1),r}function l(e){this.m=e}function p(e){this.m=e,this.mp=e.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<e.DB-15)-1,this.mt2=2*e.t}function d(e,t){return e&t}function g(e,t){return e|t}function E(e,t){return e^t}function v(e,t){return e&~t}function m(e){if(0==e)return-1;var t=0;return 0==(65535&e)&&(e>>=16,t+=16),0==(255&e)&&(e>>=8,t+=8),0==(15&e)&&(e>>=4,t+=4),0==(3&e)&&(e>>=2,t+=2),0==(1&e)&&++t,t}function y(e){for(var t=0;0!=e;)e&=e-1,++t;return t}function _(){}function w(e){return e}function b(e){this.r2=i(),this.q3=i(),r.ONE.dlShiftTo(2*e.t,this.r2),this.mu=this.r2.divide(e),this.m=e}l.prototype.convert=function(e){return e.s<0||e.compareTo(this.m)>=0?e.mod(this.m):e},l.prototype.revert=function(e){return e},l.prototype.reduce=function(e){e.divRemTo(this.m,null,e)},l.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},l.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},p.prototype.convert=function(e){var t=i();return e.abs().dlShiftTo(this.m.t,t),t.divRemTo(this.m,null,t),e.s<0&&t.compareTo(r.ZERO)>0&&this.m.subTo(t,t),t},p.prototype.revert=function(e){var t=i();return e.copyTo(t),this.reduce(t),t},p.prototype.reduce=function(e){for(;e.t<=this.mt2;)e[e.t++]=0;for(var t=0;t<this.m.t;++t){var r=32767&e[t],i=r*this.mpl+((r*this.mph+(e[t]>>15)*this.mpl&this.um)<<15)&e.DM;for(e[r=t+this.m.t]+=this.m.am(0,i,e,t,0,this.m.t);e[r]>=e.DV;)e[r]-=e.DV,e[++r]++}e.clamp(),e.drShiftTo(this.m.t,e),e.compareTo(this.m)>=0&&e.subTo(this.m,e)},p.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},p.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)},r.prototype.copyTo=function(e){for(var t=this.t-1;t>=0;--t)e[t]=this[t];e.t=this.t,e.s=this.s},r.prototype.fromInt=function(e){this.t=1,this.s=e<0?-1:0,e>0?this[0]=e:e<-1?this[0]=e+this.DV:this.t=0},r.prototype.fromString=function(e,t){var i;if(16==t)i=4;else if(8==t)i=3;else if(256==t)i=8;else if(2==t)i=1;else if(32==t)i=5;else{if(4!=t)return void this.fromRadix(e,t);i=2}this.t=0,this.s=0;for(var n=e.length,o=!1,s=0;--n>=0;){var a=8==i?255&e[n]:h(e,n);a<0?"-"==e.charAt(n)&&(o=!0):(o=!1,0==s?this[this.t++]=a:s+i>this.DB?(this[this.t-1]|=(a&(1<<this.DB-s)-1)<<s,this[this.t++]=a>>this.DB-s):this[this.t-1]|=a<<s,(s+=i)>=this.DB&&(s-=this.DB))}8==i&&0!=(128&e[0])&&(this.s=-1,s>0&&(this[this.t-1]|=(1<<this.DB-s)-1<<s)),this.clamp(),o&&r.ZERO.subTo(this,this)},r.prototype.clamp=function(){for(var e=this.s&this.DM;this.t>0&&this[this.t-1]==e;)--this.t},r.prototype.dlShiftTo=function(e,t){var r;for(r=this.t-1;r>=0;--r)t[r+e]=this[r];for(r=e-1;r>=0;--r)t[r]=0;t.t=this.t+e,t.s=this.s},r.prototype.drShiftTo=function(e,t){for(var r=e;r<this.t;++r)t[r-e]=this[r];t.t=Math.max(this.t-e,0),t.s=this.s},r.prototype.lShiftTo=function(e,t){var r,i=e%this.DB,n=this.DB-i,o=(1<<n)-1,s=Math.floor(e/this.DB),a=this.s<<i&this.DM;for(r=this.t-1;r>=0;--r)t[r+s+1]=this[r]>>n|a,a=(this[r]&o)<<i;for(r=s-1;r>=0;--r)t[r]=0;t[s]=a,t.t=this.t+s+1,t.s=this.s,t.clamp()},r.prototype.rShiftTo=function(e,t){t.s=this.s;var r=Math.floor(e/this.DB);if(r>=this.t)t.t=0;else{var i=e%this.DB,n=this.DB-i,o=(1<<i)-1;t[0]=this[r]>>i;for(var s=r+1;s<this.t;++s)t[s-r-1]|=(this[s]&o)<<n,t[s-r]=this[s]>>i;i>0&&(t[this.t-r-1]|=(this.s&o)<<n),t.t=this.t-r,t.clamp()}},r.prototype.subTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]-e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i-=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i-=e[r],t[r++]=i&this.DM,i>>=this.DB;i-=e.s}t.s=i<0?-1:0,i<-1?t[r++]=this.DV+i:i>0&&(t[r++]=i),t.t=r,t.clamp()},r.prototype.multiplyTo=function(e,t){var i=this.abs(),n=e.abs(),o=i.t;for(t.t=o+n.t;--o>=0;)t[o]=0;for(o=0;o<n.t;++o)t[o+i.t]=i.am(0,n[o],t,o,0,i.t);t.s=0,t.clamp(),this.s!=e.s&&r.ZERO.subTo(t,t)},r.prototype.squareTo=function(e){for(var t=this.abs(),r=e.t=2*t.t;--r>=0;)e[r]=0;for(r=0;r<t.t-1;++r){var i=t.am(r,t[r],e,2*r,0,1);(e[r+t.t]+=t.am(r+1,2*t[r],e,2*r+1,i,t.t-r-1))>=t.DV&&(e[r+t.t]-=t.DV,e[r+t.t+1]=1)}e.t>0&&(e[e.t-1]+=t.am(r,t[r],e,2*r,0,1)),e.s=0,e.clamp()},r.prototype.divRemTo=function(e,t,n){var o=e.abs();if(!(o.t<=0)){var s=this.abs();if(s.t<o.t)return null!=t&&t.fromInt(0),void(null!=n&&this.copyTo(n));null==n&&(n=i());var a=i(),f=this.s,h=e.s,c=this.DB-u(o[o.t-1]);c>0?(o.lShiftTo(c,a),s.lShiftTo(c,n)):(o.copyTo(a),s.copyTo(n));var l=a.t,p=a[l-1];if(0!=p){var d=p*(1<<this.F1)+(l>1?a[l-2]>>this.F2:0),g=this.FV/d,E=(1<<this.F1)/d,v=1<<this.F2,m=n.t,y=m-l,_=null==t?i():t;for(a.dlShiftTo(y,_),n.compareTo(_)>=0&&(n[n.t++]=1,n.subTo(_,n)),r.ONE.dlShiftTo(l,_),_.subTo(a,a);a.t<l;)a[a.t++]=0;for(;--y>=0;){var w=n[--m]==p?this.DM:Math.floor(n[m]*g+(n[m-1]+v)*E);if((n[m]+=a.am(0,w,n,y,0,l))<w)for(a.dlShiftTo(y,_),n.subTo(_,n);n[m]<--w;)n.subTo(_,n)}null!=t&&(n.drShiftTo(l,t),f!=h&&r.ZERO.subTo(t,t)),n.t=l,n.clamp(),c>0&&n.rShiftTo(c,n),f<0&&r.ZERO.subTo(n,n)}}},r.prototype.invDigit=function(){if(this.t<1)return 0;var e=this[0];if(0==(1&e))return 0;var t=3&e;return(t=(t=(t=(t=t*(2-(15&e)*t)&15)*(2-(255&e)*t)&255)*(2-((65535&e)*t&65535))&65535)*(2-e*t%this.DV)%this.DV)>0?this.DV-t:-t},r.prototype.isEven=function(){return 0==(this.t>0?1&this[0]:this.s)},r.prototype.exp=function(e,t){if(e>4294967295||e<1)return r.ONE;var n=i(),o=i(),s=t.convert(this),a=u(e)-1;for(s.copyTo(n);--a>=0;)if(t.sqrTo(n,o),(e&1<<a)>0)t.mulTo(o,s,n);else{var f=n;n=o,o=f}return t.revert(n)},r.prototype.toString=function(e){if(this.s<0)return"-"+this.negate().toString(e);var t;if(16==e)t=4;else if(8==e)t=3;else if(2==e)t=1;else if(32==e)t=5;else{if(4!=e)return this.toRadix(e);t=2}var r,i=(1<<t)-1,n=!1,o="",s=this.t,a=this.DB-s*this.DB%t;if(s-- >0)for(a<this.DB&&(r=this[s]>>a)>0&&(n=!0,o=f(r));s>=0;)a<t?(r=(this[s]&(1<<a)-1)<<t-a,r|=this[--s]>>(a+=this.DB-t)):(r=this[s]>>(a-=t)&i,a<=0&&(a+=this.DB,--s)),r>0&&(n=!0),n&&(o+=f(r));return n?o:"0"},r.prototype.negate=function(){var e=i();return r.ZERO.subTo(this,e),e},r.prototype.abs=function(){return this.s<0?this.negate():this},r.prototype.compareTo=function(e){var t=this.s-e.s;if(0!=t)return t;var r=this.t;if(0!=(t=r-e.t))return this.s<0?-t:t;for(;--r>=0;)if(0!=(t=this[r]-e[r]))return t;return 0},r.prototype.bitLength=function(){return this.t<=0?0:this.DB*(this.t-1)+u(this[this.t-1]^this.s&this.DM)},r.prototype.mod=function(e){var t=i();return this.abs().divRemTo(e,null,t),this.s<0&&t.compareTo(r.ZERO)>0&&e.subTo(t,t),t},r.prototype.modPowInt=function(e,t){var r;return r=e<256||t.isEven()?new l(t):new p(t),this.exp(e,r)},r.ZERO=c(0),r.ONE=c(1),_.prototype.convert=w,_.prototype.revert=w,_.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r)},_.prototype.sqrTo=function(e,t){e.squareTo(t)},b.prototype.convert=function(e){if(e.s<0||e.t>2*this.m.t)return e.mod(this.m);if(e.compareTo(this.m)<0)return e;var t=i();return e.copyTo(t),this.reduce(t),t},b.prototype.revert=function(e){return e},b.prototype.reduce=function(e){for(e.drShiftTo(this.m.t-1,this.r2),e.t>this.m.t+1&&(e.t=this.m.t+1,e.clamp()),this.mu.multiplyUpperTo(this.r2,this.m.t+1,this.q3),this.m.multiplyLowerTo(this.q3,this.m.t+1,this.r2);e.compareTo(this.r2)<0;)e.dAddOffset(1,this.m.t+1);for(e.subTo(this.r2,e);e.compareTo(this.m)>=0;)e.subTo(this.m,e)},b.prototype.mulTo=function(e,t,r){e.multiplyTo(t,r),this.reduce(r)},b.prototype.sqrTo=function(e,t){e.squareTo(t),this.reduce(t)};var S=[2,3,5,7,11,13,17,19,23,29,31,37,41,43,47,53,59,61,67,71,73,79,83,89,97,101,103,107,109,113,127,131,137,139,149,151,157,163,167,173,179,181,191,193,197,199,211,223,227,229,233,239,241,251,257,263,269,271,277,281,283,293,307,311,313,317,331,337,347,349,353,359,367,373,379,383,389,397,401,409,419,421,431,433,439,443,449,457,461,463,467,479,487,491,499,503,509,521,523,541,547,557,563,569,571,577,587,593,599,601,607,613,617,619,631,641,643,647,653,659,661,673,677,683,691,701,709,719,727,733,739,743,751,757,761,769,773,787,797,809,811,821,823,827,829,839,853,857,859,863,877,881,883,887,907,911,919,929,937,941,947,953,967,971,977,983,991,997],A=(1<<26)/S[S.length-1];r.prototype.chunkSize=function(e){return Math.floor(Math.LN2*this.DB/Math.log(e))},r.prototype.toRadix=function(e){if(null==e&&(e=10),0==this.signum()||e<2||e>36)return"0";var t=this.chunkSize(e),r=Math.pow(e,t),n=c(r),o=i(),s=i(),a="";for(this.divRemTo(n,o,s);o.signum()>0;)a=(r+s.intValue()).toString(e).substr(1)+a,o.divRemTo(n,o,s);return s.intValue().toString(e)+a},r.prototype.fromRadix=function(e,t){this.fromInt(0),null==t&&(t=10);for(var i=this.chunkSize(t),n=Math.pow(t,i),o=!1,s=0,a=0,f=0;f<e.length;++f){var c=h(e,f);c<0?"-"==e.charAt(f)&&0==this.signum()&&(o=!0):(a=t*a+c,++s>=i&&(this.dMultiply(n),this.dAddOffset(a,0),s=0,a=0))}s>0&&(this.dMultiply(Math.pow(t,s)),this.dAddOffset(a,0)),o&&r.ZERO.subTo(this,this)},r.prototype.fromNumber=function(e,t,i){if("number"==typeof t)if(e<2)this.fromInt(1);else for(this.fromNumber(e,i),this.testBit(e-1)||this.bitwiseTo(r.ONE.shiftLeft(e-1),g,this),this.isEven()&&this.dAddOffset(1,0);!this.isProbablePrime(t);)this.dAddOffset(2,0),this.bitLength()>e&&this.subTo(r.ONE.shiftLeft(e-1),this);else{var n=new Array,o=7&e;n.length=1+(e>>3),t.nextBytes(n),o>0?n[0]&=(1<<o)-1:n[0]=0,this.fromString(n,256)}},r.prototype.bitwiseTo=function(e,t,r){var i,n,o=Math.min(e.t,this.t);for(i=0;i<o;++i)r[i]=t(this[i],e[i]);if(e.t<this.t){for(n=e.s&this.DM,i=o;i<this.t;++i)r[i]=t(this[i],n);r.t=this.t}else{for(n=this.s&this.DM,i=o;i<e.t;++i)r[i]=t(n,e[i]);r.t=e.t}r.s=t(this.s,e.s),r.clamp()},r.prototype.changeBit=function(e,t){var i=r.ONE.shiftLeft(e);return this.bitwiseTo(i,t,i),i},r.prototype.addTo=function(e,t){for(var r=0,i=0,n=Math.min(e.t,this.t);r<n;)i+=this[r]+e[r],t[r++]=i&this.DM,i>>=this.DB;if(e.t<this.t){for(i+=e.s;r<this.t;)i+=this[r],t[r++]=i&this.DM,i>>=this.DB;i+=this.s}else{for(i+=this.s;r<e.t;)i+=e[r],t[r++]=i&this.DM,i>>=this.DB;i+=e.s}t.s=i<0?-1:0,i>0?t[r++]=i:i<-1&&(t[r++]=this.DV+i),t.t=r,t.clamp()},r.prototype.dMultiply=function(e){this[this.t]=this.am(0,e-1,this,0,0,this.t),++this.t,this.clamp()},r.prototype.dAddOffset=function(e,t){if(0!=e){for(;this.t<=t;)this[this.t++]=0;for(this[t]+=e;this[t]>=this.DV;)this[t]-=this.DV,++t>=this.t&&(this[this.t++]=0),++this[t]}},r.prototype.multiplyLowerTo=function(e,t,r){var i,n=Math.min(this.t+e.t,t);for(r.s=0,r.t=n;n>0;)r[--n]=0;for(i=r.t-this.t;n<i;++n)r[n+this.t]=this.am(0,e[n],r,n,0,this.t);for(i=Math.min(e.t,t);n<i;++n)this.am(0,e[n],r,n,0,t-n);r.clamp()},r.prototype.multiplyUpperTo=function(e,t,r){--t;var i=r.t=this.t+e.t-t;for(r.s=0;--i>=0;)r[i]=0;for(i=Math.max(t-this.t,0);i<e.t;++i)r[this.t+i-t]=this.am(t-i,e[i],r,0,0,this.t+i-t);r.clamp(),r.drShiftTo(1,r)},r.prototype.modInt=function(e){if(e<=0)return 0;var t=this.DV%e,r=this.s<0?e-1:0;if(this.t>0)if(0==t)r=this[0]%e;else for(var i=this.t-1;i>=0;--i)r=(t*r+this[i])%e;return r},r.prototype.millerRabin=function(e){var t=this.subtract(r.ONE),n=t.getLowestSetBit();if(n<=0)return!1;var o=t.shiftRight(n);(e=e+1>>1)>S.length&&(e=S.length);for(var s=i(),a=0;a<e;++a){s.fromInt(S[Math.floor(Math.random()*S.length)]);var f=s.modPow(o,this);if(0!=f.compareTo(r.ONE)&&0!=f.compareTo(t)){for(var h=1;h++<n&&0!=f.compareTo(t);)if(0==(f=f.modPowInt(2,this)).compareTo(r.ONE))return!1;if(0!=f.compareTo(t))return!1}}return!0},r.prototype.clone=function(){var e=i();return this.copyTo(e),e},r.prototype.intValue=function(){if(this.s<0){if(1==this.t)return this[0]-this.DV;if(0==this.t)return-1}else{if(1==this.t)return this[0];if(0==this.t)return 0}return(this[1]&(1<<32-this.DB)-1)<<this.DB|this[0]},r.prototype.byteValue=function(){return 0==this.t?this.s:this[0]<<24>>24},r.prototype.shortValue=function(){return 0==this.t?this.s:this[0]<<16>>16},r.prototype.signum=function(){return this.s<0?-1:this.t<=0||1==this.t&&this[0]<=0?0:1},r.prototype.toByteArray=function(){var e=this.t,t=new Array;t[0]=this.s;var r,i=this.DB-e*this.DB%8,n=0;if(e-- >0)for(i<this.DB&&(r=this[e]>>i)!=(this.s&this.DM)>>i&&(t[n++]=r|this.s<<this.DB-i);e>=0;)i<8?(r=(this[e]&(1<<i)-1)<<8-i,r|=this[--e]>>(i+=this.DB-8)):(r=this[e]>>(i-=8)&255,i<=0&&(i+=this.DB,--e)),0!=(128&r)&&(r|=-256),0==n&&(128&this.s)!=(128&r)&&++n,(n>0||r!=this.s)&&(t[n++]=r);return t},r.prototype.equals=function(e){return 0==this.compareTo(e)},r.prototype.min=function(e){return this.compareTo(e)<0?this:e},r.prototype.max=function(e){return this.compareTo(e)>0?this:e},r.prototype.and=function(e){var t=i();return this.bitwiseTo(e,d,t),t},r.prototype.or=function(e){var t=i();return this.bitwiseTo(e,g,t),t},r.prototype.xor=function(e){var t=i();return this.bitwiseTo(e,E,t),t},r.prototype.andNot=function(e){var t=i();return this.bitwiseTo(e,v,t),t},r.prototype.not=function(){for(var e=i(),t=0;t<this.t;++t)e[t]=this.DM&~this[t];return e.t=this.t,e.s=~this.s,e},r.prototype.shiftLeft=function(e){var t=i();return e<0?this.rShiftTo(-e,t):this.lShiftTo(e,t),t},r.prototype.shiftRight=function(e){var t=i();return e<0?this.lShiftTo(-e,t):this.rShiftTo(e,t),t},r.prototype.getLowestSetBit=function(){for(var e=0;e<this.t;++e)if(0!=this[e])return e*this.DB+m(this[e]);return this.s<0?this.t*this.DB:-1},r.prototype.bitCount=function(){for(var e=0,t=this.s&this.DM,r=0;r<this.t;++r)e+=y(this[r]^t);return e},r.prototype.testBit=function(e){var t=Math.floor(e/this.DB);return t>=this.t?0!=this.s:0!=(this[t]&1<<e%this.DB)},r.prototype.setBit=function(e){return this.changeBit(e,g)},r.prototype.clearBit=function(e){return this.changeBit(e,v)},r.prototype.flipBit=function(e){return this.changeBit(e,E)},r.prototype.add=function(e){var t=i();return this.addTo(e,t),t},r.prototype.subtract=function(e){var t=i();return this.subTo(e,t),t},r.prototype.multiply=function(e){var t=i();return this.multiplyTo(e,t),t},r.prototype.divide=function(e){var t=i();return this.divRemTo(e,t,null),t},r.prototype.remainder=function(e){var t=i();return this.divRemTo(e,null,t),t},r.prototype.divideAndRemainder=function(e){var t=i(),r=i();return this.divRemTo(e,t,r),new Array(t,r)},r.prototype.modPow=function(e,t){var r,n,o=e.bitLength(),s=c(1);if(o<=0)return s;r=o<18?1:o<48?3:o<144?4:o<768?5:6,n=o<8?new l(t):t.isEven()?new b(t):new p(t);var a=new Array,f=3,h=r-1,d=(1<<r)-1;if(a[1]=n.convert(this),r>1){var g=i();for(n.sqrTo(a[1],g);f<=d;)a[f]=i(),n.mulTo(g,a[f-2],a[f]),f+=2}var E,v,m=e.t-1,y=!0,_=i();for(o=u(e[m])-1;m>=0;){for(o>=h?E=e[m]>>o-h&d:(E=(e[m]&(1<<o+1)-1)<<h-o,m>0&&(E|=e[m-1]>>this.DB+o-h)),f=r;0==(1&E);)E>>=1,--f;if((o-=f)<0&&(o+=this.DB,--m),y)a[E].copyTo(s),y=!1;else{for(;f>1;)n.sqrTo(s,_),n.sqrTo(_,s),f-=2;f>0?n.sqrTo(s,_):(v=s,s=_,_=v),n.mulTo(_,a[E],s)}for(;m>=0&&0==(e[m]&1<<o);)n.sqrTo(s,_),v=s,s=_,_=v,--o<0&&(o=this.DB-1,--m)}return n.revert(s)},r.prototype.modInverse=function(e){var t=e.isEven();if(this.isEven()&&t||0==e.signum())return r.ZERO;for(var i=e.clone(),n=this.clone(),o=c(1),s=c(0),a=c(0),f=c(1);0!=i.signum();){for(;i.isEven();)i.rShiftTo(1,i),t?(o.isEven()&&s.isEven()||(o.addTo(this,o),s.subTo(e,s)),o.rShiftTo(1,o)):s.isEven()||s.subTo(e,s),s.rShiftTo(1,s);for(;n.isEven();)n.rShiftTo(1,n),t?(a.isEven()&&f.isEven()||(a.addTo(this,a),f.subTo(e,f)),a.rShiftTo(1,a)):f.isEven()||f.subTo(e,f),f.rShiftTo(1,f);i.compareTo(n)>=0?(i.subTo(n,i),t&&o.subTo(a,o),s.subTo(f,s)):(n.subTo(i,n),t&&a.subTo(o,a),f.subTo(s,f))}return 0!=n.compareTo(r.ONE)?r.ZERO:f.compareTo(e)>=0?f.subtract(e):f.signum()<0?(f.addTo(e,f),f.signum()<0?f.add(e):f):f},r.prototype.pow=function(e){return this.exp(e,new _)},r.prototype.gcd=function(e){var t=this.s<0?this.negate():this.clone(),r=e.s<0?e.negate():e.clone();if(t.compareTo(r)<0){var i=t;t=r,r=i}var n=t.getLowestSetBit(),o=r.getLowestSetBit();if(o<0)return t;for(n<o&&(o=n),o>0&&(t.rShiftTo(o,t),r.rShiftTo(o,r));t.signum()>0;)(n=t.getLowestSetBit())>0&&t.rShiftTo(n,t),(n=r.getLowestSetBit())>0&&r.rShiftTo(n,r),t.compareTo(r)>=0?(t.subTo(r,t),t.rShiftTo(1,t)):(r.subTo(t,r),r.rShiftTo(1,r));return o>0&&r.lShiftTo(o,r),r},r.prototype.isProbablePrime=function(e){var t,r=this.abs();if(1==r.t&&r[0]<=S[S.length-1]){for(t=0;t<S.length;++t)if(r[0]==S[t])return!0;return!1}if(r.isEven())return!1;for(t=1;t<S.length;){for(var i=S[t],n=t+1;n<S.length&&i<A;)i*=S[n++];for(i=r.modInt(i);t<n;)if(i%S[t++]==0)return!1}return r.millerRabin(e)},r.prototype.square=function(){var e=i();return this.squareTo(e),e},r.prototype.Barrett=b,e.exports=r},function(e,t,r){var i=r(12),n=r(17),o=r(8).Transform,s=r(7).inherits,a=r(7).inspect,f=r(45),h=r(22).readUInt32BE,c=r(22).writeUInt32BE,u=r(27),l=r(21),p=l.iv_inc,d=l.readString,g=l.readInt,E=l.DSASigBERToBare,v=l.ECDSASigASN1ToSSH,m=l.sigSSHToASN1,y=r(30).pubDERToPEM,_=u.CIPHER_INFO,w=u.HMAC_INFO,b=u.MESSAGE,S=u.DYNAMIC_KEXDH_MESSAGE,A=u.KEXDH_MESSAGE,T=u.ALGORITHMS,U=u.DISCONNECT_REASON,B=u.CHANNEL_OPEN_FAILURE,k=u.SSH_TO_OPENSSL,N=u.TERMINAL_MODE,R=u.SIGNALS,O=u.BUGS,D=u.BUGGY_IMPLS,C=D.length,L=r(46).version,I=0,P=I++,H=I++,x=I++,M=I++,G=I++,K=I++,F=I++,q=I++,W=I++,X=I++,V=I++,Q=4294967295,Y=35e3,z=2,j=n.Z_PARTIAL_FLUSH,Z={flush:j},$=/-(.+)$/,J=/^gex-/,ee=/\x00/g,te=Buffer.from("SSH-"),re=Buffer.allocUnsafe(0),ie=Buffer.allocUnsafe(9),ne=Buffer.from([b.GLOBAL_REQUEST,0,0,0,21,107,101,101,112,97,108,105,118,101,64,111,112,101,110,115,115,104,46,99,111,109,1]),oe=Buffer.from([b.NEWKEYS]),se=Buffer.from([b.USERAUTH_SUCCESS]),ae=Buffer.from([b.REQUEST_SUCCESS]),fe=Buffer.from([b.REQUEST_FAILURE]),he=Buffer.from([N.TTY_OP_END]),ce=Buffer.from([b.KEXDH_GEX_REQUEST,0,0,4,0,0,0,16,0,0,0,32,0]);function ue(e){}function le(e){"object"==typeof e&&null!==e||(e={}),o.call(this,{highWaterMark:"number"==typeof e.highWaterMark?e.highWaterMark:32768}),this._needContinue=!1,this.bytesSent=this.bytesReceived=0,this.debug="function"==typeof e.debug?e.debug:ue,this.server=!0===e.server,this.maxPacketSize="number"==typeof e.maxPacketSize?e.maxPacketSize:Y,this.remoteBugs=0,this.server&&(this.remoteBugs=O.BAD_DHGEX),this.readable=!0;var t=this,r=e.hostKeys;if(this.server&&("object"!=typeof r||null===r))throw new Error("hostKeys must be an object keyed on host key type");if(this.config={hostKeys:r,ident:"SSH-2.0-"+(e.ident||"ssh2js"+L+(this.server?"srv":"")),algorithms:{kex:T.KEX,kexBuf:T.KEX_BUF,serverHostKey:T.SERVER_HOST_KEY,serverHostKeyBuf:T.SERVER_HOST_KEY_BUF,cipher:T.CIPHER,cipherBuf:T.CIPHER_BUF,hmac:T.HMAC,hmacBuf:T.HMAC_BUF,compress:T.COMPRESS,compressBuf:T.COMPRESS_BUF}},this.config.ident.replace(ee,""),this.config.ident.length+2>255)throw new Error("ident too long");if("object"==typeof e.algorithms&&null!==e.algorithms){var n=e.algorithms;Array.isArray(n.kex)&&n.kex.length>0&&(this.config.algorithms.kex=n.kex,Buffer.isBuffer(n.kexBuf)||(n.kexBuf=Buffer.from(n.kex.join(","),"ascii")),this.config.algorithms.kexBuf=n.kexBuf),Array.isArray(n.serverHostKey)&&n.serverHostKey.length>0&&(this.config.algorithms.serverHostKey=n.serverHostKey,Buffer.isBuffer(n.serverHostKeyBuf)||(n.serverHostKeyBuf=Buffer.from(n.serverHostKey.join(","),"ascii")),this.config.algorithms.serverHostKeyBuf=n.serverHostKeyBuf),Array.isArray(n.cipher)&&n.cipher.length>0&&(this.config.algorithms.cipher=n.cipher,Buffer.isBuffer(n.cipherBuf)||(n.cipherBuf=Buffer.from(n.cipher.join(","),"ascii")),this.config.algorithms.cipherBuf=n.cipherBuf),Array.isArray(n.hmac)&&n.hmac.length>0&&(this.config.algorithms.hmac=n.hmac,Buffer.isBuffer(n.hmacBuf)||(n.hmacBuf=Buffer.from(n.hmac.join(","),"ascii")),this.config.algorithms.hmacBuf=n.hmacBuf),Array.isArray(n.compress)&&n.compress.length>0&&(this.config.algorithms.compress=n.compress,Buffer.isBuffer(n.compressBuf)||(n.compressBuf=Buffer.from(n.compress.join(","),"ascii")),this.config.algorithms.compressBuf=n.compressBuf)}this.reset(!0),this.on("end",function(){t.readable=!1,t._state=void 0,t.reset(),t._state.outgoing.bufSeqno=void 0}),this.on("DISCONNECT",function(e,r,i,n){!function(e,t,r,i,n){if(r!==U.BY_APPLICATION){var o=new Error(i||t);o.code=r,e.emit("error",o)}e.reset()}(t,e,r,i)}),this.on("KEXINIT",function(e,r){!function(e,t,r){var n=e._state,o=n.outgoing;o.status===X?(e.debug("DEBUG: Received re-key request"),o.status=V,o.kexinit=void 0,_e(e,s)):s();function s(){if(!0===function(e,t,r){var n,o,s,a,f,h=e._state,c=h.incoming,u=h.outgoing,l=e.debug;l("DEBUG: Comparing KEXINITs ...");var p=e.config.algorithms,d=p.kex;if(e.remoteBugs&O.BAD_DHGEX)for(var g=!1,E=d.length-1;E>=0;--E)-1!==d[E].indexOf("group-exchange")&&(g||(d=d.slice(),g=!0),d.splice(E,1));l("DEBUG: (local) KEX algorithms: "+d),l("DEBUG: (remote) KEX algorithms: "+t.algorithms.kex),e.server?(n=d,o=t.algorithms.kex):(n=t.algorithms.kex,o=d);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching key exchange algorithm");var v=new Error("Handshake failed: no matching key exchange algorithm");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}var m=o[f];l("DEBUG: KEX algorithm: "+m),!r||t.algorithms.kex.length&&m===t.algorithms.kex[0]||(c.ignoreNext=!0);l("DEBUG: (local) Host key formats: "+p.serverHostKey),l("DEBUG: (remote) Host key formats: "+t.algorithms.srvHostKey),e.server?(n=p.serverHostKey,o=t.algorithms.srvHostKey):(n=t.algorithms.srvHostKey,o=p.serverHostKey);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching host key format");var v=new Error("Handshake failed: no matching host key format");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}h.hostkeyFormat=o[f],l("DEBUG: Host key format: "+h.hostkeyFormat),l("DEBUG: (local) Client->Server ciphers: "+p.cipher),l("DEBUG: (remote) Client->Server ciphers: "+t.algorithms.cs.encrypt),e.server?(n=p.cipher,o=t.algorithms.cs.encrypt):(n=t.algorithms.cs.encrypt,o=p.cipher);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Client->Server cipher");var v=new Error("Handshake failed: no matching client->server cipher");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?c.decrypt.type=o[f]:u.encrypt.type=o[f];l("DEBUG: Client->Server Cipher: "+s),l("DEBUG: (local) Server->Client ciphers: "+p.cipher),l("DEBUG: (remote) Server->Client ciphers: "+t.algorithms.sc.encrypt),e.server?(n=p.cipher,o=t.algorithms.sc.encrypt):(n=t.algorithms.sc.encrypt,o=p.cipher);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Server->Client cipher");var v=new Error("Handshake failed: no matching server->client cipher");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?u.encrypt.type=o[f]:c.decrypt.type=o[f];l("DEBUG: Server->Client Cipher: "+s),l("DEBUG: (local) Client->Server HMAC algorithms: "+p.hmac),l("DEBUG: (remote) Client->Server HMAC algorithms: "+t.algorithms.cs.mac),e.server?(n=p.hmac,o=t.algorithms.cs.mac):(n=t.algorithms.cs.mac,o=p.hmac);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Client->Server HMAC algorithm");var v=new Error("Handshake failed: no matching client->server HMAC");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?c.hmac.type=o[f]:u.hmac.type=o[f];l("DEBUG: Client->Server HMAC algorithm: "+s),l("DEBUG: (local) Server->Client HMAC algorithms: "+p.hmac),l("DEBUG: (remote) Server->Client HMAC algorithms: "+t.algorithms.sc.mac),e.server?(n=p.hmac,o=t.algorithms.sc.mac):(n=t.algorithms.sc.mac,o=p.hmac);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Server->Client HMAC algorithm");var v=new Error("Handshake failed: no matching server->client HMAC");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?u.hmac.type=o[f]:c.hmac.type=o[f];l("DEBUG: Server->Client HMAC algorithm: "+s),l("DEBUG: (local) Client->Server compression algorithms: "+p.compress),l("DEBUG: (remote) Client->Server compression algorithms: "+t.algorithms.cs.compress),e.server?(n=p.compress,o=t.algorithms.cs.compress):(n=t.algorithms.cs.compress,o=p.compress);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Client->Server compression algorithm");var v=new Error("Handshake failed: no matching client->server compression algorithm");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?c.decompress.type=o[f]:u.compress.type=o[f];l("DEBUG: Client->Server compression algorithm: "+s),l("DEBUG: (local) Server->Client compression algorithms: "+p.compress),l("DEBUG: (remote) Server->Client compression algorithms: "+t.algorithms.sc.compress),e.server?(n=p.compress,o=t.algorithms.sc.compress):(n=t.algorithms.sc.compress,o=p.compress);for(f=0,a=o.length;f<a&&-1===n.indexOf(o[f]);++f);if(f===a){l("DEBUG: No matching Server->Client compression algorithm");var v=new Error("Handshake failed: no matching server->client compression algorithm");return v.level="handshake",e.emit("error",v),e.disconnect(U.KEY_EXCHANGE_FAILED),!1}s=e.server?u.compress.type=o[f]:c.decompress.type=o[f];switch(l("DEBUG: Server->Client compression algorithm: "+s),m){case"diffie-hellman-group1-sha1":h.kexdh="group",h.kex=i.getDiffieHellman("modp2");break;case"diffie-hellman-group14-sha1":h.kexdh="group",h.kex=i.getDiffieHellman("modp14");break;case"ecdh-sha2-nistp256":h.kexdh="ec-sha256",h.kex=i.createECDH(k[m]);break;case"ecdh-sha2-nistp384":h.kexdh="ec-sha384",h.kex=i.createECDH(k[m]);break;case"ecdh-sha2-nistp521":h.kexdh="ec-sha512",h.kex=i.createECDH(k[m]);break;default:"diffie-hellman-group-exchange-sha1"===m?h.kexdh="gex-sha1":"diffie-hellman-group-exchange-sha256"===m&&(h.kexdh="gex-sha256"),h.kex=void 0}if(h.kex){u.pubkey=h.kex.generateKeys();var y=0;for(a=u.pubkey.length;0===u.pubkey[y];)++y,--a;if(128&u.pubkey[y]){var _=Buffer.allocUnsafe(a+1);_[0]=0,u.pubkey.copy(_,1,y),u.pubkey=_}}return!0}(e,t,r)){var o=J.test(n.kexdh);e.server?n.incoming.expectedPacket=o?"KEXDH_GEX_REQ":"KEXDH_INIT":o?function(e){e._state.incoming.expectedPacket="KEXDH_GEX_GROUP",e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_REQUEST"),be(e,ce,void 0,!0)}(e):we(e)}}}(t,e,r)}),this.on("NEWKEYS",function(){pe(t)}),this.server?this.on("KEXDH_INIT",function(e){!function(e,t){!function(e,t){var r=e._state,n=r.outgoing,o=r.incoming,s=e.config.hostKeys[r.hostkeyFormat];Array.isArray(s)&&(s=s[0]);for(var a=s.getPublicSSH(),f=s.type,h=-1,u=0,l=t.length;u<l&&0===t[u];++u)++h;h>-1&&(t=t.slice(h+1));var p,d=Ae(r.kex,t);if(d instanceof Error)return d.message="Error while computing DH secret ("+r.kexdh+"): "+d.message,d.level="handshake",e.emit("error",d),e.disconnect(U.KEY_EXCHANGE_FAILED),!1;p="group"===r.kexdh?"sha1":$.exec(r.kexdh)[1];var g=i.createHash(p),m=Buffer.byteLength(o.identRaw),y=Buffer.byteLength(e.config.ident),_=o.kexinit.length,w=n.kexinit.length,S=a.length,A=t.length,T=n.pubkey.length,B=d.length,k=0,N=0;for(;0===n.pubkey[k];)++k,--T;for(;0===d[N];)++N,--B;128&t[0]&&++A;128&n.pubkey[k]&&++T;128&d[N]&&++B;var R,O,D=m+y+_+w+S+A+T+B+32,C=J.test(r.kexdh),L=0,I=0,P=0,H=0;if(C){for(R=r.kex.getPrime(),O=r.kex.getGenerator(),L=R.length,I=O.length;0===R[P];)++P,--L;for(;0===O[H];)++H,--I;128&R[P]&&++L,128&O[H]&&++I,D+=12,D+=8,D+=L,D+=I}var x=0,M=Buffer.allocUnsafe(D);c(M,m,x),x+=4,M.write(o.identRaw,x,"utf8"),c(M,y,x+=m),x+=4,M.write(e.config.ident,x,"utf8"),c(M,_,x+=y),x+=4,o.kexinit.copy(M,x),x+=_,o.kexinit=void 0,c(M,w,x),x+=4,n.kexinit.copy(M,x),x+=w,n.kexinit=void 0,c(M,S,x),x+=4,a.copy(M,x),x+=S,C&&(ce.slice(1).copy(M,x),c(M,L,x+=12),x+=4,128&R[P]&&(M[x++]=0),R.copy(M,x,P),x+=L-(128&R[P]?1:0),c(M,I,x),x+=4,128&O[H]&&(M[x++]=0),O.copy(M,x,H),x+=I-(128&O[H]?1:0));c(M,A,x),x+=4,128&t[0]&&(M[x++]=0);t.copy(M,x),x+=A-(128&t[0]?1:0),c(M,T,x),x+=4,128&n.pubkey[k]&&(M[x++]=0);n.pubkey.copy(M,x,k),x+=T-(128&n.pubkey[k]?1:0),c(M,B,x),x+=4,128&d[N]&&(M[x++]=0);d.copy(M,x,N),n.exchangeHash=g.update(M).digest(),void 0===n.sessionId&&(n.sessionId=n.exchangeHash);n.kexsecret=d;var G=s.sign(n.exchangeHash);if(G instanceof Error)return G.message="Error while signing data with host key ("+f+"): "+G.message,G.level="handshake",e.emit("error",G),e.disconnect(U.KEY_EXCHANGE_FAILED),!1;"ssh-dss"===f?G=E(G):"ssh-rsa"!==f&&(G=v(G));if(!1===G)return G.message="Error while converting handshake signature",G.level="handshake",e.emit("error",G),e.disconnect(U.KEY_EXCHANGE_FAILED),!1;var K=4+f.length+4+G.length,F=Buffer.allocUnsafe(5+S+4+T+4+K);F[x=0]=C?b.KEXDH_GEX_REPLY:b.KEXDH_REPLY,c(F,S,++x),x+=4,a.copy(F,x),c(F,T,x+=S),x+=4,128&n.pubkey[k]&&(F[x++]=0);n.pubkey.copy(F,x,k),x+=T-(128&n.pubkey[k]?1:0),c(F,K,x),x+=4,c(F,f.length,x),x+=4,F.write(f,x,f.length,"ascii"),x+=f.length,c(F,G.length,x),x+=4,G.copy(F,x),r.incoming.expectedPacket="NEWKEYS",C?e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_REPLY"):"group"!==r.kexdh?e.debug("DEBUG: Outgoing: Writing KEXECDH_REPLY"):e.debug("DEBUG: Outgoing: Writing KEXDH_REPLY");be(e,F,void 0,!0),n.sentNEWKEYS=!0,e.debug("DEBUG: Outgoing: Writing NEWKEYS"),be(e,oe,void 0,!0)}(e,t)}(t,e)}):this.on("KEXDH_REPLY",function(e){!function e(t,r,n){var o=t._state;var s=o.incoming;var a=o.outgoing;var f=t.debug;var h;var u;if(void 0===n){s.expectedPacket="NEWKEYS",a.sentNEWKEYS=!1,f("DEBUG: Checking host key format");var l=d(r.hostkey,0,"ascii",t);if(!1===l)return!1;if(r.hostkey_format!==o.hostkeyFormat||r.hostkey_format!==l){f("DEBUG: Host key format mismatch"),t.disconnect(U.KEY_EXCHANGE_FAILED),t.reset();var p=new Error("Handshake failed: host key format mismatch");return p.level="handshake",t.emit("error",p),!1}f("DEBUG: Checking signature format");var g=d(r.sig,0,"ascii",t);if(!1===g)return!1;if(r.sig_format!==g){f("DEBUG: Signature format mismatch"),t.disconnect(U.KEY_EXCHANGE_FAILED),t.reset();var p=new Error("Handshake failed: signature format mismatch");return p.level="handshake",t.emit("error",p),!1}}if(a.status===W){if(void 0===n){f("DEBUG: Verifying host fingerprint");var E=!0,v=t.emit("fingerprint",r.hostkey,function(i){void 0===n&&(n=!!i,E||e(t,r,n))});if(E=!1,v&&void 0===n)return}if(void 0===n)f("DEBUG: Host accepted by default (no verification)");else{if(!0!==n){f("DEBUG: Host denied via fingerprint verification"),t.disconnect(U.KEY_EXCHANGE_FAILED),t.reset();var p=new Error("Handshake failed: host fingerprint verification failed");return p.level="handshake",t.emit("error",p),!1}f("DEBUG: Host accepted (verified)")}}var _=-1;for(u=0,h=r.pubkey.length;u<h&&0===r.pubkey[u];++u)++_;_>-1&&(r.pubkey=r.pubkey.slice(_+1));r.secret=Ae(o.kex,r.pubkey);if(r.secret instanceof Error)return r.secret.message="Error while computing DH secret ("+o.kexdh+"): "+r.secret.message,r.secret.level="handshake",t.emit("error",r.secret),t.disconnect(U.KEY_EXCHANGE_FAILED),!1;var w;w="group"===o.kexdh?"sha1":$.exec(o.kexdh)[1];var b=i.createHash(w);var S=Buffer.byteLength(t.config.ident);var A=Buffer.byteLength(s.identRaw);var T=a.kexinit.length;var B=s.kexinit.length;var k=r.hostkey.length;var N=a.pubkey.length;var R=r.pubkey.length;var O=r.secret.length;var D=0;var C=0;var L=0;for(;0===a.pubkey[D];)++D,--N;for(;0===r.pubkey[C];)++C,--R;for(;0===r.secret[L];)++L,--O;128&a.pubkey[D]&&++N;128&r.pubkey[C]&&++R;128&r.secret[L]&&++O;var I=S+A+T+B+k+N+R+O+32;var P=J.test(o.kexdh);var H=0;var x=0;var M=0;var G=0;var K;var F;if(P){for(K=o.kex.getPrime(),F=o.kex.getGenerator(),H=K.length,x=F.length;0===K[M];)++M,--H;for(;0===F[G];)++G,--x;128&K[M]&&++H,128&F[G]&&++x,I+=12,I+=8,I+=H,I+=x}var q=0;var X=Buffer.allocUnsafe(I);c(X,S,q);q+=4;X.write(t.config.ident,q,"utf8");q+=S;c(X,A,q);q+=4;X.write(s.identRaw,q,"utf8");q+=A;c(X,T,q);q+=4;a.kexinit.copy(X,q);q+=T;a.kexinit=void 0;c(X,B,q);q+=4;s.kexinit.copy(X,q);q+=B;s.kexinit=void 0;c(X,k,q);q+=4;r.hostkey.copy(X,q);q+=k;P&&(ce.slice(1).copy(X,q),c(X,H,q+=12),q+=4,128&K[M]&&(X[q++]=0),K.copy(X,q,M),q+=H-(128&K[M]?1:0),c(X,x,q),q+=4,128&F[G]&&(X[q++]=0),F.copy(X,q,G),q+=x-(128&F[G]?1:0));c(X,N,q);q+=4;128&a.pubkey[D]&&(X[q++]=0);a.pubkey.copy(X,q,D);q+=N-(128&a.pubkey[D]?1:0);c(X,R,q);q+=4;128&r.pubkey[C]&&(X[q++]=0);r.pubkey.copy(X,q,C);q+=R-(128&r.pubkey[C]?1:0);c(X,O,q);q+=4;128&r.secret[L]&&(X[q++]=0);r.secret.copy(X,q,L);a.exchangeHash=b.update(X).digest();var Q=d(r.sig,r.sig._pos,t);if(!1===Q||!(Q=m(Q,r.sig_format,t)))return!1;var Y;switch(r.sig_format){case"ssh-rsa":case"ssh-dss":Y="sha1";break;case"ecdsa-sha2-nistp256":Y="sha256";case"ecdsa-sha2-nistp384":void 0===Y&&(Y="sha384");case"ecdsa-sha2-nistp521":void 0===Y&&(Y="sha512");break;default:f("DEBUG: Signature format unsupported: "+r.sig_format),t.disconnect(U.KEY_EXCHANGE_FAILED),t.reset();var p=new Error("Handshake failed: signature format unsupported: "+r.sig_format);return p.level="handshake",t.emit("error",p),!1}var z=y(r.hostkey,r.sig_format);if("string"!=typeof z)return!1;f("DEBUG: Verifying signature");var j=i.createVerify(Y);j.update(a.exchangeHash);var Z=j.verify(z,Q);if(!Z){f("DEBUG: Signature verification failed"),t.disconnect(U.KEY_EXCHANGE_FAILED),t.reset();var p=new Error("Handshake failed: signature verification failed");return p.level="handshake",t.emit("error",p),!1}void 0===a.sessionId&&(a.sessionId=a.exchangeHash);a.kexsecret=r.secret;f("DEBUG: Outgoing: Writing NEWKEYS");a.status===V?be(t,oe,void 0,!0):be(t,oe);a.sentNEWKEYS=!0;void 0!==n&&void 0===s.expectedPacket&&pe(t)}(t,e)}).on("KEXDH_GEX_GROUP",function(e,r){!function(e,t,r){var n=e._state,o=n.outgoing;n.kex=i.createDiffieHellman(t,r),o.pubkey=n.kex.generateKeys();var s=0,a=o.pubkey.length;for(;0===o.pubkey[s];)++s,--a;if(128&o.pubkey[s]){var f=Buffer.allocUnsafe(a+1);f[0]=0,o.pubkey.copy(f,1,s),o.pubkey=f}we(e)}(t,e,r)}),this.server&&("string"==typeof e.greeting&&e.greeting.length&&("\r\n"===e.greeting.slice(-2)?this.push(e.greeting):this.push(e.greeting+"\r\n")),"string"==typeof e.banner&&e.banner.length&&("\r\n"===e.banner.slice(-2)?this.banner=e.banner:this.banner=e.banner+"\r\n")),this.debug("DEBUG: Local ident: "+a(this.config.ident)),this.push(this.config.ident+"\r\n"),this._state.incoming.expectedPacket="KEXINIT"}function pe(e){var t=e._state,r=t.outgoing,o=t.incoming;if(o.expectedPacket=void 0,r.sentNEWKEYS){for(var s=0,a=r.kexsecret.length;0===r.kexsecret[s];)++s,--a;var f,h=r.encrypt.info=_[r.encrypt.type],u=0;f="group"===t.kexdh?"sha1":$.exec(t.kexdh)[1];var l,p,d=(128&r.kexsecret[s]?1:0)+a,g=Buffer.allocUnsafe(4+d);if(t.authsQueue=[],c(g,d,u),u+=4,128&r.kexsecret[s]&&(g[u++]=0),r.kexsecret.copy(g,u,s),r.kexsecret=void 0,h.stream)l=re;else{for(l=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"B":"A","ascii").update(r.sessionId).digest();l.length<h.ivLen;)l=Buffer.concat([l,i.createHash(f).update(g).update(r.exchangeHash).update(l).digest()]);l.length>h.ivLen&&(l=l.slice(0,h.ivLen))}for(p=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"D":"C","ascii").update(r.sessionId).digest();p.length<h.keyLen;)p=Buffer.concat([p,i.createHash(f).update(g).update(r.exchangeHash).update(p).digest()]);if(p.length>h.keyLen&&(p=p.slice(0,h.keyLen)),h.authLen>0)r.encrypt.iv=l,r.encrypt.key=p,r.encrypt.instance=!0;else{var E=k[r.encrypt.type];r.encrypt.instance=i.createCipheriv(E,p,l),r.encrypt.instance.setAutoPadding(!1)}var v=o.decrypt.info=_[o.decrypt.type];if(v.stream)l=re;else{for(l=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"A":"B","ascii").update(r.sessionId).digest();l.length<v.ivLen;)l=Buffer.concat([l,i.createHash(f).update(g).update(r.exchangeHash).update(l).digest()]);l.length>v.ivLen&&(l=l.slice(0,v.ivLen))}for(o.decrypt.buf=Buffer.allocUnsafe(v.blockLen),p=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"C":"D","ascii").update(r.sessionId).digest();p.length<v.keyLen;)p=Buffer.concat([p,i.createHash(f).update(g).update(r.exchangeHash).update(p).digest()]);p.length>v.keyLen&&(p=p.slice(0,v.keyLen));var m,y=k[o.decrypt.type];o.decrypt.instance=i.createDecipheriv(y,p,l),o.decrypt.instance.setAutoPadding(!1),o.decrypt.iv=l,o.decrypt.key=p,h.discardLen>0&&(m=Buffer.alloc(h.discardLen),r.encrypt.instance.update(m)),v.discardLen>0&&(m&&m.length===v.discardLen||(m=Buffer.alloc(h.discardLen)),o.decrypt.instance.update(m));var b=r.hmac.info=w[r.hmac.type],S=o.hmac.info=w[o.hmac.type];if(0===h.authLen){for(p=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"F":"E","ascii").update(r.sessionId).digest();p.length<b.len;)p=Buffer.concat([p,i.createHash(f).update(g).update(r.exchangeHash).update(p).digest()]);p.length>b.len&&(p=p.slice(0,b.len)),r.hmac.key=p}else r.hmac.key=void 0;if(0===v.authLen){for(p=i.createHash(f).update(g).update(r.exchangeHash).update(e.server?"E":"F","ascii").update(r.sessionId).digest();p.length<S.len;)p=Buffer.concat([p,i.createHash(f).update(g).update(r.exchangeHash).update(p).digest()]);p.length>S.len&&(p=p.slice(0,S.len)),o.hmac.key=p}else o.hmac.key=void 0;var A=v.authLen||o.hmac.info.actualLen;if(o.hmac.buf&&o.hmac.buf.length===A||(o.hmac.buf=Buffer.allocUnsafe(A)),r.exchangeHash=void 0,"zlib"===r.compress.type?r.compress.instance=n.createDeflate(Z):"none"===r.compress.type&&(r.compress.instance=!1),"zlib"===o.decompress.type?o.decompress.instance=n.createInflate(Z):"none"===o.decompress.type&&(o.decompress.instance=!1),e.bytesSent=e.bytesReceived=0,r.status===V){r.status=X;var T=r.rekeyQueue,U=T.length,B=0;for(r.rekeyQueue=[];B<U;++B)Buffer.isBuffer(T[B])?be(e,T[B]):be(e,T[B][0],T[B][1]);U=(T=o.rekeyQueue).length,B=0,o.rekeyQueue=[];for(var N=o.seqno;B<U;++B){if(o.seqno=T[B][0],o.payload=T[B][1],!1===de(e))return;if(o.status===P)return}o.seqno=N}else r.status=X,o.status===G&&(e.debug("DEBUG: Parser: IN_PACKETBEFORE (update) (expecting "+v.blockLen+")"),me(e,z,v.blockLen,o.decrypt.buf)),e.emit("ready")}}function de(e,t){var r,i,o,s,a,f,u,l,p,E,v,y,_,w,T=e._state.incoming,k=e._state.outgoing,R=T.payload,D=T.seqno;if(++T.seqno>Q&&(T.seqno=0),T.ignoreNext)return e.debug("DEBUG: Parser: Packet ignored"),void(T.ignoreNext=!1);var C=R[0];if(void 0===C)return!1;if(k.status!==X&&b[C]!==T.expectedPacket&&C<1&&C>4){e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+T.expectedPacket+" but got: "+b[C]),e.disconnect(U.PROTOCOL_ERROR);var L=new Error("Received unexpected packet");return L.level="protocol",e.emit("error",L),!1}if(C===b.CHANNEL_DATA){if(!1===(a=g(R,1,e,t)))return!1;if(!1===(f=d(R,5,e,t,32768)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_DATA ("+a+")"),e.emit("CHANNEL_DATA:"+a,f)}else if(C===b.CHANNEL_EXTENDED_DATA){if(!1===(a=g(R,1,e,t)))return!1;var I=g(R,5,e,t);if(!1===I)return!1;if(!1===(f=d(R,9,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EXTENDED_DATA ("+a+")"),e.emit("CHANNEL_EXTENDED_DATA:"+a,I,f)}else if(C===b.CHANNEL_WINDOW_ADJUST){if(!1===(a=g(R,1,e,t)))return!1;var P=g(R,5,e,t);if(!1===P)return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_WINDOW_ADJUST ("+a+", "+P+")"),e.emit("CHANNEL_WINDOW_ADJUST:"+a,P)}else if(C===b.CHANNEL_SUCCESS){if(!1===(a=g(R,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_SUCCESS ("+a+")"),e.emit("CHANNEL_SUCCESS:"+a)}else if(C===b.CHANNEL_FAILURE){if(!1===(a=g(R,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_FAILURE ("+a+")"),e.emit("CHANNEL_FAILURE:"+a)}else if(C===b.CHANNEL_EOF){if(!1===(a=g(R,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_EOF ("+a+")"),e.emit("CHANNEL_EOF:"+a)}else if(C===b.CHANNEL_OPEN){var H,x=d(R,1,"ascii",e,t);if(!1===x)return!1;if(!1===(p=g(R,R._pos,e,t)))return!1;if(!1===(E=g(R,R._pos+=4,e,t)))return!1;if(!1===(v=g(R,R._pos+=4,e,t)))return!1;if(e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_OPEN ("+p+", "+x+")"),"forwarded-tcpip"===x||"direct-tcpip"===x){var M=d(R,R._pos+=4,"ascii",e,t);if(!1===M)return!1;var G=g(R,R._pos,e,t);if(!1===G)return!1;if(!1===(u=d(R,R._pos+=4,"ascii",e,t)))return!1;if(!1===(l=g(R,R._pos,e,t)))return!1;H={type:x,sender:p,window:E,packetSize:v,data:{destIP:M,destPort:G,srcIP:u,srcPort:l}}}else if("forwarded-streamlocal@openssh.com"===x||"direct-streamlocal@openssh.com"===x){if(!1===(w=d(R,R._pos+=4,"utf8",e,t)))return!1;H={type:x,sender:p,window:E,packetSize:v,data:{socketPath:w}}}else if("x11"===x){if(!1===(u=d(R,R._pos+=4,"ascii",e,t)))return!1;if(!1===(l=g(R,R._pos,e,t)))return!1;H={type:x,sender:p,window:E,packetSize:v,data:{srcIP:u,srcPort:l}}}else H={type:x,sender:p,window:E,packetSize:v,data:{}};e.emit("CHANNEL_OPEN",H)}else if(C===b.CHANNEL_OPEN_CONFIRMATION){if(!1===(y=g(R,1,e,t)))return!1;if(!1===(p=g(R,5,e,t)))return!1;if(!1===(E=g(R,9,e,t)))return!1;if(!1===(v=g(R,13,e,t)))return!1;s={recipient:y,sender:p,window:E,packetSize:v},R.length>17&&(s.data=R.slice(17)),e.emit("CHANNEL_OPEN_CONFIRMATION:"+s.recipient,s)}else if(C===b.CHANNEL_OPEN_FAILURE){if(!1===(y=g(R,1,e,t)))return!1;var K=g(R,5,e,t);if(!1===K)return!1;if(!1===(_=d(R,9,"utf8",e,t)))return!1;if(!1===(i=d(R,R._pos,"utf8",e,t)))return!1;R._pos=9,s={recipient:y,reasonCode:K,reason:B[K],description:_,lang:i},e.emit("CHANNEL_OPEN_FAILURE:"+s.recipient,s)}else if(C===b.CHANNEL_CLOSE){if(!1===(a=g(R,1,e,t)))return!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_CLOSE ("+a+")"),e.emit("CHANNEL_CLOSE:"+a)}else if(C===b.IGNORE);else if(C===b.DISCONNECT){var F=g(R,1,e,t);if(!1===F)return!1;var q=U[F];if(!1===(_=d(R,5,"utf8",e,t)))return!1;R._pos<R.length&&(i=d(R,R._pos,"ascii",e,t)),e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: DISCONNECT ("+q+")"),e.emit("DISCONNECT",q,F,_,i)}else if(C===b.DEBUG){if(!1===(o=d(R,2,"utf8",e,t)))return!1;if(!1===(i=d(R,R._pos,"ascii",e,t)))return!1;e.emit("DEBUG",o,i)}else if(C===b.NEWKEYS)e.emit("NEWKEYS");else if(C===b.SERVICE_REQUEST){if(!1===(r=d(R,1,"ascii",e,t)))return!1;e.emit("SERVICE_REQUEST",r)}else if(C===b.SERVICE_ACCEPT){if(!1===(r=d(R,1,"ascii",e,t)))return!1;e.emit("SERVICE_ACCEPT",r)}else if(C===b.USERAUTH_REQUEST){var W=d(R,1,"utf8",e,t);if(!1===W)return!1;var V=d(R,R._pos,"ascii",e,t);if(!1===V)return!1;var Y,z=d(R,R._pos,"ascii",e,t);if(!1===z)return!1;if("password"===z){if(!1===(Y=d(R,R._pos+1,"utf8",e,t)))return!1}else if("publickey"===z||"hostbased"===z){var j,$,ee,te,re,ie,ne;if("publickey"===z){if(void 0===(j=R[R._pos++]))return!1;j=0!==j}if(!1===($=d(R,R._pos,"ascii",e,t)))return!1;if(!1===(ee=d(R,R._pos,e,t)))return!1;if(j||"hostbased"===z){if("hostbased"===z){if(!1===(ie=d(R,R._pos,"ascii",e,t)))return!1;if(!1===(ne=d(R,R._pos,"utf8",e,t)))return!1}var oe=R._pos;if(!1===(te=d(R,oe,e,t)))return!1;if(te.length>4+$.length+4&&te.toString("ascii",4,4+$.length)===$&&(te=te.slice(4+$.length+4)),!1===(te=m(te,$,e,t)))return!1;re=Buffer.allocUnsafe(4+k.sessionId.length+oe),c(re,k.sessionId.length,0),k.sessionId.copy(re,4),R.copy(re,4+k.sessionId.length,0,oe)}Y={keyAlgo:$,key:ee,signature:te,blob:re,localHostname:ie,localUsername:ne}}else if("keyboard-interactive"===z){var se=g(R,R._pos,e,t);if(!1===se)return!1;if(!1===(Y=d(R,R._pos+4+se,"utf8",e,t)))return!1}else"none"!==z&&(Y=R.slice(R._pos));e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: USERAUTH_REQUEST ("+z+")"),e._state.authsQueue.push(z),e.emit("USERAUTH_REQUEST",W,V,z,Y)}else if(C===b.USERAUTH_SUCCESS)"zlib@openssh.com"===k.compress.type&&(k.compress.instance=n.createDeflate(Z)),"zlib@openssh.com"===T.decompress.type&&(T.decompress.instance=n.createInflate(Z)),e._state.authsQueue.shift(),e.emit("USERAUTH_SUCCESS");else if(C===b.USERAUTH_FAILURE){var ae=d(R,1,"ascii",e,t);if(!1===ae)return!1;var fe=R[R._pos];if(void 0===fe)return!1;fe=0!==fe,ae=ae.split(","),e._state.authsQueue.shift(),e.emit("USERAUTH_FAILURE",ae,fe)}else if(C===b.USERAUTH_BANNER){if(!1===(o=d(R,1,"utf8",e,t)))return!1;if(!1===(i=d(R,R._pos,"utf8",e,t)))return!1;e.emit("USERAUTH_BANNER",o,i)}else if(C===b.GLOBAL_REQUEST){var he=d(R,1,"ascii",e,t);if(!1===he)return e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST"),!1;e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: GLOBAL_REQUEST ("+he+")");var ce,ue=R[R._pos++];if(void 0===ue)return!1;if(ue=0!==ue,"tcpip-forward"===he||"cancel-tcpip-forward"===he){var le=d(R,R._pos,"ascii",e,t);if(!1===le)return!1;var pe=g(R,R._pos,e,t);if(!1===pe)return!1;ce={bindAddr:le,bindPort:pe}}else if("streamlocal-forward@openssh.com"===he||"cancel-streamlocal-forward@openssh.com"===he){if(!1===(w=d(R,R._pos,"utf8",e,t)))return!1;ce={socketPath:w}}else"no-more-sessions@openssh.com"===he||(ce=R.slice(R._pos));e.emit("GLOBAL_REQUEST",he,ue,ce)}else if(C===b.REQUEST_SUCCESS)R.length>1?e.emit("REQUEST_SUCCESS",R.slice(1)):e.emit("REQUEST_SUCCESS");else if(C===b.REQUEST_FAILURE)e.emit("REQUEST_FAILURE");else if(C===b.UNIMPLEMENTED);else{if(C===b.KEXINIT)return function(e,t){var r,i=e._state.incoming,n=i.payload,o={algorithms:{kex:void 0,srvHostKey:void 0,cs:{encrypt:void 0,mac:void 0,compress:void 0},sc:{encrypt:void 0,mac:void 0,compress:void 0}},languages:{cs:void 0,sc:void 0}};if(!1===(r=ye(n,17,e,t)))return!1;if(o.algorithms.kex=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.srvHostKey=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.cs.encrypt=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.sc.encrypt=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.cs.mac=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.sc.mac=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.cs.compress=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.algorithms.sc.compress=r,!1===(r=ye(n,n._pos,e,t)))return!1;if(o.languages.cs=r,!1===(r=ye(n,n._pos,e,t)))return!1;o.languages.sc=r;var s=n._pos<n.length&&1===n[n._pos];i.kexinit=n,e.emit("KEXINIT",o,s)}(e,t);if(C===b.CHANNEL_REQUEST)return function(e,t){var r,i,n,o,s,a,f,c=e._state.incoming.payload,u=g(c,1,e,t);if(!1===u)return!1;var l=d(c,5,"ascii",e,t);if(!1===l)return!1;if("exit-status"===l){var p=g(c,++c._pos,e,t);if(!1===p)return!1;r={recipient:u,request:l,wantReply:!1,code:p}}else if("exit-signal"===l){var E;if(e.remoteBugs&O.OLD_EXIT){if(!1===(f=g(c,++c._pos,e,t)))return!1;switch(f){case 1:f="HUP";break;case 2:f="INT";break;case 3:f="QUIT";break;case 6:f="ABRT";break;case 9:f="KILL";break;case 14:f="ALRM";break;case 15:f="TERM";break;default:f="UNKNOWN ("+f+")"}E=!1}else{if(!1===(f=d(c,++c._pos,"ascii",e,t)))return!1;if(void 0===(E=c[c._pos++]))return!1;E=0!==E}var v=d(c,c._pos,"utf8",e,t);if(!1===v)return!1;var m=d(c,c._pos,"utf8",e,t);if(!1===m)return!1;r={recipient:u,request:l,wantReply:!1,signal:f,coredump:E,description:v,lang:m}}else if("pty-req"===l){if(void 0===(a=c[c._pos++]))return!1;a=0!==a;var y=d(c,c._pos,"ascii",e,t);if(!1===y)return!1;if(!1===(i=g(c,c._pos,e,t)))return!1;if(!1===(n=g(c,c._pos+=4,e,t)))return!1;if(!1===(o=g(c,c._pos+=4,e,t)))return!1;if(!1===(s=g(c,c._pos+=4,e,t)))return!1;var _=d(c,c._pos+=4,e,t);if(!1===_)return!1;_=function(e){for(var t,r={},i=0,n=e.length;i<n&&!((t=e[i])===N.TTY_OP_END||void 0===N[t]||i+5>n);i+=5)r[N[t]]=h(e,i+1);return r}(_),r={recipient:u,request:l,wantReply:a,term:y,cols:i,rows:n,width:o,height:s,modes:_}}else if("window-change"===l){if(!1===(i=g(c,++c._pos,e,t)))return!1;if(!1===(n=g(c,c._pos+=4,e,t)))return!1;if(!1===(o=g(c,c._pos+=4,e,t)))return!1;if(!1===(s=g(c,c._pos+=4,e,t)))return!1;r={recipient:u,request:l,wantReply:!1,cols:i,rows:n,width:o,height:s}}else if("x11-req"===l){if(void 0===(a=c[c._pos++]))return!1;a=0!==a;var w=c[c._pos++];if(void 0===w)return!1;w=0!==w;var b=d(c,c._pos,"ascii",e,t);if(!1===b)return!1;var S=d(c,c._pos,"binary",e,t);if(!1===S)return!1;var A=g(c,c._pos,e,t);if(!1===A)return!1;r={recipient:u,request:l,wantReply:a,single:w,protocol:b,cookie:S,screen:A}}else if("env"===l){if(void 0===(a=c[c._pos++]))return!1;a=0!==a;var T=d(c,c._pos,"utf8",e,t);if(!1===T)return!1;var U=d(c,c._pos,"utf8",e,t);if(!1===U)return!1;r={recipient:u,request:l,wantReply:a,key:T,val:U}}else if("shell"===l){if(void 0===(a=c[c._pos]))return!1;r={recipient:u,request:l,wantReply:a=0!==a}}else if("exec"===l){if(void 0===(a=c[c._pos++]))return!1;a=0!==a;var B=d(c,c._pos,"utf8",e,t);if(!1===B)return!1;r={recipient:u,request:l,wantReply:a,command:B}}else if("subsystem"===l){if(void 0===(a=c[c._pos++]))return!1;a=0!==a;var k=d(c,c._pos,"utf8",e,t);if(!1===k)return!1;r={recipient:u,request:l,wantReply:a,subsystem:k}}else if("signal"===l){if(!1===(f=d(c,++c._pos,"ascii",e,t)))return!1;r={recipient:u,request:l,wantReply:!1,signal:"SIG"+f}}else if("xon-xoff"===l){var R=c[++c._pos];if(void 0===R)return!1;r={recipient:u,request:l,wantReply:!1,clientControl:R=0!==R}}else if("auth-agent-req@openssh.com"===l){if(void 0===(a=c[c._pos]))return!1;r={recipient:u,request:l,wantReply:a=0!==a}}else{if(void 0===(a=c[c._pos]))return!1;r={recipient:u,request:l,wantReply:a=0!==a}}e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, packet: CHANNEL_REQUEST ("+u+", "+l+")"),e.emit("CHANNEL_REQUEST:"+u,r)}(e,t);if(C>=30&&C<=49)return function(e,t,r){var i=e._state,n=i.incoming,o=n.payload,s=J.test(i.kexdh)?S[t]:A[t];if(i.outgoing.status===X||n.expectedPacket!==s){e.debug("DEBUG: Parser: IN_PACKETDATAAFTER, expected: "+n.expectedPacket+" but got: "+s),e.disconnect(U.PROTOCOL_ERROR);var a=new Error("Received unexpected packet");return a.level="protocol",e.emit("error",a),!1}if(J.test(i.kexdh)){if(e.server){e.disconnect(U.PROTOCOL_ERROR);var a=new Error("DH group exchange not supported by server");return a.level="handshake",e.emit("error",a),!1}if(t===b.KEXDH_GEX_GROUP){var f=d(o,1,e,r);if(!1===f)return!1;var h=d(o,o._pos,e,r);if(!1===h)return!1;e.emit("KEXDH_GEX_GROUP",f,h)}else if(t===b.KEXDH_GEX_REPLY)return ge(e,r)}else if(t===b.KEXDH_INIT){var c=d(o,1,e,r);if(!1===c)return!1;e.emit("KEXDH_INIT",c)}else if(t===b.KEXDH_REPLY)return ge(e,r)}(e,C,t);if(C>=60&&C<=70)return function(e,t,r){var i,n,o,s=e._state,a=s.authsQueue[0],f=s.incoming.payload;if("password"===a){if(t===b.USERAUTH_PASSWD_CHANGEREQ){if(!1===(i=d(f,1,"utf8",e,r)))return!1;if(!1===(n=d(f,f._pos,"utf8",e,r)))return!1;e.emit("USERAUTH_PASSWD_CHANGEREQ",i,n)}}else if("keyboard-interactive"===a){if(t===b.USERAUTH_INFO_REQUEST){var h,c,u;if(!1===(h=d(f,1,"utf8",e,r)))return!1;if(!1===(c=d(f,f._pos,"utf8",e,r)))return!1;if(!1===(n=d(f,f._pos,"utf8",e,r)))return!1;if(!1===(u=g(f,f._pos,e,r)))return!1;f._pos+=4;for(var l=[],p=0;p<u;++p){if(!1===(o=d(f,f._pos,"utf8",e,r)))return!1;var E=f[f._pos++];if(void 0===E)return!1;E=0!==E,l.push({prompt:o,echo:E})}e.emit("USERAUTH_INFO_REQUEST",h,c,n,l)}else if(t===b.USERAUTH_INFO_RESPONSE){var v=g(f,1,e,r);if(!1===v)return!1;f._pos=5;for(var m=[],y=0;y<v;++y){if(!1===(o=d(f,f._pos,"utf8",e,r)))return!1;m.push(o)}e.emit("USERAUTH_INFO_RESPONSE",m)}}else if("publickey"===a){if(t===b.USERAUTH_PK_OK){var _=e._state.authsQueue;if(!_.length||"publickey"!==_[0])return;_.shift(),e.emit("USERAUTH_PK_OK")}}else if(void 0!==a){e.disconnect(U.PROTOCOL_ERROR);var w=new Error("Invalid authentication method: "+a);w.level="protocol",e.emit("error",w)}}(e,C,t);var de=Buffer.allocUnsafe(5);de[0]=b.UNIMPLEMENTED,c(de,D,1),be(e,de)}}function ge(e,t){var r=e._state.incoming.payload,i=d(r,1,e,t);if(!1===i)return!1;var n=d(r,r._pos,e,t);if(!1===n)return!1;var o=d(r,r._pos,e,t);if(!1===o)return!1;var s={hostkey:i,hostkey_format:void 0,pubkey:n,sig:o,sig_format:void 0},a=d(i,0,"ascii",e,t);if(!1===a)return!1;s.hostkey_format=a;var f=d(o,0,"ascii",e,t);if(!1===f)return!1;s.sig_format=f,e.emit("KEXDH_REPLY",s)}function Ee(e,t){var r=e._state.incoming,n=r.hmac;if(e.debug("DEBUG: Parser: Verifying MAC"),r.decrypt.info.authLen>0){var o=r.decrypt,s=o.instance;s.setAuthTag(t);var a=s.update(r.packet);return r.payload=a.slice(1,r.packet.length+4-a[0]),p(o.iv),o.instance=i.createDecipheriv(k[o.type],o.key,o.iv),o.instance.setAutoPadding(!1),!0}var f=i.createHmac(k[n.type],n.key);c(ie,r.seqno,0),c(ie,r.pktLen,4),ie[8]=r.padLen,f.update(ie),f.update(r.packet);var h=f.digest();return h.length>r.hmac.info.actualLen&&(h=h.slice(0,r.hmac.info.actualLen)),Te(h,t)}function ve(e,t){var r=e._state.incoming.decrypt.instance;return e.debug("DEBUG: Parser: Decrypting"),r.update(t)}function me(e,t,r,i){var n=e._state.incoming.expect;n.amount=r,n.type=t,n.ptr=0,i?n.buf=i:r&&(n.buf=Buffer.allocUnsafe(r))}function ye(e,t,r,i){var n=d(e,t,"ascii",r,i);return!1!==n&&(n.length?n.split(","):[])}function _e(e,t){return function(e,t){i.randomBytes(e,function r(n,o){if(n)return i.randomBytes(e,r);t&&t(o)})}(16,function(r){var i=e.config.algorithms,n=i.kexBuf;if(e.remoteBugs&O.BAD_DHGEX){for(var o=!1,s=i.kex,a=s.length-1;a>=0;--a)-1!==s[a].indexOf("group-exchange")&&(o||(s=s.slice(),o=!0),s.splice(a,1));o&&(n=Buffer.from(s.join(",")))}var f=i.serverHostKeyBuf,h=21+n.length+4+f.length+2*(4+i.cipherBuf.length)+2*(4+i.hmacBuf.length)+2*(4+i.compressBuf.length)+8+1+4,u=Buffer.allocUnsafe(h),l=17;u[0]=b.KEXINIT,!1!==r&&r.copy(u,1),c(u,n.length,l),l+=4,n.copy(u,l),l+=n.length,c(u,f.length,l),l+=4,f.copy(u,l),l+=f.length,c(u,i.cipherBuf.length,l),l+=4,i.cipherBuf.copy(u,l),l+=i.cipherBuf.length,c(u,i.cipherBuf.length,l),l+=4,i.cipherBuf.copy(u,l),l+=i.cipherBuf.length,c(u,i.hmacBuf.length,l),l+=4,i.hmacBuf.copy(u,l),l+=i.hmacBuf.length,c(u,i.hmacBuf.length,l),l+=4,i.hmacBuf.copy(u,l),l+=i.hmacBuf.length,c(u,i.compressBuf.length,l),l+=4,i.compressBuf.copy(u,l),l+=i.compressBuf.length,c(u,i.compressBuf.length,l),l+=4,i.compressBuf.copy(u,l),l+=i.compressBuf.length,u.fill(0,u.length-13),e.debug("DEBUG: Outgoing: Writing KEXINIT"),e._state.incoming.expectedPacket="KEXINIT";var p=e._state.outgoing;p.kexinit=u,p.status===X&&(p.status=V),be(e,u,t,!0)}),!0}function we(e){var t=e._state,r=t.outgoing,i=Buffer.allocUnsafe(5+r.pubkey.length);return J.test(t.kexdh)?(t.incoming.expectedPacket="KEXDH_GEX_REPLY",i[0]=b.KEXDH_GEX_INIT,e.debug("DEBUG: Outgoing: Writing KEXDH_GEX_INIT")):(t.incoming.expectedPacket="KEXDH_REPLY",i[0]=b.KEXDH_INIT,"group"!==t.kexdh?e.debug("DEBUG: Outgoing: Writing KEXECDH_INIT"):e.debug("DEBUG: Outgoing: Writing KEXDH_INIT")),c(i,r.pubkey.length,1),r.pubkey.copy(i,5),be(e,i,void 0,!0)}function be(e,t,r,i){var n=e._state;if(!n)return!1;var o=n.outgoing;if(o.status===V&&!i)return"function"==typeof r?o.rekeyQueue.push([t,r]):o.rekeyQueue.push(t),!1;if(e._readableState.ended||e._writableState.ended)return!1;var s=o.compress.instance;return s?(s.write(t),s.flush(j,function(){e._readableState.ended||e._writableState.ended||Se(e,s.read(),r)}),!0):Se(e,t,r)}function Se(e,t,r){var n,o,s,a,f,h=e._state.outgoing,u=h.encrypt,l=h.hmac;if(n=t.length+9,!1!==u.instance)if(u.info.authLen>0){for(var d=1+t.length+4;d%u.info.blockLen!=0;)++d;o=d-1-t.length,n=4+d}else{var g=u.info.blockLen;o=(n+=(g-1)*n%g)-t.length-5}else o=(n+=7*n%8)-t.length-5;s=Buffer.allocUnsafe(n),c(s,n-4,0),s[4]=o,t.copy(s,5),i.randomBytes(o).copy(s,5+t.length),!1!==l.type&&l.key&&(a=i.createHmac(k[l.type],l.key),c(h.bufSeqno,h.seqno,0),a.update(h.bufSeqno),a.update(s),(a=a.digest()).length>l.info.actualLen&&(a=a.slice(0,l.info.actualLen)));var E,v=0;if(!1!==u.instance)if(u.info.authLen>0){var m=i.createCipheriv(k[u.type],u.key,u.iv);m.setAutoPadding(!1);var y=s.slice(0,4);m.setAAD(y),e.push(y),v+=y,E=m.update(s.slice(4)),e.push(E),v+=E.length;var _=m.final();_.length&&(e.push(_),v+=_.length);var w=m.getAuthTag();f=e.push(w),v+=w.length,p(u.iv)}else E=u.instance.update(s),e.push(E),v+=E.length,f=e.push(a),v+=a.length;else f=e.push(s),v=s.length;return e.bytesSent+=v,++h.seqno>Q&&(h.seqno=0),r&&r(),f}function Ae(e,t){try{return e.computeSecret(t)}catch(e){return e}}s(le,o),le.prototype.__read=o.prototype._read,le.prototype._read=function(e){return this._needContinue&&(this._needContinue=!1,this.emit("continue")),this.__read(e)},le.prototype.__push=o.prototype.push,le.prototype.push=function(e,t){var r=this.__push(e,t);return this._needContinue=!1===r,r},le.prototype._cleanup=function(e){this.reset(),this.debug("DEBUG: Parser: Malformed packet"),e&&e(new Error("Malformed packet"))},le.prototype._transform=function(e,t,r,i){var n,o,s,h,c=!1,u=!1,l=this._state,p=l.incoming,d=l.outgoing,E=p.expect,v=p.decrypt,m=p.decompress,y=e.length,_=0,w=this.debug,S=this,A=0,T=A;for(this.bytesReceived+=y;;){if(void 0!==E.type){if(A>=y)break;if(E.type===z){_=y-A;var B=E.buf.length-E.ptr;B<=_?(e.copy(E.buf,E.ptr,A,A+B),A+=B,o=E.buf,E.buf=void 0,E.ptr=0,E.type=void 0):(e.copy(E.buf,E.ptr,A),E.ptr+=_,A+=_);continue}if(0===E.type){if(A+=p.search.push(e),void 0!==E.type)continue}else if(1===E.type){if(++E.ptr+4>255)return this.reset(),w("DEBUG: Parser: Identification string exceeded 255 characters"),r(new Error("Max identification string size exceeded"));if(10!==e[A]){++A===y&&T<A&&(void 0===E.buf?E.buf=e.toString("ascii",T,A):E.buf+=e.toString("ascii",T,A));continue}E.type=void 0,T<A&&(void 0===E.buf?E.buf=e.toString("ascii",T,A):E.buf+=e.toString("ascii",T,A)),o=E.buf,E.buf=void 0,++A}}if(p.status===P){if(!this.readable)return r();if(this.server)if(o){if(83!==o[0]||83!==o[1]||72!==o[2]||45!==o[3])return this.reset(),w("DEBUG: Parser: Bad identification start"),r(new Error("Bad identification start"));p.status=H,w("DEBUG: Parser: IN_INIT (waiting for rest of identification)")}else w("DEBUG: Parser: IN_INIT (waiting for identification begin)"),me(this,z,4);else{w("DEBUG: Parser: IN_INIT");var k=p.search=new f(te);k.on("info",function e(t,r,i,n){r&&(void 0===p.greeting?p.greeting=r.toString("binary",i,n):p.greeting+=r.toString("binary",i,n)),t&&(E.type=void 0,p.search.removeListener("info",e))}),k.maxMatches=1,me(this,0),p.status=H}}else if(p.status===H)w("DEBUG: Parser: IN_GREETING"),p.search=void 0,T=A,me(this,1),p.status=x;else{if(p.status===x){w("DEBUG: Parser: IN_HEADER"),13===o.charCodeAt(o.length-1)&&(o=o.slice(0,-1));var N=o.indexOf("-"),R=o.indexOf(" "),O={greeting:p.greeting,identRaw:"SSH-"+o,versions:{protocol:o.substr(0,N),software:-1===R?o.substring(N+1):o.substring(N+1,R)},comments:R>-1?o.substring(R+1):void 0};if(p.greeting=void 0,"1.99"!==O.versions.protocol&&"2.0"!==O.versions.protocol)return this.reset(),w("DEBUG: Parser: protocol version not supported: "+O.versions.protocol),r(new Error("Protocol version not supported"));if(this.emit("header",O),p.status===P)return;var L=O.identRaw,I=O.versions.software;this.debug("DEBUG: Remote ident: "+a(L));for(var W,Y=0;Y<C;++Y)"string"==typeof(W=D[Y])[0]?I===W[0]&&(this.remoteBugs|=W[1]):W[0].test(I)&&(this.remoteBugs|=W[1]);return p.identRaw=L,this.bytesReceived-=y-A,_e(this,function(){A===y?r():S._transform(e.slice(A),t,r)}),void(p.status=M)}if(p.status===M)w("DEBUG: Parser: IN_PACKETBEFORE (expecting "+(n=v.instance?v.info.blockLen:8)+")"),me(this,z,n,v.buf),p.status=G;else if(p.status===G){if(w("DEBUG: Parser: IN_PACKET"),v.instance?((u=v.info.authLen>0)||(o=ve(this,o)),n=v.info.blockLen):(u=!1,n=8),!1===(h=g(o,0,this,r)))return;var Z,$=p.hmac.info,J=h+4+(Z=$?$.actualLen:0),ee=this.maxPacketSize;if(m.instance&&(ee+=5*(this.maxPacketSize/16384+1)+6),h>ee||J<16+Z||(h+(u?0:4))%n!=0)return this.disconnect(U.PROTOCOL_ERROR),w("DEBUG: Parser: Bad packet length ("+J+")"),r(new Error("Bad packet length"));p.pktLen=h;var ie=p.pktLen+4-n;if(u?(v.instance.setAAD(o.slice(0,4)),w("DEBUG: Parser: pktLen:"+p.pktLen+",remainLen:"+ie)):(p.padLen=o[4],w("DEBUG: Parser: pktLen:"+p.pktLen+",padLen:"+p.padLen+",remainLen:"+ie)),ie>0)p.pktExtra=u?o.slice(4):o.slice(5),me(this,z,ie),p.status=K;else{if(!(ie<0)){c=!0,p.status=K;continue}p.status=M}}else if(p.status===K){w("DEBUG: Parser: IN_PACKETDATA"),v.instance?(u=v.info.authLen>0,c?c=!1:u||(o=ve(this,o))):(u=!1,c=!1);var ne=p.pktLen-p.padLen-1;if(p.pktExtra?(s=Buffer.allocUnsafe(p.pktExtra.length+o.length),p.pktExtra.copy(s),o.copy(s,p.pktExtra.length),p.payload=s.slice(0,ne)):(s=u?o.slice(4):o.slice(5),p.payload=o.slice(5,5+ne)),void 0!==p.hmac.info){var oe=v.info.authLen||p.hmac.info.actualLen;w("DEBUG: Parser: HMAC size:"+oe),me(this,z,oe,p.hmac.buf),p.status=F,p.packet=s}else p.status=q;p.pktExtra=void 0,s=void 0}else if(p.status===F){if(w("DEBUG: Parser: IN_PACKETDATAVERIFY"),!Ee(this,o))return this.reset(),w("DEBUG: Parser: IN_PACKETDATAVERIFY (Invalid HMAC)"),r(new Error("Invalid HMAC"));w("DEBUG: Parser: IN_PACKETDATAVERIFY (Valid HMAC)"),p.status=q,p.packet=void 0}else if(p.status===q){if(m.instance){if(!i){w("DEBUG: Parser: Decompressing"),m.instance.write(p.payload);var se=[],ae=0;return void m.instance.on("readable",function(){for(var e;e=this.read();)se.push(e),ae+=e.length}).flush(j,function(){var i;m.instance.removeAllListeners("readable"),1===se.length?p.payload=se[0]:p.payload=Buffer.concat(se,ae),se=null,i=A===y?re:e.slice(A),S._transform(i,t,r,!0)})}i=!1}this.emit("packet");var fe=p.payload[0];if(w!==ue){var he="DEBUG: Parser: IN_PACKETDATAAFTER, packet: ",ce=l.kexdh,le=l.authsQueue[0],pe=null;d.status!==V||fe<=4||fe>=20&&fe<=49||(he+="(enqueued) "),fe===b.KEXDH_INIT?pe="group"===ce?"KEXDH_INIT":"e"===ce[0]?"KEXECDH_INIT":"KEXDH_GEX_REQUEST":fe===b.KEXDH_REPLY?pe="group"===ce?"KEXDH_REPLY":"e"===ce[0]?"KEXECDH_REPLY":"KEXDH_GEX_GROUP":fe===b.KEXDH_GEX_GROUP?pe="KEXDH_GEX_GROUP":fe===b.KEXDH_GEX_REPLY?pe="KEXDH_GEX_REPLY":60===fe?pe="password"===le?"USERAUTH_PASSWD_CHANGEREQ":"keyboard-interactive"===le?"USERAUTH_INFO_REQUEST":"publickey"===le?"USERAUTH_PK_OK":"UNKNOWN PACKET 60":61===fe&&(pe="keyboard-interactive"===le?"USERAUTH_INFO_RESPONSE":"UNKNOWN PACKET 61"),null===pe&&(pe=b[fe]),fe!==b.CHANNEL_OPEN&&fe!==b.CHANNEL_REQUEST&&fe!==b.CHANNEL_SUCCESS&&fe!==b.CHANNEL_FAILURE&&fe!==b.CHANNEL_EOF&&fe!==b.CHANNEL_CLOSE&&fe!==b.CHANNEL_DATA&&fe!==b.CHANNEL_EXTENDED_DATA&&fe!==b.CHANNEL_WINDOW_ADJUST&&fe!==b.DISCONNECT&&fe!==b.USERAUTH_REQUEST&&fe!==b.GLOBAL_REQUEST&&w(he+pe)}if(d.status===X||fe<=4||fe>=20&&fe<=49){if(!1===de(this,r))return;if(p.status===P)return}else if(d.status===V){if(50===p.rekeyQueue.length)return w("DEBUG: Parser: Max incoming re-key queue length reached"),this.disconnect(U.PROTOCOL_ERROR),r(new Error("Incoming re-key queue length limit reached"));var ge=p.seqno;++p.seqno>Q&&(p.seqno=0),p.rekeyQueue.push(ge,p.payload)}p.status=M,p.payload=void 0}}void 0!==o&&(o=void 0)}r()},le.prototype.reset=function(e){if(this._state){var t=this._state;t.incoming.status=P,t.outgoing.status=W}else this._state={authsQueue:[],hostkeyFormat:void 0,kex:void 0,kexdh:void 0,incoming:{status:P,expectedPacket:void 0,search:void 0,greeting:void 0,seqno:0,pktLen:void 0,padLen:void 0,pktExtra:void 0,payload:void 0,packet:void 0,kexinit:void 0,identRaw:void 0,rekeyQueue:[],ignoreNext:!1,expect:{amount:void 0,type:void 0,ptr:0,buf:void 0},decrypt:{instance:!1,info:void 0,iv:void 0,key:void 0,buf:void 0,type:void 0},hmac:{info:void 0,key:void 0,buf:void 0,type:!1},decompress:{instance:!1,type:!1}},outgoing:{status:W,seqno:0,bufSeqno:Buffer.allocUnsafe(4),rekeyQueue:[],kexinit:void 0,kexsecret:void 0,pubkey:void 0,exchangeHash:void 0,sessionId:void 0,sentNEWKEYS:!1,encrypt:{instance:!1,info:void 0,iv:void 0,key:void 0,type:void 0},hmac:{info:void 0,key:void 0,buf:void 0,type:!1},compress:{instance:!1,type:!1}}};e||this.readable&&this.push(null)},le.prototype.disconnect=function(e){var t=Buffer.alloc(13);return t[0]=b.DISCONNECT,void 0===U[e]&&(e=U.BY_APPLICATION),c(t,e,1),this.debug("DEBUG: Outgoing: Writing DISCONNECT ("+U[e]+")"),be(this,t),this.reset(),!1},le.prototype.ping=function(){return this.debug("DEBUG: Outgoing: Writing ping (GLOBAL_REQUEST: keepalive@openssh.com)"),be(this,ne)},le.prototype.rekey=function(){var e=this._state.outgoing.status;if(e===V)throw new Error("A re-key is already in progress");if(e!==X)throw new Error("Cannot re-key yet");return this.debug("DEBUG: Outgoing: Starting re-key"),_e(this)},le.prototype.requestSuccess=function(e){var t;return Buffer.isBuffer(e)?((t=Buffer.allocUnsafe(1+e.length))[0]=b.REQUEST_SUCCESS,e.copy(t,1)):t=ae,this.debug("DEBUG: Outgoing: Writing REQUEST_SUCCESS"),be(this,t)},le.prototype.requestFailure=function(){return this.debug("DEBUG: Outgoing: Writing REQUEST_FAILURE"),be(this,fe)},le.prototype.channelSuccess=function(e){var t=Buffer.allocUnsafe(5);return t[0]=b.CHANNEL_SUCCESS,c(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_SUCCESS ("+e+")"),be(this,t)},le.prototype.channelFailure=function(e){var t=Buffer.allocUnsafe(5);return t[0]=b.CHANNEL_FAILURE,c(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_FAILURE ("+e+")"),be(this,t)},le.prototype.channelEOF=function(e){var t=Buffer.allocUnsafe(5);return t[0]=b.CHANNEL_EOF,c(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_EOF ("+e+")"),be(this,t)},le.prototype.channelClose=function(e){var t=Buffer.allocUnsafe(5);return t[0]=b.CHANNEL_CLOSE,c(t,e,1),this.debug("DEBUG: Outgoing: Writing CHANNEL_CLOSE ("+e+")"),be(this,t)},le.prototype.channelWindowAdjust=function(e,t){var r=Buffer.allocUnsafe(9);return r[0]=b.CHANNEL_WINDOW_ADJUST,c(r,e,1),c(r,t,5),this.debug("DEBUG: Outgoing: Writing CHANNEL_WINDOW_ADJUST ("+e+", "+t+")"),be(this,r)},le.prototype.channelData=function(e,t){var r=Buffer.isBuffer(t),i=r?t.length:Buffer.byteLength(t),n=Buffer.allocUnsafe(9+i);return n[0]=b.CHANNEL_DATA,c(n,e,1),c(n,i,5),r?t.copy(n,9):n.write(t,9,i,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_DATA ("+e+")"),be(this,n)},le.prototype.channelExtData=function(e,t,r){var i=Buffer.isBuffer(t),n=i?t.length:Buffer.byteLength(t),o=Buffer.allocUnsafe(13+n);return o[0]=b.CHANNEL_EXTENDED_DATA,c(o,e,1),c(o,r,5),c(o,n,9),i?t.copy(o,13):o.write(t,13,n,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_EXTENDED_DATA ("+e+")"),be(this,o)},le.prototype.channelOpenConfirm=function(e,t,r,i){var n=Buffer.allocUnsafe(17);return n[0]=b.CHANNEL_OPEN_CONFIRMATION,c(n,e,1),c(n,t,5),c(n,r,9),c(n,i,13),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_CONFIRMATION (r:"+e+", l:"+t+")"),be(this,n)},le.prototype.channelOpenFail=function(e,t,r,i){"string"!=typeof r&&(r=""),"string"!=typeof i&&(i="");var n=Buffer.byteLength(r),o=Buffer.byteLength(i),s=9,a=Buffer.allocUnsafe(13+n+4+o);return a[0]=b.CHANNEL_OPEN_FAILURE,c(a,e,1),c(a,t,5),c(a,n,s),s+=4,n&&(a.write(r,s,n,"utf8"),s+=n),c(a,o,s),o&&a.write(i,s+=4,o,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN_FAILURE ("+e+")"),be(this,a)},le.prototype.service=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=Buffer.allocUnsafe(5+t);return r[0]=b.SERVICE_REQUEST,c(r,t,1),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_REQUEST ("+e+")"),be(this,r)},le.prototype.tcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(e),n=Buffer.allocUnsafe(23+i+4);return n[0]=b.GLOBAL_REQUEST,c(n,13,1),n.write("tcpip-forward",5,13,"ascii"),n[18]=void 0===r||!0===r?1:0,c(n,i,19),n.write(e,23,i,"ascii"),c(n,t,23+i),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (tcpip-forward)"),be(this,n)},le.prototype.cancelTcpipForward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(e),n=Buffer.allocUnsafe(30+i+4);return n[0]=b.GLOBAL_REQUEST,c(n,20,1),n.write("cancel-tcpip-forward",5,20,"ascii"),n[25]=void 0===r||!0===r?1:0,c(n,i,26),n.write(e,30,i,"ascii"),c(n,t,30+i),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-tcpip-forward)"),be(this,n)},le.prototype.openssh_streamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=Buffer.allocUnsafe(41+r);return i[0]=b.GLOBAL_REQUEST,c(i,31,1),i.write("streamlocal-forward@openssh.com",5,31,"ascii"),i[36]=void 0===t||!0===t?1:0,c(i,r,37),i.write(e,41,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (streamlocal-forward@openssh.com)"),be(this,i)},le.prototype.openssh_cancelStreamLocalForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=Buffer.allocUnsafe(48+r);return i[0]=b.GLOBAL_REQUEST,c(i,38,1),i.write("cancel-streamlocal-forward@openssh.com",5,38,"ascii"),i[43]=void 0===t||!0===t?1:0,c(i,r,44),i.write(e,48,r,"utf8"),this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (cancel-streamlocal-forward@openssh.com)"),be(this,i)},le.prototype.directTcpip=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(i.srcIP),o=Buffer.byteLength(i.dstIP),s=29,a=Buffer.allocUnsafe(33+n+4+4+o+4);return a[0]=b.CHANNEL_OPEN,c(a,12,1),a.write("direct-tcpip",5,12,"ascii"),c(a,e,17),c(a,t,21),c(a,r,25),c(a,o,s),a.write(i.dstIP,s+=4,o,"ascii"),c(a,i.dstPort,s+=o),c(a,n,s+=4),a.write(i.srcIP,s+=4,n,"ascii"),c(a,i.srcPort,s+=n),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-tcpip)"),be(this,a)},le.prototype.openssh_directStreamLocal=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(i.socketPath),o=47,s=Buffer.allocUnsafe(51+n+4+4);return s[0]=b.CHANNEL_OPEN,c(s,30,1),s.write("direct-streamlocal@openssh.com",5,30,"ascii"),c(s,e,35),c(s,t,39),c(s,r,43),c(s,n,o),s.write(i.socketPath,o+=4,n,"utf8"),s.fill(0,s.length-8),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", direct-streamlocal@openssh.com)"),be(this,s)},le.prototype.openssh_noMoreSessions=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.allocUnsafe(34);return t[0]=b.GLOBAL_REQUEST,c(t,28,1),t.write("no-more-sessions@openssh.com",5,28,"ascii"),t[33]=void 0===e||!0===e?1:0,this.debug("DEBUG: Outgoing: Writing GLOBAL_REQUEST (no-more-sessions@openssh.com)"),be(this,t)},le.prototype.session=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.allocUnsafe(24);return i[0]=b.CHANNEL_OPEN,c(i,7,1),i.write("session",5,7,"ascii"),c(i,e,12),c(i,t,16),c(i,r,20),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", session)"),be(this,i)},le.prototype.windowChange=function(e,t,r,i,n){if(this.server)throw new Error("Client-only method called in server mode");var o=Buffer.allocUnsafe(39);return o[0]=b.CHANNEL_REQUEST,c(o,e,1),c(o,13,5),o.write("window-change",9,13,"ascii"),o[22]=0,c(o,r,23),c(o,t,27),c(o,n,31),c(o,i,35),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", window-change)"),be(this,o)},le.prototype.pty=function(e,t,r,i,n,o,s,a){if(this.server)throw new Error("Client-only method called in server mode");o&&o.length||(o="vt100"),!s||Buffer.isBuffer(s)||Array.isArray(s)||"object"!=typeof s||(s=function(e){for(var t,r,i,n=/^\d+$/,o=Object.keys(e),s=0,a=[],f=0,h=o.length;f<h;++f)t=o[f],(r=N[t])&&!n.test(t)&&"number"==typeof e[t]&&"TTY_OP_END"!==t&&(i=e[t],a[s++]=r,a[s++]=i>>>24&255,a[s++]=i>>>16&255,a[s++]=i>>>8&255,a[s++]=255&i);return a[s]=N.TTY_OP_END,a}(s)),s&&s.length||(s=he);var f=o.length,h=s.length,u=21,l=Buffer.allocUnsafe(21+f+4+4+4+4+4+h);if(l[0]=b.CHANNEL_REQUEST,c(l,e,1),c(l,7,5),l.write("pty-req",9,7,"ascii"),l[16]=void 0===a||!0===a?1:0,c(l,f,17),l.write(o,21,f,"utf8"),c(l,r,u+=f),c(l,t,u+=4),c(l,n,u+=4),c(l,i,u+=4),c(l,h,u+=4),u+=4,Array.isArray(s))for(var p=0;p<h;++p)l[u++]=s[p];else Buffer.isBuffer(s)&&s.copy(l,u);return this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", pty-req)"),be(this,l)},le.prototype.shell=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.allocUnsafe(15);return r[0]=b.CHANNEL_REQUEST,c(r,e,1),c(r,5,5),r.write("shell",9,5,"ascii"),r[14]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", shell)"),be(this,r)},le.prototype.exec=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.isBuffer(t)?t.length:Buffer.byteLength(t),n=Buffer.allocUnsafe(18+i);return n[0]=b.CHANNEL_REQUEST,c(n,e,1),c(n,4,5),n.write("exec",9,4,"ascii"),n[13]=void 0===r||!0===r?1:0,c(n,i,14),Buffer.isBuffer(t)?t.copy(n,18):n.write(t,18,i,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exec)"),be(this,n)},le.prototype.signal=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");if("SIG"===(t=t.toUpperCase()).slice(0,3)&&(t=t.substring(3)),-1===R.indexOf(t))throw new Error("Invalid signal: "+t);var r=t.length,i=Buffer.allocUnsafe(20+r);return i[0]=b.CHANNEL_REQUEST,c(i,e,1),c(i,6,5),i.write("signal",9,6,"ascii"),i[15]=0,c(i,r,16),i.write(t,20,r,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", signal)"),be(this,i)},le.prototype.env=function(e,t,r,i){if(this.server)throw new Error("Client-only method called in server mode");var n=Buffer.byteLength(t),o=Buffer.isBuffer(r)?r.length:Buffer.byteLength(r),s=Buffer.allocUnsafe(17+n+4+o);return s[0]=b.CHANNEL_REQUEST,c(s,e,1),c(s,3,5),s.write("env",9,3,"ascii"),s[12]=void 0===i||!0===i?1:0,c(s,n,13),s.write(t,17,n,"ascii"),c(s,o,17+n),Buffer.isBuffer(r)?r.copy(s,17+n+4):s.write(r,17+n+4,o,"utf8"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", env)"),be(this,s)},le.prototype.x11Forward=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(t.protocol),n=Buffer.byteLength(t.cookie),o=Buffer.allocUnsafe(22+i+4+n+4);o[0]=b.CHANNEL_REQUEST,c(o,e,1),c(o,7,5),o.write("x11-req",9,7,"ascii"),o[16]=void 0===r||!0===r?1:0,o[17]=t.single?1:0,c(o,i,18);var s=22;return Buffer.isBuffer(t.protocol)?t.protocol.copy(o,s):o.write(t.protocol,s,i,"utf8"),c(o,n,s+=i),s+=4,Buffer.isBuffer(t.cookie)?t.cookie.copy(o,s):o.write(t.cookie,s,n,"binary"),s+=n,c(o,t.screen||0,s),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", x11-req)"),be(this,o)},le.prototype.subsystem=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i=Buffer.byteLength(t),n=Buffer.allocUnsafe(23+i);return n[0]=b.CHANNEL_REQUEST,c(n,e,1),c(n,9,5),n.write("subsystem",9,9,"ascii"),n[18]=void 0===r||!0===r?1:0,c(n,i,19),n.write(t,23,i,"ascii"),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", subsystem: "+t+")"),be(this,n)},le.prototype.openssh_agentForward=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.allocUnsafe(36);return r[0]=b.CHANNEL_REQUEST,c(r,e,1),c(r,26,5),r.write("auth-agent-req@openssh.com",9,26,"ascii"),r[35]=void 0===t||!0===t?1:0,this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", auth-agent-req@openssh.com)"),be(this,r)},le.prototype.authPassword=function(e,t){if(this.server)throw new Error("Client-only method called in server mode");var r=Buffer.byteLength(e),i=Buffer.byteLength(t),n=0,o=Buffer.allocUnsafe(5+r+4+14+4+8+1+4+i);return o[n]=b.USERAUTH_REQUEST,c(o,r,++n),o.write(e,n+=4,r,"utf8"),c(o,14,n+=r),o.write("ssh-connection",n+=4,14,"ascii"),c(o,8,n+=14),o.write("password",n+=4,8,"ascii"),o[n+=8]=0,c(o,i,++n),o.write(t,n+=4,i,"utf8"),this._state.authsQueue.push("password"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (password)"),be(this,o)},le.prototype.authPK=function(e,t,r){if(this.server)throw new Error("Client-only method called in server mode");var i,n=this,o=this._state.outgoing;"function"==typeof t.getPublicSSH?(i=t.type,t=t.getPublicSSH()):i=t.toString("ascii",4,4+h(t,0));var s=Buffer.byteLength(e),a=Buffer.byteLength(i),f=t.length,u=o.sessionId.length,l=0,p=Buffer.allocUnsafe((r?4+u:0)+1+4+s+4+14+4+9+1+4+a+4+f);return r?(c(p,u,l),o.sessionId.copy(p,l+=4),p[l+=u]=b.USERAUTH_REQUEST):p[l]=b.USERAUTH_REQUEST,c(p,s,++l),p.write(e,l+=4,s,"utf8"),c(p,14,l+=s),p.write("ssh-connection",l+=4,14,"ascii"),c(p,9,l+=14),p.write("publickey",l+=4,9,"ascii"),p[l+=9]=r?1:0,c(p,a,++l),p.write(i,l+=4,a,"ascii"),c(p,f,l+=a),t.copy(p,l+=4),r?(r(p,function(r){switch(i){case"ssh-dss":r=E(r);break;case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":r=v(r)}if(!1===r)throw new Error("Error while converting handshake signature");var o=r.length,h=Buffer.allocUnsafe(5+s+4+14+4+9+1+4+a+4+f+4+4+a+4+o);return h[l=0]=b.USERAUTH_REQUEST,c(h,s,++l),h.write(e,l+=4,s,"utf8"),c(h,14,l+=s),h.write("ssh-connection",l+=4,14,"ascii"),c(h,9,l+=14),h.write("publickey",l+=4,9,"ascii"),h[l+=9]=1,c(h,a,++l),h.write(i,l+=4,a,"ascii"),c(h,f,l+=a),t.copy(h,l+=4),c(h,4+a+4+o,l+=f),c(h,a,l+=4),h.write(i,l+=4,a,"ascii"),c(h,o,l+=a),r.copy(h,l+=4),n._state.authsQueue.push("publickey"),n.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey)"),be(n,h)}),!0):(this._state.authsQueue.push("publickey"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (publickey -- check)"),be(this,p))},le.prototype.authHostbased=function(e,t,r,i,n){if(this.server)throw new Error("Client-only method called in server mode");var o,s=this,a=this._state.outgoing;"function"==typeof t.getPublicSSH?(o=t.type,t=t.getPublicSSH()):o=t.toString("ascii",4,4+h(t,0));var f=Buffer.byteLength(e),u=Buffer.byteLength(o),l=t.length,p=a.sessionId.length,d=Buffer.byteLength(r),g=Buffer.byteLength(i),m=0,y=Buffer.allocUnsafe(4+p+1+4+f+4+14+4+9+4+u+4+l+4+d+4+g);return c(y,p,m),a.sessionId.copy(y,m+=4),y[m+=p]=b.USERAUTH_REQUEST,c(y,f,++m),y.write(e,m+=4,f,"utf8"),c(y,14,m+=f),y.write("ssh-connection",m+=4,14,"ascii"),c(y,9,m+=14),y.write("hostbased",m+=4,9,"ascii"),c(y,u,m+=9),y.write(o,m+=4,u,"ascii"),c(y,l,m+=u),t.copy(y,m+=4),c(y,d,m+=l),y.write(r,m+=4,d,"ascii"),c(y,g,m+=d),y.write(i,m+=4,g,"utf8"),n(y,function(e){switch(o){case"ssh-dss":e=E(e);break;case"ecdsa-sha2-nistp256":case"ecdsa-sha2-nistp384":case"ecdsa-sha2-nistp521":e=v(e)}if(!1===e)throw new Error("Error while converting handshake signature");var t=e.length,r=Buffer.allocUnsafe(y.length-p+t);return y.copy(r,0,4+p),c(r,t,r.length-t-4),e.copy(r,r.length-t),s._state.authsQueue.push("hostbased"),s.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (hostbased)"),be(s,r)}),!0},le.prototype.authKeyboard=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,i=Buffer.allocUnsafe(5+t+4+14+4+20+4+4);return i[r]=b.USERAUTH_REQUEST,c(i,t,++r),i.write(e,r+=4,t,"utf8"),c(i,14,r+=t),i.write("ssh-connection",r+=4,14,"ascii"),c(i,20,r+=14),i.write("keyboard-interactive",r+=4,20,"ascii"),c(i,0,r+=20),c(i,0,r+=4),this._state.authsQueue.push("keyboard-interactive"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (keyboard-interactive)"),be(this,i)},le.prototype.authNone=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t=Buffer.byteLength(e),r=0,i=Buffer.allocUnsafe(5+t+4+14+4+4);return i[r]=b.USERAUTH_REQUEST,c(i,t,++r),i.write(e,r+=4,t,"utf8"),c(i,14,r+=t),i.write("ssh-connection",r+=4,14,"ascii"),c(i,4,r+=14),i.write("none",r+=4,4,"ascii"),this._state.authsQueue.push("none"),this.debug("DEBUG: Outgoing: Writing USERAUTH_REQUEST (none)"),be(this,i)},le.prototype.authInfoRes=function(e){if(this.server)throw new Error("Client-only method called in server mode");var t,r,i,n=0,o=0;if(e)for(i=0,r=e.length;i<r;++i)n+=4+Buffer.byteLength(e[i]);var s=Buffer.allocUnsafe(5+n);if(s[o++]=b.USERAUTH_INFO_RESPONSE,c(s,e?e.length:0,o),e)for(o+=4,i=0,r=e.length;i<r;++i)t=Buffer.byteLength(e[i]),c(s,t,o),o+=4,t&&(s.write(e[i],o,t,"utf8"),o+=t);return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_RESPONSE"),be(this,s)},le.prototype.serviceAccept=function(e){if(!this.server)throw new Error("Server-only method called in client mode");var t=e.length,r=Buffer.allocUnsafe(5+t);if(r[0]=b.SERVICE_ACCEPT,c(r,t,1),r.write(e,5,t,"ascii"),this.debug("DEBUG: Outgoing: Writing SERVICE_ACCEPT ("+e+")"),be(this,r),this.server&&this.banner&&"ssh-userauth"===e){var i=Buffer.byteLength(this.banner),n=5+i+4,o=Buffer.allocUnsafe(n);o[0]=b.USERAUTH_BANNER,c(o,i,1),o.write(this.banner,5,i,"utf8"),o.fill(0,n-4),this.debug("DEBUG: Outgoing: Writing USERAUTH_BANNER"),be(this,o),this.banner=void 0}},le.prototype.forwardedTcpip=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.boundAddr),o=Buffer.byteLength(i.remoteAddr),s=36+n,a=Buffer.allocUnsafe(36+n+4+4+o+4);return a[0]=b.CHANNEL_OPEN,c(a,15,1),a.write("forwarded-tcpip",5,15,"ascii"),c(a,e,20),c(a,t,24),c(a,r,28),c(a,n,32),a.write(i.boundAddr,36,n,"ascii"),c(a,i.boundPort,s),c(a,o,s+=4),a.write(i.remoteAddr,s+=4,o,"ascii"),c(a,i.remotePort,s+=o),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-tcpip)"),be(this,a)},le.prototype.x11=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.originAddr),o=24+n,s=Buffer.allocUnsafe(24+n+4);return s[0]=b.CHANNEL_OPEN,c(s,3,1),s.write("x11",5,3,"ascii"),c(s,e,8),c(s,t,12),c(s,r,16),c(s,n,20),s.write(i.originAddr,24,n,"ascii"),c(s,i.originPort,o),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", x11)"),be(this,s)},le.prototype.openssh_forwardedStreamLocal=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(i.socketPath),o=Buffer.allocUnsafe(54+n+4);return o[0]=b.CHANNEL_OPEN,c(o,33,1),o.write("forwarded-streamlocal@openssh.com",5,33,"ascii"),c(o,e,38),c(o,t,42),c(o,r,46),c(o,n,50),o.write(i.socketPath,54,n,"utf8"),c(o,0,54+n),this.debug("DEBUG: Outgoing: Writing CHANNEL_OPEN ("+e+", forwarded-streamlocal@openssh.com)"),be(this,o)},le.prototype.exitStatus=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=Buffer.allocUnsafe(25);return r[0]=b.CHANNEL_REQUEST,c(r,e,1),c(r,11,5),r.write("exit-status",9,11,"ascii"),r[20]=0,c(r,t,21),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-status)"),be(this,r)},le.prototype.exitSignal=function(e,t,r,i){if(!this.server)throw new Error("Server-only method called in client mode");var n=Buffer.byteLength(t),o=i?Buffer.byteLength(i):0,s=25+n,a=Buffer.allocUnsafe(25+n+1+4+o+4);return a[0]=b.CHANNEL_REQUEST,c(a,e,1),c(a,11,5),a.write("exit-signal",9,11,"ascii"),a[20]=0,c(a,n,21),a.write(t,25,n,"utf8"),a[s++]=r?1:0,c(a,o,s),s+=4,o&&(a.write(i,s,o,"utf8"),s+=o),c(a,0,s),this.debug("DEBUG: Outgoing: Writing CHANNEL_REQUEST ("+e+", exit-signal)"),be(this,a)},le.prototype.authFailure=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r;if(!this._state.authsQueue.length)throw new Error("No auth in progress");if("boolean"==typeof e&&(t=e,e=void 0),e){r=[];for(var i=0,n=e.length;i<n;++i)"none"!==e[i].toLowerCase()&&r.push(e[i]);r=r.join(",")}else r="";var o=r.length,s=Buffer.allocUnsafe(5+o+1);return s[0]=b.USERAUTH_FAILURE,c(s,o,1),s.write(r,5,o,"ascii"),s[5+o]=!0===t?1:0,this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_FAILURE"),be(this,s)},le.prototype.authSuccess=function(){if(!this.server)throw new Error("Server-only method called in client mode");if(!this._state.authsQueue.length)throw new Error("No auth in progress");return this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_SUCCESS"),be(this,se)},le.prototype.authPKOK=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=this._state.authsQueue;if(!r.length||"publickey"!==r[0])throw new Error('"publickey" auth not in progress');var i=e.length,n=t.length,o=Buffer.allocUnsafe(5+i+4+n);return o[0]=b.USERAUTH_PK_OK,c(o,i,1),o.write(e,5,i,"ascii"),c(o,n,5+i),t.copy(o,5+i+4),this._state.authsQueue.shift(),this.debug("DEBUG: Outgoing: Writing USERAUTH_PK_OK"),be(this,o)},le.prototype.authPasswdChg=function(e,t){if(!this.server)throw new Error("Server-only method called in client mode");var r=Buffer.byteLength(e),i=t?t.length:0,n=0,o=Buffer.allocUnsafe(5+r+4+i);return o[n]=b.USERAUTH_PASSWD_CHANGEREQ,c(o,r,++n),o.write(e,n+=4,r,"utf8"),c(o,i,n+=r),i&&o.write(t,n+=4,i,"ascii"),this.debug("DEBUG: Outgoing: Writing USERAUTH_PASSWD_CHANGEREQ"),be(this,o)},le.prototype.authInfoReq=function(e,t,r){if(!this.server)throw new Error("Server-only method called in client mode");var i,n,o,s,a=0,f=e?Buffer.byteLength(e):0,h=t?Buffer.byteLength(t):0,u=0;for(s=0,o=r.length;s<o;++s)a+=4+Buffer.byteLength(r[s].prompt)+1;var l=Buffer.allocUnsafe(5+f+4+h+4+4+a);for(l[u++]=b.USERAUTH_INFO_REQUEST,c(l,f,u),u+=4,e&&(l.write(e,u,f,"utf8"),u+=f),c(l,h,u),u+=4,t&&(l.write(t,u,h,"utf8"),u+=h),c(l,0,u),u+=4,c(l,r.length,u),u+=4,s=0,o=r.length;s<o;++s)n=r[s],i=Buffer.byteLength(n.prompt),c(l,i,u),u+=4,i&&(l.write(n.prompt,u,i,"utf8"),u+=i),l[u++]=n.echo?1:0;return this.debug("DEBUG: Outgoing: Writing USERAUTH_INFO_REQUEST"),be(this,l)};var Te="function"==typeof i.timingSafeEqual?function(e,t){return e.length!==t.length?(i.timingSafeEqual(e,e),!1):i.timingSafeEqual(e,t)}:function(e,t){var r;e.length===t.length?r=0:(r=1,t=e);for(var i=0,n=e.length;i<n;++i)r|=e[i]^t[i];return 0===r};e.exports=le,e.exports._send=be},function(e,t,r){var i=r(9).EventEmitter;function n(e,t,r,i,n){for(var o=0;o<n;++o,++t,++i)if(e[t]!==r[i])return!1;return!0}function o(e){"string"==typeof e&&(e=new Buffer(e));var t,r,i=e.length;for(this.maxMatches=1/0,this.matches=0,this._occ=new Array(256),this._lookbehind_size=0,this._needle=e,this._bufpos=0,this._lookbehind=new Buffer(i),r=0;r<256;++r)this._occ[r]=i;if(i>=1)for(t=0;t<i-1;++t)this._occ[e[t]]=i-1-t}(0,r(7).inherits)(o,i),o.prototype.reset=function(){this._lookbehind_size=0,this.matches=0,this._bufpos=0},o.prototype.push=function(e,t){var r,i;for(Buffer.isBuffer(e)||(e=new Buffer(e,"binary")),i=e.length,this._bufpos=t||0;r!==i&&this.matches<this.maxMatches;)r=this._sbmh_feed(e);return r},o.prototype._sbmh_feed=function(e){var t=e.length,r=this._needle,i=r.length,o=-this._lookbehind_size,s=r[i-1],a=this._occ,f=this._lookbehind;if(o<0){for(;o<0&&o<=t-i;){if((c=this._sbmh_lookup_char(e,o+i-1))===s&&this._sbmh_memcmp(e,o,i-1))return this._lookbehind_size=0,++this.matches,o>-this._lookbehind_size?this.emit("info",!0,f,0,this._lookbehind_size+o):this.emit("info",!0),this._bufpos=o+i,o+i;o+=a[c]}if(o<0)for(;o<0&&!this._sbmh_memcmp(e,o,t-o);)o++;if(!(o>=0)){var h=this._lookbehind_size+o;return h>0&&this.emit("info",!1,f,0,h),f.copy(f,0,h,this._lookbehind_size-h),this._lookbehind_size-=h,e.copy(f,this._lookbehind_size),this._lookbehind_size+=t,this._bufpos=t,t}this.emit("info",!1,f,0,this._lookbehind_size),this._lookbehind_size=0}for(o>=0&&(o+=this._bufpos);o<=t-i;){var c;if((c=e[o+i-1])===s&&e[o]===r[0]&&n(r,0,e,o,i-1))return++this.matches,o>0?this.emit("info",!0,e,this._bufpos,o):this.emit("info",!0),this._bufpos=o+i,o+i;o+=a[c]}if(o<t){for(;o<t&&(e[o]!==r[0]||!n(e,o,r,0,t-o));)++o;o<t&&(e.copy(f,0,o,o+(t-o)),this._lookbehind_size=t-o)}return o>0&&this.emit("info",!1,e,this._bufpos,o<t?o:t),this._bufpos=t,t},o.prototype._sbmh_lookup_char=function(e,t){return t<0?this._lookbehind[this._lookbehind_size+t]:e[t]},o.prototype._sbmh_memcmp=function(e,t,r){for(var i=0;i<r;){if(this._sbmh_lookup_char(e,t+i)!==this._needle[i])return!1;++i}return!0},e.exports=o},function(e){e.exports={_from:"ssh2-streams@~0.4.2",_id:"ssh2-streams@0.4.2",_inBundle:!1,_integrity:"sha512-2rSj3oTIJnbAIzR3+XwIYef9wCOVrPQZNLL+fFPPjnPxf09tKkAbgrlYgh/1qynBTz65AUOS+s1zuko4M/GKCw==",_location:"/ssh2-streams",_phantomChildren:{},_requested:{type:"range",registry:!0,raw:"ssh2-streams@~0.4.2",name:"ssh2-streams",escapedName:"ssh2-streams",rawSpec:"~0.4.2",saveSpec:null,fetchSpec:"~0.4.2"},_requiredBy:["/ssh2"],_resolved:"https://registry.npmjs.org/ssh2-streams/-/ssh2-streams-0.4.2.tgz",_shasum:"bac0d18727396d16049f5f0c8517a46516b45719",_spec:"ssh2-streams@~0.4.2",_where:"C:\\Users\\schoo_000\\Workspaces\\NPM\\ssh-fs\\node_modules\\ssh2",author:{name:"Brian White",email:"mscdex@mscdex.net"},bugs:{url:"https://github.com/mscdex/ssh2-streams/issues"},bundleDependencies:!1,dependencies:{asn1:"~0.2.0","bcrypt-pbkdf":"^1.0.2",streamsearch:"~0.1.2"},deprecated:!1,description:"SSH2 and SFTP(v3) client/server protocol streams for node.js",engines:{node:">=5.2.0"},homepage:"https://github.com/mscdex/ssh2-streams#readme",keywords:["ssh","ssh2","sftp","secure","protocol","streams","client","server"],licenses:[{type:"MIT",url:"http://github.com/mscdex/ssh2-streams/raw/master/LICENSE"}],main:"./index",name:"ssh2-streams",repository:{type:"git",url:"git+ssh://git@github.com/mscdex/ssh2-streams.git"},scripts:{test:"node test/test.js"},version:"0.4.2"}},function(e,t,r){var i=r(10).Socket,n=r(9).EventEmitter,o=r(7).inherits,s=r(11),a=r(5),f=r(16),h=r(23).readUInt32BE,c=r(23).writeUInt32BE,u=r(23).writeUInt32LE,l=11,p=12,d=13,g=14,E=5,v=/^\!<socket >(\d+) s ([A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8}\-[A-Z0-9]{8})/,m=/^[\/\\][\/\\]\.[\/\\]pipe[\/\\].+/;if(e.exports=function(e,t,r,n,o){var s,y,_,b,S,A,T,U,B=0,k=Buffer.isBuffer(t),N=0,R=0,O=0,D=0,C=!1;function L(){var e;if(k){var r=9;e=Buffer.allocUnsafe(9+B+4+b+4),c(e,e.length-4,0),e[4]=d,c(e,B,5),t.copy(e,r),c(e,b,r+=B),n.copy(e,r+=4),c(e,0,r+=b),s.write(e)}else s.write(Buffer.from([0,0,0,1,l]))}function I(e){for(var r=0,i=e.length;r<i;++r)if(void 0===S)5==++N&&(S=e[r],N=0);else if(S===g)if(_){if(_[N]=e[r],++N===R)return s.removeAllListeners("data"),s.destroy()}else R<<=8,R+=e[r],4==++N&&(_=Buffer.allocUnsafe(R),N=0);else if(S===p)if(void 0===A){if(O<<=8,O+=e[r],4==++N&&(A=new Array(O),N=0,0===O))return s.removeAllListeners("data"),s.destroy()}else if(t)if(!1===C){if(t[N]=e[r],++N===B&&(A[O-1]=t,B=0,N=0,C=!0,0==--O))return t=void 0,s.removeAllListeners("data"),s.destroy()}else!0===C?(D<<=8,D+=e[r],4==++N&&(N=0,D>0?C=D:(t=void 0,C=!1),D=0)):++N===C&&(C=!1,N=0,t=void 0);else B<<=8,B+=e[r],4==++N&&(t=Buffer.allocUnsafe(B),N=0);else if(S===E)return y=k?new Error("Agent unable to sign data"):new Error("Unable to retrieve list of keys from agent"),s.removeAllListeners("data"),s.destroy()}function P(e){y=e}function H(){y?o(y):k&&!_||!k&&!A?o(new Error("Unexpected disconnection from agent")):k&&_?o(void 0,_):!k&&A&&o(void 0,A)}if("function"==typeof t&&"function"==typeof r?(T=t,U=r):k?(B=t.length,b=n.length):(o=t,t=void 0),"win32"!==process.platform||m.test(e))s=new i;else{if("pageant"!==e){var x=!1;return void a.readFile(e,function t(r,n){if(r)return x?o(new Error("Invalid cygwin unix socket path")):void f.exec('cygpath -w "'+e+'"',function(r,i,n){if(r||0===i.length)return o(new Error("Invalid cygwin unix socket path"));x=!0,e=i.toString().replace(/[\r\n]/g,""),a.readFile(e,t)});var c;if(c=v.exec(n.toString("ascii"))){var l,p,d,g,E,m,y=0,_=!1,w=[],b=Buffer.allocUnsafe(12);for(b.fill(0),l=parseInt(c[1],10),p=c[2].replace(/\-/g,""),d=Buffer.allocUnsafe(16),E=0,m=0;m<32;++E,m+=2)d[E]=parseInt(p.substring(m,m+2),16);for(E=0;E<16;E+=4)u(d,h(d,E),E);function S(){y=0,g="secret",s.write(d)}function A(e){y+=e.length,"secret"===g?16===y&&(y=0,g="creds",s.write(b)):"creds"===g&&(_||w.push(e),12===y&&(s.removeListener("connect",S),s.removeListener("data",A),s.removeListener("close",T),_?(M(),s.emit("connect")):(_=!0,b=Buffer.concat(w),u(b,process.pid,0),s.destroy(),U())))}function T(){o(new Error("Problem negotiating cygwin unix socket security"))}function U(){(s=new i).once("connect",S),s.on("data",A),s.once("close",T),s.connect(l)}U()}else o(new Error("Malformed cygwin unix socket file"))})}s=new w}function M(){var e;T||U?(s.once("connect",function(){e=T();var t=!1;function r(){t||(s.destroy(),t=!0)}e.once("end",r).once("close",r).on("data",function(e){s.write(e)}),s.on("data",function(t){e.write(t)})}),s.once("close",function(){e||U()})):(s.once("connect",L),s.on("data",I),s.once("error",P),s.once("close",H))}M(),s.connect(e)},"win32"===process.platform){var y={},_=s.resolve(__dirname,"..","util/pagent.exe");function w(){this.proc=void 0,this.buffer=null}y[10]=new Error("Invalid pagent.exe arguments"),y[11]=new Error("Pageant is not running"),y[12]=new Error("pagent.exe could not create an mmap"),y[13]=new Error("pagent.exe could not set mode for stdin"),y[14]=new Error("pagent.exe could not set mode for stdout"),y[15]=new Error("pagent.exe did not get expected input payload"),o(w,n),w.prototype.write=function(e){if(null===this.buffer?this.buffer=e:this.buffer=Buffer.concat([this.buffer,e],this.buffer.length+e.length),!(this.buffer.length<4)){var t=h(this.buffer,0);if(!(this.buffer.length-4<t)){e=this.buffer.slice(0,4+t),this.buffer.length>4+t?this.buffer=this.buffer.slice(4+t):this.buffer=null;var r,i=this,n=!1;(r=this.proc=f.spawn(_,[e.length])).stdout.on("data",function(e){i.emit("data",e)}),r.once("error",function(e){n||(n=!0,i.emit("error",e))}),r.once("close",function(e){i.proc=void 0,y[e]&&!n&&(n=!0,i.emit("error",y[e])),i.emit("close",n)}),r.stdin.end(e)}}},w.prototype.end=w.prototype.destroy=function(){this.buffer=null,this.proc&&(this.proc.kill(),this.proc=void 0)},w.prototype.connect=function(){this.emit("connect")}}},function(e,t,r){var i,n=r(10),o=r(9).EventEmitter,s=o.listenerCount,a=r(7).inherits,f=r(24),h=f.utils.parseKey,c=f.SSH2Stream,u=f.SFTPStream,l=f.constants,p=l.DISCONNECT_REASON,d=l.CHANNEL_OPEN_FAILURE,g=l.ALGORITHMS,E=r(31),v=r(49),m=r(23).writeUInt32BE,y=Math.pow(2,32)-1,_=10;function w(e,t){if(!(this instanceof w))return new w(e,t);var r,a={"ssh-rsa":null,"ssh-dss":null,"ecdsa-sha2-nistp256":null,"ecdsa-sha2-nistp384":null,"ecdsa-sha2-nistp521":null},f=e.hostKeys;if(!Array.isArray(f))throw new Error("hostKeys must be an array");for(r=0;r<f.length;++r){var u;if((u=Buffer.isBuffer(f[r])||"string"==typeof f[r]?h(f[r]):h(f[r].key,f[r].passphrase))instanceof Error)throw new Error("Cannot parse privateKey: "+u.message);if(null===u.getPrivatePEM())throw new Error("privateKey value contains an invalid private key");a[u.type]||(a[u.type]=u)}var l={kex:void 0,kexBuf:void 0,cipher:void 0,cipherBuf:void 0,serverHostKey:void 0,serverHostKeyBuf:void 0,hmac:void 0,hmacBuf:void 0,compress:void 0,compressBuf:void 0};if("object"==typeof e.algorithms&&null!==e.algorithms){var d,E;if(E=e.algorithms.kex,Array.isArray(E)&&E.length>0){for(d=g.SUPPORTED_KEX,r=0;r<E.length;++r)if(-1===d.indexOf(E[r]))throw new Error("Unsupported key exchange algorithm: "+E[r]);l.kex=E}if(E=e.algorithms.cipher,Array.isArray(E)&&E.length>0){for(d=g.SUPPORTED_CIPHER,r=0;r<E.length;++r)if(-1===d.indexOf(E[r]))throw new Error("Unsupported cipher algorithm: "+E[r]);l.cipher=E}E=e.algorithms.serverHostKey;var m=!1;if(Array.isArray(E)&&E.length>0){for(d=g.SUPPORTED_SERVER_HOST_KEY,r=E.length-1;r>=0;--r){if(-1===d.indexOf(E[r]))throw new Error("Unsupported server host key algorithm: "+E[r]);a[E[r]]||(m||(E=E.slice(),m=!0),E.splice(r,1))}E.length>0&&(l.serverHostKey=E)}if(E=e.algorithms.hmac,Array.isArray(E)&&E.length>0){for(d=g.SUPPORTED_HMAC,r=0;r<E.length;++r)if(-1===d.indexOf(E[r]))throw new Error("Unsupported HMAC algorithm: "+E[r]);l.hmac=E}if(E=e.algorithms.compress,Array.isArray(E)&&E.length>0){for(d=g.SUPPORTED_COMPRESS,r=0;r<E.length;++r)if(-1===d.indexOf(E[r]))throw new Error("Unsupported compression algorithm: "+E[r]);l.compress=E}}if(void 0===l.serverHostKey){var y=Object.keys(a);for(r=y.length-1;r>=0;--r)a[y[r]]||y.splice(r,1);l.serverHostKey=y}!i&&w.KEEPALIVE_INTERVAL>0&&w.KEEPALIVE_CLIENT_INTERVAL>0&&w.KEEPALIVE_CLIENT_COUNT_MAX>=0&&(i=new v(w.KEEPALIVE_INTERVAL,w.KEEPALIVE_CLIENT_INTERVAL,w.KEEPALIVE_CLIENT_COUNT_MAX));var _=this;o.call(this),"function"==typeof t&&_.on("connection",t);var S,A,T={algorithms:l,hostKeys:a,server:!0};for(r=0,A=(S=Object.keys(e)).length;r<A;++r){var U=S[r];"privateKey"!==U&&"publicKey"!==U&&"passphrase"!==U&&"algorithms"!==U&&"hostKeys"!==U&&"server"!==U&&(T[U]=e[U])}if("function"==typeof T.debug)var B=T.debug,k=Object.keys(T);this._srv=new n.Server(function(e){if(_._connections>=_.maxConnections)e.destroy();else{++_._connections,e.once("close",function(e){--_._connections,o.read()}).on("error",function(e){o.reset(),o.emit("error",e)});var t=T;if(B){t={};for(var r,i=0;i<k.length;++i)t[r=k[i]]=T[r];var n="["+process.hrtime().join(".")+"] ";t.debug=function(e){B(n+e)}}var o=new c(t),a=new b(o,e);e.pipe(o).pipe(e),a.on("error",f),o.once("header",function(t){if(!o._readableState.ended){if(!s(_,"connection"))return o.disconnect(p.BY_APPLICATION);a.removeListener("error",f),_.emit("connection",a,{ip:e.remoteAddress,family:e.remoteFamily,port:e.remotePort,header:t})}})}function f(e){}}).on("error",function(e){_.emit("error",e)}).on("listening",function(){_.emit("listening")}).on("close",function(){_.emit("close")}),this._connections=0,this.maxConnections=1/0}function b(e,t){o.call(this);var r=this;this._sshstream=e;var n=this._channels={};this._curChan=-1,this._sock=t,this.noMoreSessions=!1,this.authenticated=!1,e.on("end",function(){t.resume(),r.emit("end")}).on("close",function(e){r.emit("close",e)}).on("error",function(e){r.emit("error",e)}).on("drain",function(){r.emit("drain")}).on("continue",function(){r.emit("continue")});var a,f=0,h=!1,c=[];function u(t,i,n,o){if(0===f||a&&(a.username!==t||a.service!==i)||"password"!==n&&"publickey"!==n&&"hostbased"!==n&&"keyboard-interactive"!==n&&"none"!==n||c.length===_)return e.disconnect(p.PROTOCOL_ERROR);if("ssh-connection"!==i)return e.disconnect(p.SERVICE_NOT_AVAILABLE);var h;if(e._state.authMethod=n,"keyboard-interactive"===n?h=new U(e,t,i,n,o,l):"publickey"===n?h=new B(e,t,i,n,o,l):"hostbased"===n?h=new k(e,t,i,n,o,l):"password"===n?h=new N(e,t,i,n,o,l):"none"===n&&(h=new A(e,t,i,n,l)),a){if(!a._initialResponse)return c.push(h);a._multistep&&!this._finalResponse&&(a._cleanup&&a._cleanup(),a.emit("abort"))}a=h,s(r,"authentication")?r.emit("authentication",a):a.reject()}function l(t,i,n,o){a!==t||r.authenticated||(i?(e.removeListener("USERAUTH_REQUEST",u),a=void 0,r.authenticated=!0,e.authSuccess(),c=[],r.emit("ready")):(e.authFailure(n,o),c.length&&(a=c.pop(),s(r,"authentication")?r.emit("authentication",a):a.reject())))}e.on("SERVICE_REQUEST",function(t){if(0===f||h||r.authenticated||"ssh-userauth"!==t)return e.disconnect(p.SERVICE_NOT_AVAILABLE);h=!0,e.serviceAccept(t)}).on("USERAUTH_REQUEST",u);var g=[];e.on("GLOBAL_REQUEST",function(t,i,n){var o={type:null,buf:null};function a(t,r){o.type=t,o.buf=r,function(){for(var t;g.length>0&&g[0].type;)"SUCCESS"===(t=g.shift()).type&&e.requestSuccess(t.buf),"FAILURE"===t.type&&e.requestFailure()}()}if(i&&g.push(o),("tcpip-forward"===t||"cancel-tcpip-forward"===t||"no-more-sessions@openssh.com"===t||"streamlocal-forward@openssh.com"===t||"cancel-streamlocal-forward@openssh.com"===t)&&s(r,"request")&&r.authenticated){var f,h;if(i){var c=!1;f=function(e){var r;c||(c=!0,"tcpip-forward"===t&&0===n.bindPort&&"number"==typeof e&&(r=Buffer.allocUnsafe(4),m(r,e,0)),a("SUCCESS",r))},h=function(){c||(c=!0,a("FAILURE"))}}if("no-more-sessions@openssh.com"===t)return r.noMoreSessions=!0,void(f&&f());r.emit("request",f,h,t,n)}else i&&a("FAILURE")}),e.on("CHANNEL_OPEN",function(t){if("session"===t.type&&r.noMoreSessions||!r.authenticated){var i=d.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,i)}var o,a,f=O(r),h=!1;if(!1===f)return e.channelOpenFail(t.sender,d.RESOURCE_SHORTAGE);switch(n[f]=!0,a=function(){if(!h){h=!0,delete n[f];var r=d.ADMINISTRATIVELY_PROHIBITED;return e.channelOpenFail(t.sender,r)}},t.type){case"session":s(r,"session")?(o=function(){if(!h)return h=!0,e.channelOpenConfirm(t.sender,f,E.MAX_WINDOW,E.PACKET_SIZE),new S(r,t,f)},r.emit("session",o,a)):a();break;case"direct-tcpip":s(r,"tcpip")?(o=function(){if(!h){h=!0,e.channelOpenConfirm(t.sender,f,E.MAX_WINDOW,E.PACKET_SIZE);var i={type:void 0,incoming:{id:f,window:E.MAX_WINDOW,packetSize:E.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new E(i,r)}},r.emit("tcpip",o,a,t.data)):a();break;case"direct-streamlocal@openssh.com":s(r,"openssh.streamlocal")?(o=function(){if(!h){h=!0,e.channelOpenConfirm(t.sender,f,E.MAX_WINDOW,E.PACKET_SIZE);var i={type:void 0,incoming:{id:f,window:E.MAX_WINDOW,packetSize:E.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};return new E(i,r)}},r.emit("openssh.streamlocal",o,a,t.data)):a();break;default:a()}}),e.on("NEWKEYS",function(){++f>1&&r.emit("rekey")}),i&&this.once("ready",function(){i.add(e)})}function S(e,t,r){this.subtype=void 0;var i,n=!1,o=this,a=t.sender,f={type:"session",incoming:{id:r,window:E.MAX_WINDOW,packetSize:E.PACKET_SIZE,state:"open"},outgoing:{id:t.sender,window:t.window,packetSize:t.packetSize,state:"open"}};e._sshstream.on("CHANNEL_REQUEST:"+r,function(t){var r,h,c=!1;if(t.wantReply&&("shell"!==t.request&&"exec"!==t.request&&"subsystem"!==t.request&&(r=function(){if(!(c||n||i))return c=!0,e._sshstream.channelSuccess(a)}),h=function(){if(!(c||n||i))return c=!0,e._sshstream.channelFailure(a)}),n)h&&h();else switch(t.request){case"env":s(o,"env")?o.emit("env",r,h,{key:t.key,val:t.val}):h&&h();break;case"pty-req":s(o,"pty")?o.emit("pty",r,h,{cols:t.cols,rows:t.rows,width:t.width,height:t.height,term:t.term,modes:t.modes}):h&&h();break;case"window-change":s(o,"window-change")?o.emit("window-change",r,h,{cols:t.cols,rows:t.rows,width:t.width,height:t.height}):h&&h();break;case"x11-req":s(o,"x11")?o.emit("x11",r,h,{single:t.single,protocol:t.protocol,cookie:t.cookie,screen:t.screen}):h&&h();break;case"signal":s(o,"signal")?o.emit("signal",r,h,{name:t.signal}):h&&h();break;case"auth-agent-req@openssh.com":s(o,"auth-agent")?o.emit("auth-agent",r,h):h&&h();break;case"shell":s(o,"shell")?(r=function(){if(!(c||n||i))return c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new E(f,e,{server:!0})).subtype=o.subtype=t.request,i},o.emit("shell",r,h)):h&&h();break;case"exec":s(o,"exec")?(r=function(){if(!(c||n||i))return c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new E(f,e,{server:!0})).subtype=o.subtype=t.request,i},o.emit("exec",r,h,{command:t.command})):h&&h();break;case"subsystem":r=function(){if(!(c||n||i)){if(c=!0,t.wantReply&&e._sshstream.channelSuccess(a),(i=new E(f,e,{server:!0})).subtype=o.subtype=t.request+":"+t.subsystem,"sftp"===t.subsystem){var r=new u({server:!0,debug:e._sshstream.debug});return i.pipe(r).pipe(i),r}return i}},"sftp"===t.subsystem&&s(o,"sftp")?o.emit("sftp",r,h):"sftp"!==t.subsystem&&s(o,"subsystem")?o.emit("subsystem",r,h,{name:t.subsystem}):h&&h();break;default:h&&h()}}).once("CHANNEL_EOF:"+r,function(){n=!0,o.emit("eof"),o.emit("end")}).once("CHANNEL_CLOSE:"+r,function(){n=!0,o.emit("close")})}function A(e,t,r,i,n){o.call(this);var s=this;this.username=this.user=t,this.service=r,this.method=i,this._initialResponse=!1,this._finalResponse=!1,this._multistep=!1,this._cbfinal=function(e,t,r){s._finalResponse||(s._finalResponse=!0,n(s,e,t,r))},this._stream=e}a(w,o),w.prototype.listen=function(){return this._srv.listen.apply(this._srv,arguments),this},w.prototype.address=function(){return this._srv.address()},w.prototype.getConnections=function(e){this._srv.getConnections(e)},w.prototype.close=function(e){return this._srv.close(e),this},w.prototype.ref=function(){this._srv.ref()},w.prototype.unref=function(){this._srv.unref()},a(b,o),b.prototype.end=function(){return this._sshstream.disconnect(p.BY_APPLICATION)},b.prototype.x11=function(e,t,r){return R(this,"x11",{originAddr:e,originPort:t},r)},b.prototype.forwardOut=function(e,t,r,i,n){return R(this,"forwarded-tcpip",{boundAddr:e,boundPort:t,remoteAddr:r,remotePort:i},n)},b.prototype.openssh_forwardOutStreamLocal=function(e,t){return R(this,"forwarded-streamlocal@openssh.com",{socketPath:e},t)},b.prototype.rekey=function(e){var t,r=this._sshstream,i=!0;try{i=r.rekey()}catch(e){t=e}return"function"==typeof e&&(t?process.nextTick(function(){e(t)}):this.once("rekey",e)),i},a(S,o),a(A,o),A.prototype.accept=function(){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!0)},A.prototype.reject=function(e,t){this._cleanup&&this._cleanup(),this._initialResponse=!0,this._cbfinal(!1,e,t)};var T=/[ \t\r\n]*,[ \t\r\n]*/g;function U(e,t,r,i,n,o){A.call(this,e,t,r,i,o),this._multistep=!0;var s=this;this._cb=void 0,this._onInfoResponse=function(e){if(s._cb){var t=s._cb;s._cb=void 0,t(e)}},this.submethods=n.split(T),this.on("abort",function(){s._cb&&s._cb(new Error("Authentication request aborted"))})}function B(e,t,r,i,n,o){var s;if(A.call(this,e,t,r,i,o),this.key={algo:n.keyAlgo,data:n.key},this.signature=n.signature,this.signature)switch(n.keyAlgo){case"ssh-rsa":case"ssh-dss":s="sha1";break;case"ecdsa-sha2-nistp256":s="sha256";break;case"ecdsa-sha2-nistp384":s="sha384";break;case"ecdsa-sha2-nistp521":s="sha512"}this.sigAlgo=s,this.blob=n.blob}function k(e,t,r,i,n,o){var s;if(A.call(this,e,t,r,i,o),this.key={algo:n.keyAlgo,data:n.key},this.signature=n.signature,this.signature)switch(n.keyAlgo){case"ssh-rsa":case"ssh-dss":s="sha1";break;case"ecdsa-sha2-nistp256":s="sha256";break;case"ecdsa-sha2-nistp384":s="sha384";break;case"ecdsa-sha2-nistp521":s="sha512"}this.sigAlgo=s,this.blob=n.blob,this.localHostname=n.localHostname,this.localUsername=n.localUsername}function N(e,t,r,i,n,o){A.call(this,e,t,r,i,o),this.password=n}function R(e,t,r,i){var n=O(e),o=E.MAX_WINDOW,s=E.PACKET_SIZE,a=!0;if(!1===n)return i(new Error("No free channels available"));"function"==typeof r&&(i=r,r={}),e._channels[n]=!0;var f=e._sshstream;return f.once("CHANNEL_OPEN_CONFIRMATION:"+n,function(r){f.removeAllListeners("CHANNEL_OPEN_FAILURE:"+n);var a={type:t,incoming:{id:n,window:o,packetSize:s,state:"open"},outgoing:{id:r.sender,window:r.window,packetSize:r.packetSize,state:"open"}};i(void 0,new E(a,e,{server:!0}))}).once("CHANNEL_OPEN_FAILURE:"+n,function(t){f.removeAllListeners("CHANNEL_OPEN_CONFIRMATION:"+n),delete e._channels[n];var r=new Error("(SSH) Channel open failure: "+t.description);r.reason=t.reason,r.lang=t.lang,i(r)}),"forwarded-tcpip"===t?a=f.forwardedTcpip(n,o,s,r):"x11"===t?a=f.x11(n,o,s,r):"forwarded-streamlocal@openssh.com"===t&&(a=f.openssh_forwardedStreamLocal(n,o,s,r)),a}function O(e){if(e._curChan<y)return++e._curChan;for(var t=0,r=e._channels;t<y;++t)if(!r[t])return t;return!1}a(U,A),U.prototype._cleanup=function(){this._stream.removeListener("USERAUTH_INFO_RESPONSE",this._onInfoResponse)},U.prototype.prompt=function(e,t,r,i){Array.isArray(e)||(e=[e]),"function"==typeof t?(i=t,t=r=void 0):"function"==typeof r&&(i=r,r=void 0);for(var n=0;n<e.length;++n)"string"==typeof e[n]&&(e[n]={prompt:e[n],echo:!0});return this._cb=i,this._initialResponse=!0,this._stream.once("USERAUTH_INFO_RESPONSE",this._onInfoResponse),this._stream.authInfoReq(t,r,e)},a(B,A),B.prototype.accept=function(){this.signature?A.prototype.accept.call(this):(this._initialResponse=!0,this._stream.authPKOK(this.key.algo,this.key.data))},a(k,A),a(N,A),w.createServer=function(e,t){return new w(e,t)},w.KEEPALIVE_INTERVAL=1e3,w.KEEPALIVE_CLIENT_INTERVAL=15e3,w.KEEPALIVE_CLIENT_COUNT_MAX=3,e.exports=w,e.exports.IncomingClient=b},function(e,t){function r(e,t){for(var r=t,i=r+1,n=e.length;i<n;r+=1,i+=1)e[r]=e[i];e.pop()}function i(e,t,i){var n=this._streams=[];this._timer=void 0,this._timerInterval=e,this._timerfn=function(){for(var e,o,s=Date.now(),a=0,f=n.length;a<f;++a)if((o=(e=n[a])._kalast)&&s-o>=t)if(++e._kacnt>i){var h=new Error("Keepalive timeout");h.level="client-timeout",e.emit("error",h),e.disconnect(),r(n,a),--a,f=n.length}else e._kalast=s,e.ping()}}i.prototype.start=function(){this._timer&&this.stop(),this._timer=setInterval(this._timerfn,this._timerInterval)},i.prototype.stop=function(){this._timer&&(clearInterval(this._timer),this._timer=void 0)},i.prototype.add=function(e){var t=this._streams,r=this;function i(){e._kalast=Date.now(),e._kacnt=0}e.once("end",function(){r.remove(e)}).on("packet",i),t[t.length]=e,i(),this._timer||this.start()},i.prototype.remove=function(e){var t=this._streams,i=t.indexOf(e);i>-1&&r(t,i),t.length||this.stop()},e.exports=i}]);
//# sourceMappingURL=4.extension.js.map